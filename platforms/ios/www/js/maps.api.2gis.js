/*
 Leaflet {VERSION}, a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2014 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*/

(function (window, document, undefined) {
function expose(){var e=window.L;L.noConflict=function(){return window.L=e,this},window.L=L}var L={version:"0.8-dev"};"object"==typeof module&&"object"==typeof module.exports?module.exports=L:"function"==typeof define&&define.amd?define(L):expose();L.Util={extend:function(t){var n,e,r,i,o=Array.prototype.slice.call(arguments,1);for(e=0,r=o.length;r>e;e++){i=o[e];for(n in i)t[n]=i[n]}return t},create:Object.create||function(){function t(){}return function(n){return t.prototype=n,new t}}(),bind:function(t,n){var e=Array.prototype.slice;if(t.bind)return t.bind.apply(t,e.call(arguments,1));var r=e.call(arguments,2);return function(){return t.apply(n,r.length?r.concat(e.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++L.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,n,e){var r,i,o,a;return a=function(){r=!1,i&&(o.apply(e,i),i=!1)},o=function(){r?i=arguments:(t.apply(e,arguments),setTimeout(a,n),r=!0)}},wrapNum:function(t,n,e){var r=n[1],i=n[0],o=r-i;return t===r&&e?t:((t-i)%o+o)%o+i},falseFn:function(){return!1},formatNum:function(t,n){var e=Math.pow(10,n||5);return Math.round(t*e)/e},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return L.Util.trim(t).split(/\s+/)},setOptions:function(t,n){t.hasOwnProperty("options")||(t.options=t.options?L.Util.create(t.options):{});for(var e in n)t.options[e]=n[e];return t.options},getParamString:function(t,n,e){var r=[];for(var i in t)r.push(encodeURIComponent(e?i.toUpperCase():i)+"="+encodeURIComponent(t[i]));return(n&&-1!==n.indexOf("?")?"&":"?")+r.join("&")},template:function(t,n){return t.replace(L.Util.templateRe,function(t,e){var r=n[e];if(void 0===r)throw new Error("No value provided for variable "+t);return"function"==typeof r&&(r=r(n)),r})},templateRe:/\{ *([\w_]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function n(t){var n=+new Date,r=Math.max(0,16-(n-e));return e=n+r,window.setTimeout(t,r)}var e=0,r=window.requestAnimationFrame||t("RequestAnimationFrame")||n,i=window.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};L.Util.requestAnimFrame=function(t,e,i,o){return i&&r===n?(t.call(e),void 0):r.call(window,L.bind(t,e),o)},L.Util.cancelAnimFrame=function(t){t&&i.call(window,t)}}(),L.extend=L.Util.extend,L.bind=L.Util.bind,L.stamp=L.Util.stamp,L.setOptions=L.Util.setOptions;L.Class=function(){},L.Class.extend=function(t){var i=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks.length&&this.callInitHooks()},o=i.__super__=this.prototype,s=L.Util.create(o);s.constructor=i,i.prototype=s;for(var n in this)this.hasOwnProperty(n)&&"prototype"!==n&&(i[n]=this[n]);return t.statics&&(L.extend(i,t.statics),delete t.statics),t.includes&&(L.Util.extend.apply(null,[s].concat(t.includes)),delete t.includes),s.options&&(t.options=L.Util.extend(L.Util.create(s.options),t.options)),L.extend(s,t),s._initHooks=[],s.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,i=s._initHooks.length;i>t;t++)s._initHooks[t].call(this)}},i},L.Class.include=function(t){L.extend(this.prototype,t)},L.Class.mergeOptions=function(t){L.extend(this.prototype.options,t)},L.Class.addInitHook=function(t){var i=Array.prototype.slice.call(arguments,1),o="function"==typeof t?t:function(){this[t].apply(this,i)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(o)};L.Evented=L.Class.extend({on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else{t=L.Util.splitWords(t);for(var r=0,s=t.length;s>r;r++)this._on(t[r],e,n)}return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else{t=L.Util.splitWords(t);for(var r=0,s=t.length;s>r;r++)this._off(t[r],e,n)}else delete this._events;return this},_on:function(t,e,n){var i=this._events=this._events||{},r=n&&n!==this&&L.stamp(n);if(r){var s=t+"_idx",o=t+"_len",f=i[s]=i[s]||{},a=L.stamp(e)+"_"+r;f[a]||(f[a]={fn:e,ctx:n},i[o]=(i[o]||0)+1)}else i[t]=i[t]||[],i[t].push({fn:e})},_off:function(t,e,n){var i=this._events,r=t+"_idx",s=t+"_len";if(i){if(!e)return delete i[t],delete i[r],delete i[s],void 0;var o,f,a,v,h,l=n&&n!==this&&L.stamp(n);if(l)h=L.stamp(e)+"_"+l,o=i[r],o&&o[h]&&(v=o[h],delete o[h],i[s]--);else if(o=i[t])for(f=0,a=o.length;a>f;f++)if(o[f].fn===e){v=o[f],o.splice(f,1);break}v&&(v.fn=L.Util.falseFn)}},fire:function(t,e,n){if(!this.listens(t,n))return this;var i=L.Util.extend({},e,{type:t,target:this}),r=this._events;if(r){var s,o,f,a,v=r[t+"_idx"];if(r[t])for(f=r[t].slice(),s=0,o=f.length;o>s;s++)f[s].fn.call(this,i);for(a in v)v[a].fn.call(v[a].ctx,i)}return n&&this._propagateEvent(i),this},listens:function(t,e){var n=this._events;if(n&&(n[t]||n[t+"_len"]))return!0;if(e)for(var i in this._eventParents)if(this._eventParents[i].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var i in t)this.once(i,t[i],e);return this}var r=L.bind(function(){this.off(t,e,n).off(t,r,n)},this);return this.on(t,e,n).on(t,r,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[L.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[L.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,L.extend({layer:t.target},t),!0)}});var proto=L.Evented.prototype;proto.addEventListener=proto.on,proto.removeEventListener=proto.clearAllEventListeners=proto.off,proto.addOneTimeEventListener=proto.once,proto.fireEvent=proto.fire,proto.hasEventListeners=proto.listens,L.Mixin={Events:proto};!function(){var i=navigator.userAgent.toLowerCase(),e=document.documentElement,n="ActiveXObject"in window,o=-1!==i.indexOf("webkit"),t=-1!==i.indexOf("phantom"),d=-1!==i.search("android [23]"),a=-1!==i.indexOf("chrome"),r="undefined"!=typeof orientation,w=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!window.PointerEvent,c=window.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||w,m=n&&"transition"in e.style,s="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!d,u="MozPerspective"in e.style,v="OTransition"in e.style,b="devicePixelRatio"in window&&window.devicePixelRatio>1;if(!b&&"matchMedia"in window){var l=window.matchMedia("(min-resolution:144dpi)");b=l&&l.matches}var f=!window.L_NO_TOUCH&&!t&&(c||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);L.Browser={ie:n,ielt9:n&&!document.addEventListener,webkit:o,gecko:-1!==i.indexOf("gecko")&&!o&&!window.opera&&!n,android:-1!==i.indexOf("android"),android23:d,chrome:a,safari:!a&&-1!==i.indexOf("safari"),ie3d:m,webkit3d:s,gecko3d:u,opera3d:v,any3d:!window.L_DISABLE_3D&&(m||s||u||v)&&!t,mobile:r,mobileWebkit:r&&o,mobileWebkit3d:r&&s,mobileOpera:r&&window.opera,touch:!!f,msPointer:!!w,pointer:!!c,retina:!!b}}();L.Point=function(t,i,n){this.x=n?Math.round(t):t,this.y=n?Math.round(i):i},L.Point.prototype={clone:function(){return new L.Point(this.x,this.y)},add:function(t){return this.clone()._add(L.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(L.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){t=L.point(t);var i=t.x-this.x,n=t.y-this.y;return Math.sqrt(i*i+n*n)},equals:function(t){return t=L.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=L.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}},L.point=function(t,i,n){return t instanceof L.Point?t:L.Util.isArray(t)?new L.Point(t[0],t[1]):void 0===t||null===t?t:new L.Point(t,i,n)};L.Bounds=function(t,n){if(t)for(var i=n?[t,n]:t,s=0,m=i.length;m>s;s++)this.extend(i[s])},L.Bounds.prototype={extend:function(t){return t=L.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new L.Point(this.min.x,this.max.y)},getTopRight:function(){return new L.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var n,i;return t="number"==typeof t[0]||t instanceof L.Point?L.point(t):L.bounds(t),t instanceof L.Bounds?(n=t.min,i=t.max):n=i=t,n.x>=this.min.x&&i.x<=this.max.x&&n.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=L.bounds(t);var n=this.min,i=this.max,s=t.min,m=t.max,x=m.x>=n.x&&s.x<=i.x,h=m.y>=n.y&&s.y<=i.y;return x&&h},isValid:function(){return!(!this.min||!this.max)}},L.bounds=function(t,n){return!t||t instanceof L.Bounds?t:new L.Bounds(t,n)};L.Transformation=function(t,n,i,r){this._a=t,this._b=n,this._c=i,this._d=r},L.Transformation.prototype={transform:function(t,n){return this._transform(t.clone(),n)},_transform:function(t,n){return n=n||1,t.x=n*(this._a*t.x+this._b),t.y=n*(this._c*t.y+this._d),t},untransform:function(t,n){return n=n||1,new L.Point((t.x/n-this._b)/this._a,(t.y/n-this._d)/this._c)}};L.DomUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var s=document.defaultView.getComputedStyle(t,null);n=s?s[e]:null}return"auto"===n?null:n},create:function(t,e,n){var s=document.createElement(t);return s.className=e,n&&n.appendChild(s),s},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=L.DomUtil.getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(void 0!==t.classList)for(var n=L.Util.splitWords(e),s=0,o=n.length;o>s;s++)t.classList.add(n[s]);else if(!L.DomUtil.hasClass(t,e)){var i=L.DomUtil.getClass(t);L.DomUtil.setClass(t,(i?i+" ":"")+e)}},removeClass:function(t,e){void 0!==t.classList?t.classList.remove(e):L.DomUtil.setClass(t,L.Util.trim((" "+L.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e},getClass:function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,s="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(s)}catch(o){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+s+"(opacity="+e+")"}},testProp:function(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1},setTransform:function(t,e,n){var s=e||new L.Point(0,0),o=L.Browser.webkit3d,i="translate"+(o?"3d":"")+"(",l=(o?",0":"")+")";t.style[L.DomUtil.TRANSFORM]=i+s.x+"px,"+s.y+"px"+l+(n?" scale("+n+")":"")},setPosition:function(t,e,n){t._leaflet_pos=e,L.Browser.any3d&&!n?L.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},function(){L.DomUtil.TRANSFORM=L.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var t=L.DomUtil.TRANSITION=L.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(L.DomUtil.TRANSITION_END="webkitTransition"===t||"OTransition"===t?t+"End":"transitionend","onselectstart"in document)L.DomUtil.disableTextSelection=function(){L.DomEvent.on(window,"selectstart",L.DomEvent.preventDefault)},L.DomUtil.enableTextSelection=function(){L.DomEvent.off(window,"selectstart",L.DomEvent.preventDefault)};else{var e=L.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);L.DomUtil.disableTextSelection=function(){if(e){var t=document.documentElement.style;this._userSelect=t[e],t[e]="none"}},L.DomUtil.enableTextSelection=function(){e&&(document.documentElement.style[e]=this._userSelect,delete this._userSelect)}}L.DomUtil.disableImageDrag=function(){L.DomEvent.on(window,"dragstart",L.DomEvent.preventDefault)},L.DomUtil.enableImageDrag=function(){L.DomEvent.off(window,"dragstart",L.DomEvent.preventDefault)}}();L.LatLng=function(t,n,a){if(isNaN(t)||isNaN(n))throw new Error("Invalid LatLng object: ("+t+", "+n+")");this.lat=+t,this.lng=+n,void 0!==a&&(this.alt=+a)},L.LatLng.prototype={equals:function(t,n){if(!t)return!1;t=L.latLng(t);var a=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return(void 0===n?1e-9:n)>=a},toString:function(t){return"LatLng("+L.Util.formatNum(this.lat,t)+", "+L.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return L.CRS.Earth.distance(this,L.latLng(t))},wrap:function(){return L.CRS.Earth.wrapLatLng(this)}},L.latLng=function(t,n){return t instanceof L.LatLng?t:L.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new L.LatLng(t[0],t[1],t[2]):new L.LatLng(t[0],t[1]):void 0===t||null===t?t:"object"==typeof t&&"lat"in t?new L.LatLng(t.lat,"lng"in t?t.lng:t.lon):void 0===n?null:new L.LatLng(t,n)};L.LatLngBounds=function(t,n){if(t)for(var s=n?[t,n]:t,e=0,a=s.length;a>e;e++)this.extend(s[e])},L.LatLngBounds.prototype={extend:function(t){var n,s,e=this._southWest,a=this._northEast;if(t instanceof L.LatLng)n=t,s=t;else{if(!(t instanceof L.LatLngBounds))return t?this.extend(L.latLng(t)||L.latLngBounds(t)):this;if(n=t._southWest,s=t._northEast,!n||!s)return this}return e||a?(e.lat=Math.min(n.lat,e.lat),e.lng=Math.min(n.lng,e.lng),a.lat=Math.max(s.lat,a.lat),a.lng=Math.max(s.lng,a.lng)):(this._southWest=new L.LatLng(n.lat,n.lng),this._northEast=new L.LatLng(s.lat,s.lng)),this},pad:function(t){var n=this._southWest,s=this._northEast,e=Math.abs(n.lat-s.lat)*t,a=Math.abs(n.lng-s.lng)*t;return new L.LatLngBounds(new L.LatLng(n.lat-e,n.lng-a),new L.LatLng(s.lat+e,s.lng+a))},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new L.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new L.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof L.LatLng?L.latLng(t):L.latLngBounds(t);var n,s,e=this._southWest,a=this._northEast;return t instanceof L.LatLngBounds?(n=t.getSouthWest(),s=t.getNorthEast()):n=s=t,n.lat>=e.lat&&s.lat<=a.lat&&n.lng>=e.lng&&s.lng<=a.lng},intersects:function(t){t=L.latLngBounds(t);var n=this._southWest,s=this._northEast,e=t.getSouthWest(),a=t.getNorthEast(),h=a.lat>=n.lat&&e.lat<=s.lat,o=a.lng>=n.lng&&e.lng<=s.lng;return h&&o},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=L.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},L.latLngBounds=function(t,n){return!t||t instanceof L.LatLngBounds?t:new L.LatLngBounds(t,n)};L.Projection={},L.Projection.LonLat={project:function(n){return new L.Point(n.lng,n.lat)},unproject:function(n){return new L.LatLng(n.y,n.x)},bounds:L.bounds([-180,-90],[180,90])};L.Projection.SphericalMercator={R:6378137,project:function(t){var n=Math.PI/180,a=1-1e-15,h=Math.max(Math.min(Math.sin(t.lat*n),a),-a);return new L.Point(this.R*t.lng*n,this.R*Math.log((1+h)/(1-h))/2)},unproject:function(t){var n=180/Math.PI;return new L.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*n,t.x*n/this.R)},bounds:function(){var t=6378137*Math.PI;return L.bounds([-t,-t],[t,t])}()};L.CRS={latLngToPoint:function(t,n){var r=this.projection.project(t),o=this.scale(n);return this.transformation._transform(r,o)},pointToLatLng:function(t,n){var r=this.scale(n),o=this.transformation.untransform(t,r);return this.projection.unproject(o)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},getProjectedBounds:function(t){if(this.infinite)return null;var n=this.projection.bounds,r=this.scale(t),o=this.transformation.transform(n.min,r),i=this.transformation.transform(n.max,r);return L.bounds(o,i)},wrapLatLng:function(t){var n=this.wrapLng?L.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,r=this.wrapLat?L.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat;return L.latLng(r,n)}};L.CRS.Simple=L.extend({},L.CRS,{projection:L.Projection.LonLat,transformation:new L.Transformation(1,0,-1,0),scale:function(n){return Math.pow(2,n)},distance:function(n,t){var a=t.lng-n.lng,o=t.lat-n.lat;return Math.sqrt(a*a+o*o)},infinite:!0});L.CRS.Earth=L.extend({},L.CRS,{wrapLng:[-180,180],R:6378137,distance:function(t,a){var n=Math.PI/180,h=t.lat*n,s=a.lat*n;return this.R*Math.acos(Math.sin(h)*Math.sin(s)+Math.cos(h)*Math.cos(s)*Math.cos((a.lng-t.lng)*n))}});L.CRS.EPSG3857=L.extend({},L.CRS.Earth,{code:"EPSG:3857",projection:L.Projection.SphericalMercator,transformation:function(){var r=.5/(Math.PI*L.Projection.SphericalMercator.R);return new L.Transformation(r,.5,-r,.5)}()}),L.CRS.EPSG900913=L.extend({},L.CRS.EPSG3857,{code:"EPSG:900913"});L.CRS.EPSG4326=L.extend({},L.CRS.Earth,{code:"EPSG:4326",projection:L.Projection.LonLat,transformation:new L.Transformation(1/180,1,-1/180,.5)});L.Map=L.Evented.extend({options:{crs:L.CRS.EPSG3857,fadeAnimation:!0,trackResize:!0,markerZoomAnimation:!0},initialize:function(t,i){i=L.setOptions(this,i),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),i.maxBounds&&this.setMaxBounds(i.maxBounds),i.center&&void 0!==i.zoom&&this.setView(L.latLng(i.center),i.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(t,i){return i=void 0===i?this.getZoom():i,this._resetView(L.latLng(t),this._limitZoom(i)),this},setZoom:function(t,i){return this._loaded?this.setView(this.getCenter(),t,{zoom:i}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,i){return this.setZoom(this._zoom+(t||1),i)},zoomOut:function(t,i){return this.setZoom(this._zoom-(t||1),i)},setZoomAround:function(t,i,e){var n=this.getZoomScale(i),o=this.getSize().divideBy(2),s=t instanceof L.Point?t:this.latLngToContainerPoint(t),a=s.subtract(o).multiplyBy(1-1/n),r=this.containerPointToLatLng(o.add(a));return this.setView(r,i,{zoom:e})},fitBounds:function(t,i){i=i||{},t=t.getBounds?t.getBounds():L.latLngBounds(t);var e=L.point(i.paddingTopLeft||i.padding||[0,0]),n=L.point(i.paddingBottomRight||i.padding||[0,0]),o=this.getBoundsZoom(t,!1,e.add(n));o=i.maxZoom?Math.min(i.maxZoom,o):o;var s=n.subtract(e).divideBy(2),a=this.project(t.getSouthWest(),o),r=this.project(t.getNorthEast(),o),h=this.unproject(a.add(r).divideBy(2).add(s),o);return this.setView(h,o,i)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,i){return this.setView(t,this._zoom,{pan:i})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(L.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=L.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):this.off("moveend",this._panInsideMaxBounds)},panInsideBounds:function(t,i){var e=this.getCenter(),n=this._limitCenter(e,this._zoom,t);return e.equals(n)?this:this.panTo(n,i)},invalidateSize:function(t){if(!this._loaded)return this;t=L.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var i=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var e=this.getSize(),n=i.divideBy(2).round(),o=e.divideBy(2).round(),s=n.subtract(o);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:e})):this},addHandler:function(t,i){if(!i)return this;var e=this[t]=new i(this);return this._handlers.push(e),this.options[t]&&e.enable(),this},remove:function(){this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=void 0}return L.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload"),this},createPane:function(t,i){var e="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=L.DomUtil.create("div",e,i||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),i=this.unproject(t.getBottomLeft()),e=this.unproject(t.getTopRight());return new L.LatLngBounds(i,e)},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,i,e){t=L.latLngBounds(t);var n,o=this.getMinZoom()-(i?1:0),s=this.getMaxZoom(),a=this.getSize(),r=t.getNorthWest(),h=t.getSouthEast(),u=!0;e=L.point(e||[0,0]);do o++,n=this.project(h,o).subtract(this.project(r,o)).add(e),u=i?n.x<a.x||n.y<a.y:a.contains(n);while(u&&s>=o);return u&&i?null:i?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new L.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new L.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPixelWorldBounds:function(){return this.options.crs.getProjectedBounds(this.getZoom())},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var i=this.options.crs;return i.scale(t)/i.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.latLngToPoint(L.latLng(t),i)},unproject:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.pointToLatLng(L.point(t),i)},layerPointToLatLng:function(t){var i=L.point(t).add(this.getPixelOrigin());return this.unproject(i)},latLngToLayerPoint:function(t){var i=this.project(L.latLng(t))._round();return i._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(L.latLng(t))},distance:function(t,i){return this.options.crs.distance(L.latLng(t),L.latLng(i))},containerPointToLayerPoint:function(t){return L.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return L.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var i=this.containerPointToLayerPoint(L.point(t));return this.layerPointToLatLng(i)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(t)))},mouseEventToContainerPoint:function(t){return L.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var i=this._container=L.DomUtil.get(t);if(!i)throw new Error("Map container not found.");if(i._leaflet)throw new Error("Map container is already initialized.");i._leaflet=!0},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&L.Browser.any3d,L.DomUtil.addClass(t,"leaflet-container"+(L.Browser.touch?" leaflet-touch":"")+(L.Browser.retina?" leaflet-retina":"")+(L.Browser.ielt9?" leaflet-oldie":"")+(L.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var i=L.DomUtil.getStyle(t,"position");"absolute"!==i&&"relative"!==i&&"fixed"!==i&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=this.createPane("mapPane",this._container),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(L.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),L.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,i,e,n){var o=this._zoom!==i;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=i,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),e?this._initialTopLeftPoint._add(this._getMapPanePos()):L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));var s=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!e}),s&&this.fire("load"),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!e})},_rawPanBy:function(t){L.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){L.DomEvent&&(t=t||"on",L.DomEvent[t](this._container,"click dblclick mousedown mouseup mouseenter mouseleave mousemove contextmenu",this._handleMouseEvent,this),this.options.trackResize&&L.DomEvent[t](window,"resize",this._onResize,this))},_onResize:function(){L.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=L.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_handleMouseEvent:function(t){this._loaded&&this._fireMouseEvent(this,t,"mouseenter"===t.type?"mouseover":"mouseleave"===t.type?"mouseout":t.type)},_fireMouseEvent:function(t,i,e,n,o){if(e=e||i.type,!L.DomEvent._skipped(i)){if("click"===e){if(!i._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved()))return;t.fire("preclick")}if(t.listens(e,n)){"contextmenu"===e&&L.DomEvent.preventDefault(i),("click"===e||"dblclick"===e||"contextmenu"===e)&&L.DomEvent.stopPropagation(i);var s={originalEvent:i,containerPoint:this.mouseEventToContainerPoint(i)};s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=o||this.layerPointToLatLng(s.layerPoint),t.fire(e,s,n)}}},_clearHandlers:function(){for(var t=0,i=this._handlers.length;i>t;t++)this._handlers[t].disable()},whenReady:function(t,i){return this._loaded?t.call(i||this,{target:this}):this.on("load",t,i),this},_getMapPanePos:function(){return L.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,i){var e=this.getSize()._divideBy(2);return this.project(t,i)._subtract(e)._round()},_latLngToNewLayerPoint:function(t,i,e){var n=this._getNewTopLeftPoint(e,i).add(this._getMapPanePos());return this.project(t,i)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,i,e){if(!e)return t;var n=this.project(t,i),o=this.getSize().divideBy(2),s=new L.Bounds(n.subtract(o),n.add(o)),a=this._getBoundsOffset(s,e,i);return this.unproject(n.add(a),i)},_limitOffset:function(t,i){if(!i)return t;var e=this.getPixelBounds(),n=new L.Bounds(e.min.add(t),e.max.add(t));return t.add(this._getBoundsOffset(n,i))},_getBoundsOffset:function(t,i,e){var n=this.project(i.getNorthWest(),e).subtract(t.min),o=this.project(i.getSouthEast(),e).subtract(t.max),s=this._rebound(n.x,-o.x),a=this._rebound(n.y,-o.y);return new L.Point(s,a)},_rebound:function(t,i){return t+i>0?Math.round(t-i)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(i))},_limitZoom:function(t){var i=this.getMinZoom(),e=this.getMaxZoom();return Math.max(i,Math.min(e,t))}}),L.map=function(t,i){return new L.Map(t,i)};L.Layer=L.Evented.extend({options:{pane:"overlayPane"},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},_layerAdd:function(t){var o=t.target;o.hasLayer(this)&&(this._map=o,this._zoomAnimated=o._zoomAnimated,this.onAdd(o),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.getEvents&&o.on(this.getEvents(),this),this.fire("add"),o.fire("layeradd",{layer:this}))}}),L.Map.include({addLayer:function(t){var o=L.stamp(t);return this._layers[o]?t:(this._layers[o]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var o=L.stamp(t);return this._layers[o]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),t.getEvents&&this.off(t.getEvents(),t),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&L.stamp(t)in this._layers},eachLayer:function(t,o){for(var i in this._layers)t.call(o,this._layers[i]);return this},_addLayers:function(t){t=t?L.Util.isArray(t)?t:[t]:[];for(var o=0,i=t.length;i>o;o++)this.addLayer(t[o])},_addZoomLimit:function(t){(isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[L.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var o=L.stamp(t);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,o=-1/0,i=this._getZoomSpan();for(var e in this._zoomBoundLayers){var a=this._zoomBoundLayers[e].options;t=void 0===a.minZoom?t:Math.min(t,a.minZoom),o=void 0===a.maxZoom?o:Math.max(o,a.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=1/0===t?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange")}});L.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:L.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var a=Math.PI/180,h=this.R,M=t.lat*a,n=this.R_MINOR/h,o=Math.sqrt(1-n*n),r=o*Math.sin(M),e=Math.tan(Math.PI/4-M/2)/Math.pow((1-r)/(1+r),o/2);return M=-h*Math.log(Math.max(e,1e-10)),new L.Point(t.lng*a*h,M)},unproject:function(t){for(var a,h=180/Math.PI,M=this.R,n=this.R_MINOR/M,o=Math.sqrt(1-n*n),r=Math.exp(-t.y/M),e=Math.PI/2-2*Math.atan(r),s=0,i=.1;15>s&&Math.abs(i)>1e-7;s++)a=o*Math.sin(e),a=Math.pow((1-a)/(1+a),o/2),i=Math.PI/2-2*Math.atan(r*a)-e,e+=i;return new L.LatLng(e*h,t.x*h/M)}};L.CRS.EPSG3395=L.extend({},L.CRS.Earth,{code:"EPSG:3395",projection:L.Projection.Mercator,transformation:function(){var r=.5/(Math.PI*L.Projection.Mercator.R);return new L.Transformation(r,.5,-r,.5)}()});L.GridLayer=L.Layer.extend({options:{pane:"tilePane",tileSize:256,opacity:1,unloadInvisibleTiles:L.Browser.mobile,updateWhenIdle:L.Browser.mobile,updateInterval:150},initialize:function(t){t=L.setOptions(this,t)},onAdd:function(){this._initContainer(),this.options.updateWhenIdle||(this._update=L.Util.throttle(this._update,this.options.updateInterval,this)),this._reset(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._clearBgBuffer(),L.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null},bringToFront:function(){return this._map&&(L.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(L.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},getEvents:function(){var t={viewreset:this._reset,moveend:this._update};return this.options.updateWhenIdle||(t.move=this._update),this._zoomAnimated&&(t.zoomstart=this._startZoomAnim,t.zoomanim=this._animateZoom,t.zoomend=this._endZoomAnim),t},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var i,e=this.getPane().children,n=-t(-1/0,1/0),s=0,o=e.length;o>s;s++)i=e[s].style.zIndex,e[s]!==this._container&&i&&(n=t(n,+i));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){var t=this.options.opacity;if(L.Browser.ielt9)for(var i in this._tiles)L.DomUtil.setOpacity(this._tiles[i],t);else L.DomUtil.setOpacity(this._container,t)},_initContainer:function(){if(!this._container){if(this._container=L.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._zoomAnimated){var t="leaflet-tile-container leaflet-zoom-animated";this._bgBuffer=L.DomUtil.create("div",t,this._container),this._tileContainer=L.DomUtil.create("div",t,this._container),L.DomUtil.setTransform(this._tileContainer)}else this._tileContainer=this._container;this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container)}},_reset:function(t){for(var i in this._tiles)this.fire("tileunload",{tile:this._tiles[i]});this._tiles={},this._tilesToLoad=0,this._tilesTotal=0,this._tileContainer.innerHTML="",this._zoomAnimated&&t&&t.hard&&this._clearBgBuffer(),this._tileNumBounds=this._getTileNumBounds(),this._resetWrap()},_resetWrap:function(){var t=this._map,i=t.options.crs;if(!i.infinite){var e=this._getTileSize();i.wrapLng&&(this._wrapLng=[Math.floor(t.project([0,i.wrapLng[0]]).x/e),Math.ceil(t.project([0,i.wrapLng[1]]).x/e)]),i.wrapLat&&(this._wrapLat=[Math.floor(t.project([i.wrapLat[0],0]).y/e),Math.ceil(t.project([i.wrapLat[1],0]).y/e)])}},_getTileSize:function(){return this.options.tileSize},_update:function(){if(this._map){var t=this._map.getPixelBounds(),i=this._map.getZoom(),e=this._getTileSize();if(!(i>this.options.maxZoom||i<this.options.minZoom)){var n=L.bounds(t.min.divideBy(e).floor(),t.max.divideBy(e).floor());this._addTiles(n),this.options.unloadInvisibleTiles&&this._removeOtherTiles(n)}}},_addTiles:function(t){var i,e,n,s=[],o=t.getCenter(),a=this._map.getZoom();for(i=t.min.y;i<=t.max.y;i++)for(e=t.min.x;e<=t.max.x;e++)n=new L.Point(e,i),n.z=a,this._tileCoordsToKey(n)in this._tiles||!this._isValidTile(n)||s.push(n);var r=s.length;if(0!==r){this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=r,this._tilesTotal+=r,s.sort(function(t,i){return t.distanceTo(o)-i.distanceTo(o)});var l=document.createDocumentFragment();for(e=0;r>e;e++)this._addTile(s[e],l);this._tileContainer.appendChild(l)}},_isValidTile:function(t){var i=this._map.options.crs;if(!i.infinite){var e=this._tileNumBounds;if(!i.wrapLng&&(t.x<e.min.x||t.x>e.max.x)||!i.wrapLat&&(t.y<e.min.y||t.y>e.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return L.latLngBounds(this.options.bounds).intersects(n)},_tileCoordsToBounds:function(t){var i=this._map,e=this.options.tileSize,n=t.multiplyBy(e),s=n.add([e,e]),o=i.wrapLatLng(i.unproject(n,t.z)),a=i.wrapLatLng(i.unproject(s,t.z));return new L.LatLngBounds(o,a)},_tileCoordsToKey:function(t){return t.x+":"+t.y},_keyToTileCoords:function(t){var i=t.split(":"),e=parseInt(i[0],10),n=parseInt(i[1],10);return new L.Point(e,n)},_removeOtherTiles:function(t){for(var i in this._tiles)t.contains(this._keyToTileCoords(i))||this._removeTile(i)},_removeTile:function(t){var i=this._tiles[t];L.DomUtil.remove(i),delete this._tiles[t],this.fire("tileunload",{tile:i})},_initTile:function(t){var i=this._getTileSize();L.DomUtil.addClass(t,"leaflet-tile"),t.style.width=i+"px",t.style.height=i+"px",t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,L.Browser.ielt9&&this.options.opacity<1&&L.DomUtil.setOpacity(t,this.options.opacity),L.Browser.android&&!L.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,i){var e=this._getTilePos(t);this._wrapCoords(t);var n=this.createTile(t,L.bind(this._tileReady,this));this._initTile(n),this.createTile.length<2&&setTimeout(L.bind(this._tileReady,this,null,n),0),L.DomUtil.setPosition(n,e,!0),this._tiles[this._tileCoordsToKey(t)]=n,i.appendChild(n),this.fire("tileloadstart",{tile:n})},_tileReady:function(t,i){t&&this.fire("tileerror",{error:t,tile:i}),L.DomUtil.addClass(i,"leaflet-tile-loaded"),this.fire("tileload",{tile:i}),this._tilesToLoad--,0===this._tilesToLoad&&this._visibleTilesReady()},_visibleTilesReady:function(){this.fire("load"),this._zoomAnimated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(L.bind(this._clearBgBuffer,this),300))},_getTilePos:function(t){return t.multiplyBy(this._getTileSize()).subtract(this._map.getPixelOrigin())},_wrapCoords:function(t){t.x=this._wrapLng?L.Util.wrapNum(t.x,this._wrapLng):t.x,t.y=this._wrapLat?L.Util.wrapNum(t.y,this._wrapLat):t.y},_getTileNumBounds:function(){var t=this._map.getPixelWorldBounds(),i=this._getTileSize();return t?L.bounds(t.min.divideBy(i).floor(),t.max.divideBy(i).ceil().subtract([1,1])):null},_startZoomAnim:function(){this._prepareBgBuffer(),this._prevTranslate=this._translate||new L.Point(0,0),this._prevScale=this._scale},_animateZoom:function(t){this._translate=this._prevTranslate.multiplyBy(t.scale).add(t.origin.multiplyBy(1-t.scale)),this._scale=this._prevScale*t.scale,L.DomUtil.setTransform(this._bgBuffer,this._translate,this._scale)},_endZoomAnim:function(){var t=this._tileContainer;t.style.visibility="",L.DomUtil.toFront(t)},_clearBgBuffer:function(){var t=this._map,i=this._bgBuffer;t&&!t._animatingZoom&&!t.touchZoom._zooming&&i&&(i.innerHTML="",L.DomUtil.setTransform(i))},_prepareBgBuffer:function(){var t=this._tileContainer,i=this._bgBuffer;return this._abortLoading&&this._abortLoading(),this._tilesToLoad/this._tilesTotal>.5?(t.style.visibility="hidden",void 0):(i.style.visibility="hidden",L.DomUtil.setTransform(i),this._tileContainer=i,this._bgBuffer=t,this._translate=new L.Point(0,0),this._scale=1,clearTimeout(this._clearBgBufferTimer),void 0)}}),L.gridLayer=function(t){return new L.GridLayer(t)};L.TileLayer=L.GridLayer.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",zoomOffset:0},initialize:function(t,o){this._url=t,o=L.setOptions(this,o),o.detectRetina&&L.Browser.retina&&o.maxZoom>0&&(o.tileSize=Math.floor(o.tileSize/2),o.zoomOffset++,o.minZoom=Math.max(0,o.minZoom),o.maxZoom--),"string"==typeof o.subdomains&&(o.subdomains=o.subdomains.split(""))},setUrl:function(t,o){return this._url=t,o||this.redraw(),this},createTile:function(t,o){var i=document.createElement("img");return i.onload=L.bind(this._tileOnLoad,this,o,i),i.onerror=L.bind(this._tileOnError,this,o,i),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){return L.Util.template(this._url,L.extend({r:this.options.detectRetina&&L.Browser.retina&&this.options.maxZoom>0?"@2x":"",s:this._getSubdomain(t),x:t.x,y:this.options.tms?this._tileNumBounds.max.y-t.y:t.y,z:this._getZoomForUrl()},this.options))},_tileOnLoad:function(t,o){t(null,o)},_tileOnError:function(t,o,i){var e=this.options.errorTileUrl;e&&(o.src=e),t(i,o)},_getTileSize:function(){var t=this._map,o=this.options,i=t.getZoom()+o.zoomOffset,e=o.maxNativeZoom;return e&&i>e?Math.round(t.getZoomScale(i)/t.getZoomScale(e)*o.tileSize):o.tileSize},_removeTile:function(t){var o=this._tiles[t];L.GridLayer.prototype._removeTile.call(this,t),L.Browser.android||(o.onload=null,o.src=L.Util.emptyImageUrl)},_getZoomForUrl:function(){var t=this.options,o=this._map.getZoom();return t.zoomReverse&&(o=t.maxZoom-o),o+=t.zoomOffset,t.maxNativeZoom?Math.min(o,t.maxNativeZoom):o},_getSubdomain:function(t){var o=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var t,o;for(t in this._tiles)o=this._tiles[t],o.complete||(o.onload=L.Util.falseFn,o.onerror=L.Util.falseFn,o.src=L.Util.emptyImageUrl,L.DomUtil.remove(o))}}),L.tileLayer=function(t,o){return new L.TileLayer(t,o)};L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(s,t){this._url=s;var e=L.extend({},this.defaultWmsParams);for(var i in t)this.options.hasOwnProperty(i)||"crs"===i||(e[i]=t[i]);t=L.setOptions(this,t),e.width=e.height=t.tileSize*(t.detectRetina&&L.Browser.retina?2:1),this.wmsParams=e},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,L.TileLayer.prototype.onAdd.call(this,s)},getTileUrl:function(s){var t=this._tileCoordsToBounds(s),e=this._crs.project(t.getNorthWest()),i=this._crs.project(t.getSouthEast()),r=(this._wmsVersion>=1.3&&this._crs===L.CRS.EPSG4326?[i.y,e.x,e.y,i.x]:[e.x,i.y,i.x,e.y]).join(","),a=L.Util.template(this._url,{s:this._getSubdomain(s)});return a+L.Util.getParamString(this.wmsParams,a,!0)+"&BBOX="+r},setParams:function(s,t){return L.extend(this.wmsParams,s),t||this.redraw(),this}}),L.tileLayer.wms=function(s,t){return new L.TileLayer.WMS(s,t)};L.ImageOverlay=L.Layer.extend({options:{opacity:1},initialize:function(t,i,e){this._url=t,this._bounds=L.latLngBounds(i),L.setOptions(this,e)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){L.DomUtil.remove(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},bringToFront:function(){return this._map&&L.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&L.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var t={viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},_initImage:function(){var t=this._image=L.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,t.onload=L.bind(this.fire,this,"load"),t.src=this._url},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),t.zoom,t.center),e=this._map._latLngToNewLayerPoint(this._bounds.getSouthEast(),t.zoom,t.center).subtract(i),o=i.add(e._multiplyBy((1-1/t.scale)/2));L.DomUtil.setTransform(this._image,o,t.scale)},_reset:function(){var t=this._image,i=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),e=i.getSize();L.DomUtil.setPosition(t,i.min),t.style.width=e.x+"px",t.style.height=e.y+"px"},_updateOpacity:function(){L.DomUtil.setOpacity(this._image,this.options.opacity)}}),L.imageOverlay=function(t,i,e){return new L.ImageOverlay(t,i,e)};L.Icon=L.Class.extend({initialize:function(t){L.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,n){var e=this._getIconUrl(t);if(!e){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var o=this._createImg(e,n&&"IMG"===n.tagName?n:null);return this._setIconStyles(o,t),o},_setIconStyles:function(t,n){var e=this.options,o=L.point(e[n+"Size"]),i=L.point("shadow"===n&&e.shadowAnchor||e.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+n+" "+(e.className||""),i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,n){return n=n||document.createElement("img"),n.src=t,n},_getIconUrl:function(t){return L.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),L.icon=function(t){return new L.Icon(t)};L.Icon.Default=L.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];var n=L.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+(L.Browser.retina&&"icon"===t?"-2x":"")+".png"}}),L.Icon.Default.imagePath=function(){var t,e,n,o,r=document.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=r.length;e>t;t++)if(n=r[t].src,n.match(a))return o=n.split(a)[0],(o?o+"/":"")+"images"}();L.Marker=L.Layer.extend({options:{pane:"markerPane",icon:new L.Icon.Default,clickable:!0,keyboard:!0,zIndexOffset:0,opacity:1,riseOffset:250},initialize:function(t,i){L.setOptions(this,i),this._latlng=L.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._initIcon(),this.update()},onRemove:function(){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow()},getEvents:function(){var t={viewreset:this.update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getLatLng:function(){return this._latlng},setLatLng:function(t){var i=this._latlng;return this._latlng=L.latLng(t),this.update(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,i="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),o=!1;n!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(n.title=t.title),t.alt&&(n.alt=t.alt)),L.DomUtil.addClass(n,i),t.keyboard&&(n.tabIndex="0"),this._icon=n,this._initInteraction(),t.riseOnHover&&L.DomEvent.on(n,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this);var e=t.icon.createShadow(this._shadow),s=!1;e!==this._shadow&&(this._removeShadow(),s=!0),e&&L.DomUtil.addClass(e,i),this._shadow=e,t.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),e&&s&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&L.DomEvent.off(this._icon,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this),L.DomUtil.remove(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&L.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){L.DomUtil.setPosition(this._icon,t),this._shadow&&L.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(i)},_initInteraction:function(){this.options.clickable&&(L.DomUtil.addClass(this._icon,"leaflet-clickable"),L.DomEvent.on(this._icon,"click dblclick mousedown mouseup mouseover mouseout contextmenu keypress",this._fireMouseEvent,this),L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable()))},_fireMouseEvent:function(t,i){return"mousedown"===t.type&&L.DomEvent.preventDefault(t),"click"===t.type&&this.dragging&&this.dragging.moved()?(L.DomEvent.stopPropagation(t),void 0):("keypress"===t.type&&13===t.keyCode&&(i="click"),this._map&&this._map._fireMouseEvent(this,t,i,!0,this._latlng),void 0)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;L.DomUtil.setOpacity(this._icon,t),this._shadow&&L.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),L.marker=function(t,i){return new L.Marker(t,i)};L.DivIcon=L.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(n){var t=n&&"DIV"===n.tagName?n:document.createElement("div"),e=this.options;return t.innerHTML=e.html!==!1?e.html:"",e.bgPos&&(t.style.backgroundPosition=-e.bgPos.x+"px "+-e.bgPos.y+"px"),this._setIconStyles(t,"icon"),t},createShadow:function(){return null}}),L.divIcon=function(n){return new L.DivIcon(n)};L.Map.mergeOptions({closePopupOnClick:!0}),L.Popup=L.Layer.extend({options:{pane:"popupPane",minWidth:50,maxWidth:300,offset:[0,7],autoPan:!0,autoPanPadding:[5,5],closeButton:!0,zoomAnimation:!0},initialize:function(t,i){L.setOptions(this,t),this._source=i},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&this.options.zoomAnimation,this._container||this._initLayout(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,1),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this},!0)},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._fadeAnimated?(L.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(L.bind(L.DomUtil.remove,L.DomUtil,this._container),200)):L.DomUtil.remove(this._container),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this},!0)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=L.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={viewreset:this._updatePosition},i=this.options;return this._zoomAnimated&&(t.zoomanim=this._animateZoom),("closeOnClick"in i?i.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),i.keepInView&&(t.moveend=this._adjustPan),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",i=this._container=L.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"));if(this.options.closeButton){var o=this._closeButton=L.DomUtil.create("a",t+"-close-button",i);o.href="#close",o.innerHTML="&#215;",L.DomEvent.on(o,"click",this._onCloseButtonClick,this)}var n=this._wrapper=L.DomUtil.create("div",t+"-content-wrapper",i);this._contentNode=L.DomUtil.create("div",t+"-content",n),L.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",L.DomEvent.stopPropagation),this._tipContainer=L.DomUtil.create("div",t+"-tip-container",i),this._tip=L.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){var t=this._contentNode;if("string"==typeof this._content)t.innerHTML=this._content;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,i=t.style;i.width="",i.whiteSpace="nowrap";var o=t.offsetWidth;o=Math.min(o,this.options.maxWidth),o=Math.max(o,this.options.minWidth),i.width=o+1+"px",i.whiteSpace="",i.height="";var n=t.offsetHeight,e=this.options.maxHeight,s="leaflet-popup-scrolled";e&&n>e?(i.height=e+"px",L.DomUtil.addClass(t,s)):L.DomUtil.removeClass(t,s),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),i=L.point(this.options.offset);this._zoomAnimated?L.DomUtil.setPosition(this._container,t):i=i.add(t);var o=this._containerBottom=-i.y,n=this._containerLeft=-Math.round(this._containerWidth/2)+i.x;this._container.style.bottom=o+"px",this._container.style.left=n+"px"}},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);L.DomUtil.setPosition(this._container,i)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,i=this._container.offsetHeight,o=this._containerWidth,n=new L.Point(this._containerLeft,-i-this._containerBottom);this._zoomAnimated&&n._add(L.DomUtil.getPosition(this._container));var e=t.layerPointToContainerPoint(n),s=L.point(this.options.autoPanPadding),a=L.point(this.options.autoPanPaddingTopLeft||s),p=L.point(this.options.autoPanPaddingBottomRight||s),h=t.getSize(),r=0,c=0;e.x+o+p.x>h.x&&(r=e.x+o-h.x+p.x),e.x-r-a.x<0&&(r=e.x-a.x),e.y+i+p.y>h.y&&(c=e.y+i-h.y+p.y),e.y-c-a.y<0&&(c=e.y-a.y),(r||c)&&t.fire("autopanstart").panBy([r,c])}},_onCloseButtonClick:function(t){this._close(),L.DomEvent.stop(t)}}),L.popup=function(t,i){return new L.Popup(t,i)},L.Map.include({openPopup:function(t,i,o){if(!(t instanceof L.Popup)){var n=t;t=new L.Popup(o).setContent(n)}return i&&t.setLatLng(i),this.hasLayer(t)?this:(this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}});L.Layer.include({bindPopup:function(p,t){return p instanceof L.Popup?(this._popup=p,p._source=this):((!this._popup||t)&&(this._popup=new L.Popup(t,this)),this._popup.setContent(p)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(p){return this._popup&&this._map&&this._map.openPopup(this._popup,p||this._latlng||this.getCenter()),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._map?this.closePopup():this.openPopup()),this},setPopupContent:function(p){return this._popup&&this._popup.setContent(p),this},getPopup:function(){return this._popup},_openPopup:function(p){this._map.openPopup(this._popup,p.latlng)},_movePopup:function(p){this._popup.setLatLng(p.latlng)}});L.Marker.include({bindPopup:function(o,p){var t=L.point(this.options.icon.options.popupAnchor||[0,0]).add(L.Popup.prototype.options.offset);return p=L.extend({offset:t},p),L.Layer.prototype.bindPopup.call(this,o,p)},_openPopup:L.Layer.prototype.togglePopup});L.LayerGroup=L.Layer.extend({initialize:function(r){this._layers={};var e,t;if(r)for(e=0,t=r.length;t>e;e++)this.addLayer(r[e])},addLayer:function(r){var e=this.getLayerId(r);return this._layers[e]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var e=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(r){return!!r&&(r in this._layers||this.getLayerId(r)in this._layers)},clearLayers:function(){for(var r in this._layers)this.removeLayer(this._layers[r]);return this},invoke:function(r){var e,t,a=Array.prototype.slice.call(arguments,1);for(e in this._layers)t=this._layers[e],t[r]&&t[r].apply(t,a);return this},onAdd:function(r){for(var e in this._layers)r.addLayer(this._layers[e])},onRemove:function(r){for(var e in this._layers)r.removeLayer(this._layers[e])},eachLayer:function(r,e){for(var t in this._layers)r.call(e,this._layers[t]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];for(var e in this._layers)r.push(this._layers[e]);return r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return L.stamp(r)}}),L.layerGroup=function(r){return new L.LayerGroup(r)};L.FeatureGroup=L.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),L.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),L.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new L.LatLngBounds;return this.eachLayer(function(e){t.extend(e.getBounds?e.getBounds():e.getLatLng())}),t}}),L.featureGroup=function(t){return new L.FeatureGroup(t)};L.Renderer=L.Layer.extend({options:{padding:0},initialize:function(t){L.setOptions(this,t),L.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&L.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){L.DomUtil.remove(this._container)},getEvents:function(){var t={moveend:this._update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},_animateZoom:function(t){var n=t.origin.subtract(this._map._getCenterLayerPoint()),i=this._bounds.min.add(n.multiplyBy(1-t.scale));L.DomUtil.setTransform(this._container,i,t.scale)},_update:function(){var t=this.options.padding,n=this._map.getSize(),i=this._map.containerPointToLayerPoint(n.multiplyBy(-t)).round();this._bounds=new L.Bounds(i,i.add(n.multiplyBy(1+2*t)).round())}}),L.Map.include({getRenderer:function(t){var n=t.options.renderer||this.options.renderer||this._renderer;return n||(n=this._renderer=L.SVG&&L.svg()||L.Canvas&&L.canvas()),this.hasLayer(n)||this.addLayer(n),n}});L.Path=L.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",fillOpacity:.2,clickable:!0},onAdd:function(){this._renderer=this._map.getRenderer(this),this._renderer._initPath(this),this._project(),this._update(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},getEvents:function(){return{viewreset:this._project,moveend:this._update}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return L.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer._bringToBack(this),this},_fireMouseEvent:function(t,e){this._map._fireMouseEvent(this,t,e,!0)},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(L.Browser.touch?10:0)}});L.LineUtil={simplify:function(t,n){if(!n||!t.length)return t.slice();var i=n*n;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,n,i){return Math.sqrt(this._sqClosestPointOnSegment(t,n,i,!0))},closestPointOnSegment:function(t,n,i){return this._sqClosestPointOnSegment(t,n,i)},_simplifyDP:function(t,n){var i=t.length,e=typeof Uint8Array!=void 0+""?Uint8Array:Array,s=new e(i);s[0]=s[i-1]=1,this._simplifyDPStep(t,s,n,0,i-1);var r,o=[];for(r=0;i>r;r++)s[r]&&o.push(t[r]);return o},_simplifyDPStep:function(t,n,i,e,s){var r,o,y,u=0;for(o=e+1;s-1>=o;o++)y=this._sqClosestPointOnSegment(t[o],t[e],t[s],!0),y>u&&(r=o,u=y);u>i&&(n[r]=1,this._simplifyDPStep(t,n,i,e,r),this._simplifyDPStep(t,n,i,r,s))},_reducePoints:function(t,n){for(var i=[t[0]],e=1,s=0,r=t.length;r>e;e++)this._sqDist(t[e],t[s])>n&&(i.push(t[e]),s=e);return r-1>s&&i.push(t[r-1]),i},clipSegment:function(t,n,i,e){var s,r,o,y=e?this._lastCode:this._getBitCode(t,i),u=this._getBitCode(n,i);for(this._lastCode=u;;){if(!(y|u))return[t,n];if(y&u)return!1;s=y||u,r=this._getEdgeIntersection(t,n,s,i),o=this._getBitCode(r,i),s===y?(t=r,y=o):(n=r,u=o)}},_getEdgeIntersection:function(t,n,i,e){var s,r,o=n.x-t.x,y=n.y-t.y,u=e.min,f=e.max;return 8&i?(s=t.x+o*(f.y-t.y)/y,r=f.y):4&i?(s=t.x+o*(u.y-t.y)/y,r=u.y):2&i?(s=f.x,r=t.y+y*(f.x-t.x)/o):1&i&&(s=u.x,r=t.y+y*(u.x-t.x)/o),new L.Point(s,r,!0)},_getBitCode:function(t,n){var i=0;return t.x<n.min.x?i|=1:t.x>n.max.x&&(i|=2),t.y<n.min.y?i|=4:t.y>n.max.y&&(i|=8),i},_sqDist:function(t,n){var i=n.x-t.x,e=n.y-t.y;return i*i+e*e},_sqClosestPointOnSegment:function(t,n,i,e){var s,r=n.x,o=n.y,y=i.x-r,u=i.y-o,f=y*y+u*u;return f>0&&(s=((t.x-r)*y+(t.y-o)*u)/f,s>1?(r=i.x,o=i.y):s>0&&(r+=y*s,o+=u*s)),y=t.x-r,u=t.y-o,e?y*y+u*u:new L.Point(r,o)}};L.Polyline=L.Path.extend({options:{smoothFactor:1},initialize:function(t,n){L.setOptions(this,n),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},addLatLng:function(t){return t=L.latLng(t),this._latlngs.push(t),this._bounds.extend(t),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._setLatLngs(this._latlngs),this.redraw(),t},closestLayerPoint:function(t){for(var n,s,i=1/0,e=null,o=L.LineUtil._sqClosestPointOnSegment,r=0,a=this._parts.length;a>r;r++)for(var h=this._parts[r],l=1,_=h.length;_>l;l++){n=h[l-1],s=h[l];var g=o(t,n,s,!0);i>g&&(i=g,e=o(t,n,s))}return e&&(e.distance=Math.sqrt(i)),e},getCenter:function(){var t,n,s,i,e,o,r,a=this._rings[0],h=a.length;for(t=0,n=0;h-1>t;t++)n+=a[t].distanceTo(a[t+1])/2;for(t=0,i=0;h-1>t;t++)if(e=a[t],o=a[t+1],s=e.distanceTo(o),i+=s,i>n)return r=(i-n)/s,this._map.layerPointToLatLng([o.x-r*(o.x-e.x),o.y-r*(o.y-e.y)])},getBounds:function(){return this._bounds},_setLatLngs:function(t){this._bounds=new L.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_convertLatLngs:function(t){for(var n=[],s=this._flat(t),i=0,e=t.length;e>i;i++)s?(n[i]=L.latLng(t[i]),this._bounds.extend(n[i])):n[i]=this._convertLatLngs(t[i]);return n},_flat:function(t){return!L.Util.isArray(t[0])||"object"!=typeof t[0][0]},_project:function(){this._rings=[],this._projectLatlngs(this._latlngs,this._rings);var t=this._clickTolerance(),n=new L.Point(t,-t);this._latlngs.length&&(this._pxBounds=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getSouthWest())._subtract(n),this._map.latLngToLayerPoint(this._bounds.getNorthEast())._add(n)))},_projectLatlngs:function(t,n){var s,i,e=t[0]instanceof L.LatLng,o=t.length;if(e){for(i=[],s=0;o>s;s++)i[s]=this._map.latLngToLayerPoint(t[s]);n.push(i)}else for(s=0;o>s;s++)this._projectLatlngs(t[s],n)},_clipPoints:function(){if(this.options.noClip)return this._parts=this._rings,void 0;this._parts=[];var t,n,s,i,e,o,r,a=this._parts,h=this._renderer._bounds;for(t=0,s=0,i=this._rings.length;i>t;t++)for(r=this._rings[t],n=0,e=r.length;e-1>n;n++)o=L.LineUtil.clipSegment(r[n],r[n+1],h,n),o&&(a[s]=a[s]||[],a[s].push(o[0]),(o[1]!==r[n+1]||n===e-2)&&(a[s].push(o[1]),s++))},_simplifyPoints:function(){for(var t=this._parts,n=this.options.smoothFactor,s=0,i=t.length;i>s;s++)t[s]=L.LineUtil.simplify(t[s],n)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),L.polyline=function(t,n){return new L.Polyline(t,n)};L.PolyUtil={},L.PolyUtil.clipPolygon=function(e,o){var t,d,i,n,_,c,g,l,r,h=[1,4,2,8],s=L.LineUtil;for(d=0,g=e.length;g>d;d++)e[d]._code=s._getBitCode(e[d],o);for(n=0;4>n;n++){for(l=h[n],t=[],d=0,g=e.length,i=g-1;g>d;i=d++)_=e[d],c=e[i],_._code&l?c._code&l||(r=s._getEdgeIntersection(c,_,l,o),r._code=s._getBitCode(r,o),t.push(r)):(c._code&l&&(r=s._getEdgeIntersection(c,_,l,o),r._code=s._getBitCode(r,o),t.push(r)),t.push(_));e=t}return e};L.Polygon=L.Polyline.extend({options:{fill:!0},getCenter:function(){var t,n,i,o,e,r,s,l,a,h=this._rings[0];for(s=l=a=0,t=0,i=h.length,n=i-1;i>t;n=t++)o=h[t],e=h[n],r=o.y*e.x-e.y*o.x,l+=(o.x+e.x)*r,a+=(o.y+e.y)*r,s+=3*r;return this._map.layerPointToLatLng([l/s,a/s])},_convertLatLngs:function(t){var n=L.Polyline.prototype._convertLatLngs.call(this,t),i=n.length;return i>=2&&n[0]instanceof L.LatLng&&n[0].equals(n[i-1])&&n.pop(),n},_clipPoints:function(){if(this.options.noClip)return this._parts=this._rings,void 0;var t=this._renderer._bounds,n=this.options.weight,i=new L.Point(n,n);t=new L.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[];for(var o,e=0,r=this._rings.length;r>e;e++)o=L.PolyUtil.clipPolygon(this._rings[e],t),o.length&&this._parts.push(o)},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),L.polygon=function(t,n){return new L.Polygon(t,n)};L.Rectangle=L.Polygon.extend({initialize:function(t,n){L.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),n)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=L.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),L.rectangle=function(t,n){return new L.Rectangle(t,n)};L.CircleMarker=L.Path.extend({options:{fill:!0,radius:10},initialize:function(t,i){L.setOptions(this,i),this._latlng=L.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=L.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var i=t&&t.radius||this._radius;return L.Path.prototype.setStyle.call(this,t),this.setRadius(i),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,i=this._radiusY||t,s=this._clickTolerance(),n=[t+s,i+s];this._pxBounds=new L.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),L.circleMarker=function(t,i){return new L.CircleMarker(t,i)};L.Circle=L.CircleMarker.extend({initialize:function(t,i,a){L.setOptions(this,a),this._latlng=L.latLng(t),this._mRadius=i},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY];return new L.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:L.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,i=this._latlng.lat,a=this._map,s=a.options.crs;if(s.distance===L.CRS.Earth.distance){var n=Math.PI/180,r=this._mRadius/L.CRS.Earth.R/n,e=a.project([i+r,t]),h=a.project([i-r,t]),o=e.add(h).divideBy(2),u=a.unproject(o).lat,c=Math.acos((Math.cos(r*n)-Math.sin(i*n)*Math.sin(u*n))/(Math.cos(i*n)*Math.cos(u*n)))/n;this._point=o.subtract(a.getPixelOrigin()),this._radius=isNaN(c)?0:Math.max(Math.round(o.x-a.project([u,t-c]).x),1),this._radiusY=Math.max(Math.round(o.y-e.y),1)}else{var d=s.unproject(s.project(this._latlng).subtract([this._mRadius,0]));this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint(d).x}this._updateBounds()}}),L.circle=function(t,i,a){return new L.Circle(t,i,a)};L.SVG=L.Renderer.extend({_initContainer:function(){this._container=L.SVG.create("svg"),this._paths={},this._initEvents(),this._container.setAttribute("pointer-events","none")},_update:function(){if(!this._map._animatingZoom||!this._bounds){L.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container,o=this.getPane();L.Browser.mobileWebkit&&o.removeChild(i),L.DomUtil.setPosition(i,t.min),i.setAttribute("width",e.x),i.setAttribute("height",e.y),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),L.Browser.mobileWebkit&&o.appendChild(i)}},_initPath:function(t){var e=t._path=L.SVG.create("path");t.options.className&&L.DomUtil.addClass(e,t.options.className),t.options.clickable&&L.DomUtil.addClass(e,"leaflet-clickable"),this._updateStyle(t)},_addPath:function(t){var e=t._path;this._container.appendChild(e),this._paths[L.stamp(e)]=t},_removePath:function(t){var e=t._path;L.DomUtil.remove(e),delete this._paths[L.stamp(e)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule","evenodd")):e.setAttribute("fill","none"),e.setAttribute("pointer-events",i.pointerEvents||(i.clickable?"visiblePainted":"none")))},_updatePoly:function(t,e){this._setPath(t,L.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,o=t._radiusY||i,s="a"+i+","+o+" 0 1,0 ",n=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+s+2*i+",0 "+s+2*-i+",0 ";this._setPath(t,n)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){L.DomUtil.toFront(t._path)},_bringToBack:function(t){L.DomUtil.toBack(t._path)},_initEvents:function(){L.DomEvent.on(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu",this._fireMouseEvent,this)},_fireMouseEvent:function(t){this._paths[L.stamp(t.target||t.srcElement)]&&this._paths[L.stamp(t.target||t.srcElement)]._fireMouseEvent(t)}}),L.extend(L.SVG,{create:function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,o,s,n,r,a,u="";for(i=0,s=t.length;s>i;i++){for(r=t[i],o=0,n=r.length;n>o;o++)a=r[o],u+=(o?"L":"M")+a.x+" "+a.y;u+=e?L.Browser.svg?"z":"x":""}return u||"M0 0"}}),L.Browser.svg=!(!document.createElementNS||!L.SVG.create("svg").createSVGRect),L.svg=function(t){return L.Browser.svg||L.Browser.vml?new L.SVG(t):null};L.Browser.vml=!L.Browser.svg&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(a){return!1}}(),L.SVG.include(L.Browser.vml?{_initContainer:function(){this._container=L.DomUtil.create("div","leaflet-vml-container"),this._paths={},this._initEvents()},_update:function(){this._map._animatingZoom||L.Renderer.prototype._update.call(this)},_initPath:function(t){var e=t._container=L.SVG.create("shape");L.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=L.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t)},_addPath:function(t){var e=t._container;this._container.appendChild(e),this._paths[L.stamp(e)]=t},_removePath:function(t){var e=t._container;L.DomUtil.remove(e),delete this._paths[L.stamp(e)]},_updateStyle:function(t){var e=t._stroke,a=t._fill,r=t.options,n=t._container;n.stroked=!!r.stroke,n.filled=!!r.fill,r.stroke?(e||(e=t._stroke=L.SVG.create("stroke"),n.appendChild(e)),e.weight=r.weight+"px",e.color=r.color,e.opacity=r.opacity,e.dashStyle=r.dashArray?L.Util.isArray(r.dashArray)?r.dashArray.join(" "):r.dashArray.replace(/( *, *)/g," "):"",e.endcap=r.lineCap.replace("butt","flat"),e.joinstyle=r.lineJoin):e&&(n.removeChild(e),t._stroke=null),r.fill?(a||(a=t._fill=L.SVG.create("fill"),n.appendChild(a)),a.color=r.fillColor||r.color,a.opacity=r.fillOpacity):a&&(n.removeChild(a),t._fill=null)},_updateCircle:function(t){var e=t._point,a=Math.round(t._radius),r=Math.round(t._radiusY||a);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+a+","+r+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){L.DomUtil.toFront(t._path.parentNode)},_bringToBack:function(t){L.DomUtil.toBack(t._path.parentNode)}}:{}),L.Browser.vml&&(L.SVG.create=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}());L.Canvas=L.Renderer.extend({onAdd:function(){L.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");L.DomEvent.on(t,"mousemove",this._onMouseMove,this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),this._ctx=t.getContext("2d")},_update:function(){if(!this._map._animatingZoom||!this._bounds){L.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=L.Browser.retina?2:1;L.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",L.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y)}},_initPath:function(t){this._layers[L.stamp(t)]=t},_addPath:L.Util.falseFn,_removePath:function(t){t._removed=!0,this._requestRedraw(t)},_updatePath:function(t){this._redrawBounds=t._pxBounds,this._draw(!0),t._project(),t._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(t){this._requestRedraw(t)},_requestRedraw:function(t){this._map&&(this._redrawBounds=this._redrawBounds||new L.Bounds,this._redrawBounds.extend(t._pxBounds.min).extend(t._pxBounds.max),this._redrawRequest=this._redrawRequest||L.Util.requestAnimFrame(this._redraw,this))},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(t){this._clear=t;var e;for(var i in this._layers)e=this._layers[i],(!this._redrawBounds||e._pxBounds.intersects(this._redrawBounds))&&e._updatePath(),t&&e._removed&&(delete e._removed,delete this._layers[i])},_updatePoly:function(t,e){var i,n,o,s,r=t._parts,a=r.length,l=this._ctx;if(a){for(l.beginPath(),i=0;a>i;i++){for(n=0,o=r[i].length;o>n;n++)s=r[i][n],l[n?"lineTo":"moveTo"](s.x,s.y);e&&l.closePath()}this._fillStroke(l,t)}},_updateCircle:function(t){if(!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=this._clear,n=e.options;t.globalCompositeOperation=i?"destination-out":"source-over",n.fill&&(t.globalAlpha=i?1:n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill("evenodd")),n.stroke&&(t.globalAlpha=i?1:n.opacity,e._prevWeight=t.lineWidth=i?e._prevWeight+1:n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){var e=this._map.mouseEventToLayerPoint(t);for(var i in this._layers)this._layers[i]._containsPoint(e)&&this._layers[i]._fireMouseEvent(t)},_onMouseMove:function(t){if(this._map&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);for(var i in this._layers)this._handleHover(this._layers[i],t,e)}},_handleHover:function(t,e,i){t.options.clickable&&(t._containsPoint(i)?(t._mouseInside||(L.DomUtil.addClass(this._container,"leaflet-clickable"),t._fireMouseEvent(e,"mouseover"),t._mouseInside=!0),t._fireMouseEvent(e)):t._mouseInside&&(L.DomUtil.removeClass(this._container,"leaflet-clickable"),t._fireMouseEvent(e,"mouseout"),t._mouseInside=!1))},_bringToFront:L.Util.falseFn,_bringToBack:L.Util.falseFn}),L.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),L.canvas=function(t){return L.Browser.canvas?new L.Canvas(t):null},L.Polyline.prototype._containsPoint=function(t,e){var i,n,o,s,r,a,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,s=this._parts.length;s>i;i++)for(a=this._parts[i],n=0,r=a.length,o=r-1;r>n;o=n++)if((e||0!==n)&&L.LineUtil.pointToSegmentDistance(t,a[o],a[n])<=l)return!0;return!1},L.Polygon.prototype._containsPoint=function(t){var e,i,n,o,s,r,a,l,_=!1;if(!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;a>o;o++)for(e=this._parts[o],s=0,l=e.length,r=l-1;l>s;r=s++)i=e[s],n=e[r],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(_=!_);return _||L.Polyline.prototype._containsPoint.call(this,t,!0)},L.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()};L.GeoJSON=L.FeatureGroup.extend({initialize:function(t,e){L.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,o,r,n=L.Util.isArray(t)?t:t.features;if(n){for(e=0,o=n.length;o>e;e++)r=n[e],(r.geometries||r.geometry||r.features||r.coordinates)&&this.addData(r);return this}var i=this.options;if(!i.filter||i.filter(t)){var a=L.GeoJSON.geometryToLayer(t,i);return a.feature=L.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),i.onEachFeature&&i.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){t.options=t.defaultOptions,this._setLayerStyle(t,this.options.style)},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),L.extend(L.GeoJSON,{geometryToLayer:function(t,e){var o,r,n,i,a="Feature"===t.type?t.geometry:t,s=a.coordinates,u=[],l=e&&e.pointToLayer,g=e&&e.coordsToLatLng||this.coordsToLatLng;switch(a.type){case"Point":return o=g(s),l?l(t,o):new L.Marker(o);case"MultiPoint":for(n=0,i=s.length;i>n;n++)o=g(s[n]),u.push(l?l(t,o):new L.Marker(o));return new L.FeatureGroup(u);case"LineString":case"MultiLineString":return r=this.coordsToLatLngs(s,"LineString"===a.type?0:1,g),new L.Polyline(r,e);case"Polygon":case"MultiPolygon":return r=this.coordsToLatLngs(s,"Polygon"===a.type?1:2,g),new L.Polygon(r,e);case"GeometryCollection":for(n=0,i=a.geometries.length;i>n;n++)u.push(this.geometryToLayer({geometry:a.geometries[n],type:"Feature",properties:t.properties},e));return new L.FeatureGroup(u);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new L.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,o){for(var r,n=[],i=0,a=t.length;a>i;i++)r=e?this.coordsToLatLngs(t[i],e-1,o):(o||this.coordsToLatLng)(t[i]),n.push(r);return n},latLngToCoords:function(t){return void 0!==t.alt?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,o){for(var r=[],n=0,i=t.length;i>n;n++)r.push(e?L.GeoJSON.latLngsToCoords(t[n],e-1,o):L.GeoJSON.latLngToCoords(t[n]));return!e&&o&&r.push(r[0]),r},getFeature:function(t,e){return t.feature?L.extend({},t.feature,{geometry:e}):L.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var PointToGeoJSON={toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:"Point",coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())})}};L.Marker.include(PointToGeoJSON),L.Circle.include(PointToGeoJSON),L.CircleMarker.include(PointToGeoJSON),L.Polyline.prototype.toGeoJSON=function(){var t=!this._flat(this._latlngs),e=L.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return L.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},L.Polygon.prototype.toGeoJSON=function(){var t=!this._flat(this._latlngs),e=t&&!this._flat(this._latlngs[0]),o=L.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t&&1===this._latlngs.length&&(e=!0,o=[o]),t||(o=[o]),L.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:o})},L.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),L.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,o=[];return this.eachLayer(function(t){if(t.toGeoJSON){var r=t.toGeoJSON();o.push(e?r.geometry:L.GeoJSON.asFeature(r))}}),e?L.GeoJSON.getFeature(this,{geometries:o,type:"GeometryCollection"}):{type:"FeatureCollection",features:o}}}),L.geoJson=function(t,e){return new L.GeoJSON(t,e)};var eventsKey="_leaflet_events";L.DomEvent={on:function(e,t,n,o){if("object"==typeof t)for(var r in t)this._on(e,r,t[r],n);else{t=L.Util.splitWords(t);for(var i=0,s=t.length;s>i;i++)this._on(e,t[i],n,o)}return this},off:function(e,t,n,o){if("object"==typeof t)for(var r in t)this._off(e,r,t[r],n);else{t=L.Util.splitWords(t);for(var i=0,s=t.length;s>i;i++)this._off(e,t[i],n,o)}return this},_on:function(e,t,n,o){var r=t+L.stamp(n)+(o?"_"+L.stamp(o):"");if(e[eventsKey]&&e[eventsKey][r])return this;var i=function(t){return n.call(o||e,t||window.event)},s=i;return L.Browser.pointer&&0===t.indexOf("touch")?this.addPointerListener(e,t,i,r):(L.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener&&this.addDoubleTapListener(e,i,r),"addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",i,!1),e.addEventListener(t,i,!1)):"mouseenter"===t||"mouseleave"===t?(i=function(t){return t=t||window.event,L.DomEvent._checkMouse(e,t)?s(t):void 0},e.addEventListener("mouseenter"===t?"mouseover":"mouseout",i,!1)):("click"===t&&L.Browser.android&&(i=function(e){return L.DomEvent._filterClick(e,s)}),e.addEventListener(t,i,!1)):"attachEvent"in e&&e.attachEvent("on"+t,i),e[eventsKey]=e[eventsKey]||{},e[eventsKey][r]=i,this)},_off:function(e,t,n,o){var r=t+L.stamp(n)+(o?"_"+L.stamp(o):""),i=e[eventsKey]&&e[eventsKey][r];return i?(L.Browser.pointer&&0===t.indexOf("touch")?this.removePointerListener(e,t,r):L.Browser.touch&&"dblclick"===t&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,r):"removeEventListener"in e?"mousewheel"===t?(e.removeEventListener("DOMMouseScroll",i,!1),e.removeEventListener(t,i,!1)):e.removeEventListener("mouseenter"===t?"mouseover":"mouseleave"===t?"mouseout":t,i,!1):"detachEvent"in e&&e.detachEvent("on"+t,i),e[eventsKey][r]=null,this):this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,L.DomEvent._skipped(e),this},disableScrollPropagation:function(e){return L.DomEvent.on(e,"mousewheel MozMousePixelScroll",L.DomEvent.stopPropagation)},disableClickPropagation:function(e){var t=L.DomEvent.stopPropagation;return L.DomEvent.on(e,L.Draggable.START.join(" "),t),L.DomEvent.on(e,{click:L.DomEvent._fakeStop,dblclick:t})},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return L.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,t){if(!t)return new L.Point(e.clientX,e.clientY);var n=t.getBoundingClientRect();return new L.Point(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop)},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_skipEvents:{},_fakeStop:function(e){L.DomEvent._skipEvents[e.type]=!0},_skipped:function(e){var t=this._skipEvents[e.type];return this._skipEvents[e.type]=!1,t},_checkMouse:function(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(o){return!1}return n!==e},_filterClick:function(e,t){var n=e.timeStamp||e.originalEvent.timeStamp,o=L.DomEvent._lastClick&&n-L.DomEvent._lastClick;return o&&o>100&&500>o||e.target._simulatedClick&&!e._simulated?(L.DomEvent.stop(e),void 0):(L.DomEvent._lastClick=n,t(e))}},L.DomEvent.addListener=L.DomEvent.on,L.DomEvent.removeListener=L.DomEvent.off;L.Draggable=L.Evented.extend({statics:{START:L.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){this._enabled||(L.DomEvent.on(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.off(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(L.DomEvent.stopPropagation(t),L.Draggable._disabled||(L.DomUtil.disableImageDrag(),L.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new L.Point(e.clientX,e.clientY),this._startPos=this._newPos=L.DomUtil.getPosition(this._element),L.DomEvent.on(document,L.Draggable.MOVE[t.type],this._onMove,this).on(document,L.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return this._moved=!0,void 0;var e=t.touches&&1===t.touches.length?t.touches[0]:t,o=new L.Point(e.clientX,e.clientY),i=o.subtract(this._startPoint);(i.x||i.y)&&(L.Browser.touch&&Math.abs(i.x)+Math.abs(i.y)<3||(L.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=L.DomUtil.getPosition(this._element).subtract(i),L.DomUtil.addClass(document.body,"leaflet-dragging"),L.DomUtil.addClass(t.target||t.srcElement,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,L.Util.cancelAnimFrame(this._animRequest),this._animRequest=L.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),L.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(t){L.DomUtil.removeClass(document.body,"leaflet-dragging"),L.DomUtil.removeClass(t.target||t.srcElement,"leaflet-drag-target");for(var e in L.Draggable.MOVE)L.DomEvent.off(document,L.Draggable.MOVE[e],this._onMove,this).off(document,L.Draggable.END[e],this._onUp,this);L.DomUtil.enableImageDrag(),L.DomUtil.enableTextSelection(),this._moved&&this._moving&&(L.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}});L.Handler=L.Class.extend({initialize:function(e){this._map=e},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}});L.Map.mergeOptions({dragging:!0,inertia:!L.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:L.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),L.Map.Drag=L.Handler.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new L.Draggable(i._mapPane,i._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),i.on("viewreset",this._onViewReset,this),i.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDown:function(){this._map._panAnim&&this._map._panAnim.stop()},_onDragStart:function(){var i=this._map;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var i=this._lastTime=+new Date,t=this._lastPos=this._draggable._newPos;this._positions.push(t),this._times.push(i),i-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var i=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_onPreDrag:function(){var i=this._worldWidth,t=Math.round(i/2),a=this._initialWorldOffset,e=this._draggable._newPos.x,s=(e-t+a)%i+t-a,n=(e+t+a)%i-t-a,r=Math.abs(s+a)<Math.abs(n+a)?s:n;this._draggable._newPos.x=r},_onDragEnd:function(i){var t=this._map,a=t.options,e=+new Date-this._lastTime,s=!a.inertia||e>a.inertiaThreshold||!this._positions[0];if(t.fire("dragend",i),s)t.fire("moveend");else{var n=this._lastPos.subtract(this._positions[0]),r=(this._lastTime+e-this._times[0])/1e3,o=a.easeLinearity,h=n.multiplyBy(o/r),d=h.distanceTo([0,0]),_=Math.min(a.inertiaMaxSpeed,d),g=h.multiplyBy(_/d),l=_/(a.inertiaDeceleration*o),p=g.multiplyBy(-l/2).round();p.x&&p.y?(p=t._limitOffset(p,t.options.maxBounds),L.Util.requestAnimFrame(function(){t.panBy(p,{duration:l,easeLinearity:o,noMoveStart:!0})})):t.fire("moveend")}}}),L.Map.addInitHook("addHandler","dragging",L.Map.Drag);L.Map.mergeOptions({doubleClickZoom:!0}),L.Map.DoubleClickZoom=L.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var i=this._map,e=i.getZoom()+(o.originalEvent.shiftKey?-1:1);"center"===i.options.doubleClickZoom?i.setZoom(e):i.setZoomAround(o.containerPoint,e)}}),L.Map.addInitHook("addHandler","doubleClickZoom",L.Map.DoubleClickZoom);L.Map.mergeOptions({scrollWheelZoom:!0}),L.Map.ScrollWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:L.DomEvent.preventDefault},this),this._delta=0},removeHooks:function(){L.DomEvent.off(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:L.DomEvent.preventDefault},this)},_onWheelScroll:function(e){var o=L.DomEvent.getWheelDelta(e);this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var t=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(L.bind(this._performZoom,this),t),L.DomEvent.stop(e)},_performZoom:function(){var e=this._map,o=this._delta,t=e.getZoom();o=o>0?Math.ceil(o):Math.floor(o),o=Math.max(Math.min(o,4),-4),o=e._limitZoom(t+o)-t,this._delta=0,this._startTime=null,o&&("center"===e.options.scrollWheelZoom?e.setZoom(t+o):e.setZoomAround(this._lastMousePos,t+o))}}),L.Map.addInitHook("addHandler","scrollWheelZoom",L.Map.ScrollWheelZoom);L.PosAnimation=L.Evented.extend({run:function(t,i,s,e){this.stop(),this._el=t,this._inProgress=!0,this._newPos=i,this.fire("start"),t.style[L.DomUtil.TRANSITION]="all "+(s||.25)+"s cubic-bezier(0,0,"+(e||.5)+",1)",L.DomEvent.on(t,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this),L.DomUtil.setPosition(t,i),L.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(L.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(this._newPos=this._getPos(),L.DomUtil.setPosition(this._el,this._newPos),this._onTransitionEnd(),L.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,this.fire("step"),void 0):(this._onTransitionEnd(),void 0)},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,i,s,e=this._el,n=window.getComputedStyle(e);if(L.Browser.any3d){if(s=n[L.DomUtil.TRANSFORM].match(this._transformRe),!s)return;t=parseFloat(s[1]),i=parseFloat(s[2])}else t=parseFloat(n.left),i=parseFloat(n.top);return new L.Point(t,i,!0)},_onTransitionEnd:function(){L.DomEvent.off(this._el,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[L.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}});L.Map.include({setView:function(i,t,n){if(t=void 0===t?this._zoom:this._limitZoom(t),i=this._limitCenter(L.latLng(i),t,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){void 0!==n.animate&&(n.zoom=L.extend({animate:n.animate},n.zoom),n.pan=L.extend({animate:n.animate},n.pan));var e=this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,t,n.zoom):this._tryAnimatedPan(i,n.pan);if(e)return clearTimeout(this._sizeTimer),this}return this._resetView(i,t),this},panBy:function(i,t){if(i=L.point(i).round(),t=t||{},!i.x&&!i.y)return this;if(this._panAnim||(this._panAnim=new L.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),t.animate!==!1){L.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(i);this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){L.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,t){var n=this._getCenterOffset(i)._floor();return(t&&t.animate)===!0||this.getSize().contains(n)?(this.panBy(n,t),!0):!1}});L.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var zoomAnimated=L.DomUtil.TRANSITION&&L.Browser.any3d&&!L.Browser.mobileOpera;zoomAnimated&&L.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&L.DomEvent.on(this._mapPane,L.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),L.Map.include(zoomAnimated?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,i,o){if(this._animatingZoom)return!0;if(o=o||{},!this._zoomAnimated||o.animate===!1||this._nothingToAnimate()||Math.abs(i-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(i),a=this._getCenterOffset(t)._divideBy(1-1/n);return o.animate===!0||this.getSize().contains(a)?(L.Util.requestAnimFrame(function(){this.fire("movestart").fire("zoomstart")._animateZoom(t,i,!0)},this),!0):!1},_animateZoom:function(t,i,o){o&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=i,L.Draggable&&(L.Draggable._disabled=!0),L.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));var n=this.getZoomScale(i),a=this._getCenterLayerPoint().add(this._getCenterOffset(t)._divideBy(1-1/n));this.fire("zoomanim",{center:t,zoom:i,origin:a,scale:n})},_onZoomTransitionEnd:function(){this._animatingZoom=!1,L.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),L.Draggable&&(L.Draggable._disabled=!1)}}:{});L.extend(L.DomEvent,{_touchstart:L.Browser.msPointer?"MSPointerDown":L.Browser.pointer?"pointerdown":"touchstart",_touchend:L.Browser.msPointer?"MSPointerUp":L.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(e,t,r){function n(e){var t;if(L.Browser.pointer?(c.push(e.pointerId),t=c.length):t=e.touches.length,!(t>1)){var r=Date.now(),n=r-(i||r);s=e.touches?e.touches[0]:e,u=n>0&&d>=n,i=r}}function o(e){if(L.Browser.pointer){var r=c.indexOf(e.pointerId);if(-1===r)return;c.splice(r,1)}if(u){if(L.Browser.pointer){var n,o,d={};for(o in s)n=s[o],d[o]=n&&n.bind?n.bind(s):n;s=d}s.type="dblclick",t(s),i=null}}var i,s,u=!1,d=250,c=[],h="_leaflet_",a=this._touchstart,p=this._touchend;e[h+a+r]=n,e[h+p+r]=o;var v=L.Browser.pointer?document.documentElement:e;return e.addEventListener(a,n,!1),v.addEventListener(p,o,!1),L.Browser.pointer&&v.addEventListener(L.DomEvent.POINTER_CANCEL,o,!1),this},removeDoubleTapListener:function(e,t){var r="_leaflet_",n=L.Browser.pointer?document.documentElement:e,o=e[r+this._touchend+t];return e.removeEventListener(this._touchstart,e[r+this._touchstart+t],!1),n.removeEventListener(this._touchend,o,!1),L.Browser.pointer&&n.removeEventListener(L.DomEvent.POINTER_CANCEL,o,!1),this}});L.extend(L.DomEvent,{POINTER_DOWN:L.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:L.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:L.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:L.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:{},addPointerListener:function(e,t,n,i){return"touchstart"===t?this._addPointerStart(e,n,i):"touchmove"===t?this._addPointerMove(e,n,i):"touchend"===t&&this._addPointerEnd(e,n,i),this},removePointerListener:function(e,t,n){var i=e["_leaflet_"+t+n];return"touchstart"===t?e.removeEventListener(this.POINTER_DOWN,i,!1):"touchmove"===t?e.removeEventListener(this.POINTER_MOVE,i,!1):"touchend"===t&&(e.removeEventListener(this.POINTER_UP,i,!1),e.removeEventListener(this.POINTER_CANCEL,i,!1)),this},_addPointerStart:function(e,t,n){var i=L.bind(function(e){L.DomEvent.preventDefault(e),this._pointers[e.pointerId]=e,this._handlePointer(e,t)},this);if(e["_leaflet_touchstart"+n]=i,e.addEventListener(this.POINTER_DOWN,i,!1),!this._pointerDocListener){var o=L.bind(function(e){delete this._pointers[e.pointerId]},this);document.documentElement.addEventListener(this.POINTER_UP,o,!1),document.documentElement.addEventListener(this.POINTER_CANCEL,o,!1),this._pointerDocListener=!0}},_handlePointer:function(e,t){e.touches=[];for(var n in this._pointers)e.touches.push(this._pointers[n]);e.changedTouches=[e],t(e)},_addPointerMove:function(e,t,n){var i=L.bind(function(e){(e.pointerType!==e.MSPOINTER_TYPE_MOUSE&&"mouse"!==e.pointerType||0!==e.buttons)&&(this._pointers[e.pointerId]=e,this._handlePointer(e,t))},this);e["_leaflet_touchmove"+n]=i,e.addEventListener(this.POINTER_MOVE,i,!1)},_addPointerEnd:function(e,t,n){var i=L.bind(function(e){delete this._pointers[e.pointerId],this._handlePointer(e,t)},this);e["_leaflet_touchend"+n]=i,e.addEventListener(this.POINTER_UP,i,!1),e.addEventListener(this.POINTER_CANCEL,i,!1)}});L.Map.mergeOptions({touchZoom:L.Browser.touch&&!L.Browser.android23,bounceAtZoomLimits:!0}),L.Map.TouchZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var o=this._map;if(t.touches&&2===t.touches.length&&!o._animatingZoom&&!this._zooming){var e=o.mouseEventToLayerPoint(t.touches[0]),i=o.mouseEventToLayerPoint(t.touches[1]),n=o._getCenterLayerPoint();this._startCenter=e.add(i)._divideBy(2),this._startDist=e.distanceTo(i),this._moved=!1,this._zooming=!0,this._centerOffset=n.subtract(this._startCenter),o._panAnim&&o._panAnim.stop(),L.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var o=this._map,e=o.mouseEventToLayerPoint(t.touches[0]),i=o.mouseEventToLayerPoint(t.touches[1]);this._scale=e.distanceTo(i)/this._startDist,this._delta=e._add(i)._divideBy(2)._subtract(this._startCenter),(o.options.bounceAtZoomLimits||!(o.getZoom()===o.getMinZoom()&&this._scale<1||o.getZoom()===o.getMaxZoom()&&this._scale>1))&&(this._moved||(o.fire("movestart").fire("zoomstart"),this._moved=!0),L.Util.cancelAnimFrame(this._animRequest),this._animRequest=L.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),L.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map;this._center="center"===t.options.touchZoom?t.getCenter():t.layerPointToLatLng(this._getTargetCenter()),this._zoom=t.getScaleZoom(this._scale),t._animateZoom(this._center,this._zoom)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return this._zooming=!1,void 0;this._zooming=!1,L.Util.cancelAnimFrame(this._animRequest),L.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var t=this._map,o=t.getZoom(),e=this._zoom-o,i=t._limitZoom(o+(e>0?Math.ceil(e):Math.floor(e)));t._animateZoom(this._center,i,!0)},_getTargetCenter:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),L.Map.addInitHook("addHandler","touchZoom",L.Map.TouchZoom);L.Map.mergeOptions({tap:!0,tapTolerance:15}),L.Map.Tap=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(L.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,clearTimeout(this._holdTimeout),void 0;var e=t.touches[0],o=e.target;this._startPos=this._newPos=new L.Point(e.clientX,e.clientY),o.tagName&&"a"===o.tagName.toLowerCase()&&L.DomUtil.addClass(o,"leaflet-active"),this._holdTimeout=setTimeout(L.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),L.DomEvent.on(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),L.DomEvent.off(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],o=e.target;o&&o.tagName&&"a"===o.tagName.toLowerCase()&&L.DomUtil.removeClass(o,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new L.Point(e.clientX,e.clientY)},_simulateEvent:function(t,e){var o=document.createEvent("MouseEvents");o._simulated=!0,e.target._simulatedClick=!0,o.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(o)}}),L.Browser.touch&&!L.Browser.pointer&&L.Map.addInitHook("addHandler","tap",L.Map.Tap);L.Map.mergeOptions({boxZoom:!0}),L.Map.BoxZoom=L.Handler.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){L.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_onMouseDown:function(o){return this._moved=!1,!o.shiftKey||1!==o.which&&1!==o.button?!1:(L.DomUtil.disableTextSelection(),L.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(o),L.DomEvent.on(document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this),void 0)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=L.DomUtil.create("div","leaflet-zoom-box",this._container),L.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var t=new L.Bounds(this._point,this._startPoint),i=t.getSize();L.DomUtil.setPosition(this._box,t.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(L.DomUtil.remove(this._box),L.DomUtil.removeClass(this._container,"leaflet-crosshair")),L.DomUtil.enableTextSelection(),L.DomUtil.enableImageDrag(),L.DomEvent.off(document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(){if(this._finish(),this._moved){var o=new L.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(o){27===o.keyCode&&this._finish()}}),L.Map.addInitHook("addHandler","boxZoom",L.Map.BoxZoom);L.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),L.Map.Keyboard=L.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(o){this._map=o,this._setPanOffset(o.options.keyboardPanOffset),this._setZoomOffset(o.options.keyboardZoomOffset)},addHooks:function(){var o=this._map._container;-1===o.tabIndex&&(o.tabIndex="0"),L.DomEvent.on(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),L.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,t=document.documentElement,n=o.scrollTop||t.scrollTop,s=o.scrollLeft||t.scrollLeft;this._map._container.focus(),window.scrollTo(s,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(o){var t,n,s=this._panKeys={},e=this.keyCodes;for(t=0,n=e.left.length;n>t;t++)s[e.left[t]]=[-1*o,0];for(t=0,n=e.right.length;n>t;t++)s[e.right[t]]=[o,0];for(t=0,n=e.down.length;n>t;t++)s[e.down[t]]=[0,o];for(t=0,n=e.up.length;n>t;t++)s[e.up[t]]=[0,-1*o]},_setZoomOffset:function(o){var t,n,s=this._zoomKeys={},e=this.keyCodes;for(t=0,n=e.zoomIn.length;n>t;t++)s[e.zoomIn[t]]=o;for(t=0,n=e.zoomOut.length;n>t;t++)s[e.zoomOut[t]]=-o},_addHooks:function(){L.DomEvent.on(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){L.DomEvent.off(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var t=o.keyCode,n=this._map;if(t in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[t]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(t in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[t])}L.DomEvent.stop(o)}}}),L.Map.addInitHook("addHandler","keyboard",L.Map.Keyboard);L.Handler.MarkerDrag=L.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new L.Draggable(a,a)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),L.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),L.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var a=this._marker,r=a._shadow,t=L.DomUtil.getPosition(a._icon),e=a._map.layerPointToLatLng(t);r&&L.DomUtil.setPosition(r,t),a._latlng=e,a.fire("move",{latlng:e}).fire("drag")},_onDragEnd:function(a){this._marker.fire("moveend").fire("dragend",a)}});L.Control=L.Class.extend({options:{position:"topright"},initialize:function(t){L.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var o=this._map;return o&&o.removeControl(this),this.options.position=t,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var o=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return L.DomUtil.addClass(o,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(o,i.firstChild):i.appendChild(o),this},remove:function(){return L.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),L.control=function(t){return new L.Control(t)},L.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,r){var e=n+t+" "+n+r;o[t+r]=L.DomUtil.create("div",e,i)}var o=this._controlCorners={},n="leaflet-",i=this._controlContainer=L.DomUtil.create("div",n+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){L.DomUtil.remove(this._controlContainer)}});L.Control.Zoom=L.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(o){var t="leaflet-control-zoom",n=L.DomUtil.create("div",t+" leaflet-bar"),e=this.options;return this._zoomInButton=this._createButton(e.zoomInText,e.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(e.zoomOutText,e.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(o){this._map.zoomIn(o.shiftKey?3:1)},_zoomOut:function(o){this._map.zoomOut(o.shiftKey?3:1)},_createButton:function(o,t,n,e,i){var m=L.DomUtil.create("a",n,e);return m.innerHTML=o,m.href="#",m.title=t,L.DomEvent.on(m,"mousedown dblclick",L.DomEvent.stopPropagation).on(m,"click",L.DomEvent.stop).on(m,"click",i,this).on(m,"click",this._refocusOnMap,this),m},_updateDisabled:function(){var o=this._map,t="leaflet-disabled";L.DomUtil.removeClass(this._zoomInButton,t),L.DomUtil.removeClass(this._zoomOutButton,t),o._zoom===o.getMinZoom()&&L.DomUtil.addClass(this._zoomOutButton,t),o._zoom===o.getMaxZoom()&&L.DomUtil.addClass(this._zoomInButton,t)}}),L.Map.mergeOptions({zoomControl:!0}),L.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new L.Control.Zoom,this.addControl(this.zoomControl))}),L.control.zoom=function(o){return new L.Control.Zoom(o)};L.Control.Attribution=L.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){L.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=L.DomUtil.create("div","leaflet-control-attribution"),L.DomEvent.disableClickPropagation(this._container);for(var i in t._layers)t._layers[i].getAttribution&&this.addAttribution(t._layers[i].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var i in this._attributions)this._attributions[i]&&t.push(i);var o=[];this.options.prefix&&o.push(this.options.prefix),t.length&&o.push(t.join(", ")),this._container.innerHTML=o.join(" | ")}}}),L.Map.mergeOptions({attributionControl:!0}),L.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new L.Control.Attribution).addTo(this))}),L.control.attribution=function(t){return new L.Control.Attribution(t)};L.Control.Scale=L.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=L.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=L.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=L.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=L.CRS.Earth.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=1e3>e?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)-10+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),L.control.scale=function(t){return new L.Control.Scale(t)};L.Control.Layers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(e,t,a){L.setOptions(this,a),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var i in e)this._addLayer(e[i],i);for(i in t)this._addLayer(t[i],i,!0)},onAdd:function(){return this._initLayout(),this._update(),this._container},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update()},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update()},removeLayer:function(e){return e.off("add remove",this._onLayerChange,this),delete this._layers[L.stamp(e)],this._update()},_initLayout:function(){var e="leaflet-control-layers",t=this._container=L.DomUtil.create("div",e);t.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(t,"click",L.DomEvent.stopPropagation):L.DomEvent.disableClickPropagation(t).disableScrollPropagation(t);var a=this._form=L.DomUtil.create("form",e+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(t,{mouseenter:this._expand,mouseleave:this._collapse},this);var i=this._layersLink=L.DomUtil.create("a",e+"-toggle",t);i.href="#",i.title="Layers",L.Browser.touch?L.DomEvent.on(i,"click",L.DomEvent.stop).on(i,"click",this._expand,this):L.DomEvent.on(i,"focus",this._expand,this),L.DomEvent.on(a,"click",function(){setTimeout(L.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div",e+"-base",a),this._separator=L.DomUtil.create("div",e+"-separator",a),this._overlaysList=L.DomUtil.create("div",e+"-overlays",a),t.appendChild(a)},_addLayer:function(e,t,a){e.on("add remove",this._onLayerChange,this);var i=L.stamp(e);this._layers[i]={layer:e,name:t,overlay:a},this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e,t,a,i;for(a in this._layers)i=this._layers[a],this._addItem(i),t=t||i.overlay,e=e||!i.overlay;return this._separator.style.display=t&&e?"":"none",this}},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._layers[L.stamp(e.target)].overlay,a=t?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;a&&this._map.fire(a,e.target)},_createRadioElement:function(e,t){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=a,i.firstChild},_addItem:function(e){var t,a=document.createElement("label"),i=this._map.hasLayer(e.layer);e.overlay?(t=document.createElement("input"),t.type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=i):t=this._createRadioElement("leaflet-base-layers",i),t.layerId=L.stamp(e.layer),L.DomEvent.on(t,"click",this._onInputClick,this);var n=document.createElement("span");n.innerHTML=" "+e.name,a.appendChild(t),a.appendChild(n);var s=e.overlay?this._overlaysList:this._baseLayersList;return s.appendChild(a),a},_onInputClick:function(){var e,t,a,i=this._form.getElementsByTagName("input");this._handlingClick=!0;for(var n=0,s=i.length;s>n;n++)e=i[n],t=this._layers[e.layerId].layer,a=this._map.hasLayer(t),e.checked&&!a?this._map.addLayer(t):!e.checked&&a&&this._map.removeLayer(t);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){L.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded")}}),L.control.layers=function(e,t,a){return new L.Control.Layers(e,t,a)};L.PosAnimation=L.DomUtil.TRANSITION?L.PosAnimation:L.PosAnimation.extend({run:function(t,i,s,e){this.stop(),this._el=t,this._inProgress=!0,this._duration=s||.25,this._easeOutPower=1/Math.max(e||.5,.2),this._startPos=L.DomUtil.getPosition(t),this._offset=i.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=L.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,i=1e3*this._duration;i>t?this._runFrame(this._easeOut(t/i)):(this._runFrame(1),this._complete())},_runFrame:function(t){var i=this._startPos.add(this._offset.multiplyBy(t));L.DomUtil.setPosition(this._el,i),this.fire("step")},_complete:function(){L.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}});L.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(o){if(o=this._locateOptions=L.extend(this._defaultLocateOptions,o),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=L.bind(this._handleGeolocationResponse,this),i=L.bind(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,i,o):navigator.geolocation.getCurrentPosition(t,i,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){var t=o.code,i=o.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(o){var t=o.coords.latitude,i=o.coords.longitude,e=new L.LatLng(t,i),a=180*o.coords.accuracy/40075017,n=a/Math.cos(Math.PI/180*t),s=L.latLngBounds([t-a,i-n],[t+a,i+n]),c=this._locateOptions;if(c.setView){var r=this.getBoundsZoom(s);this.setView(e,c.maxZoom?Math.min(r,c.maxZoom):r)}var l={latlng:e,bounds:s,timestamp:o.timestamp};for(var h in o.coords)"number"==typeof o.coords[h]&&(l[h]=o.coords[h]);this.fire("locationfound",l)}});DG=new(function(){var n=function(){},t=function(){};return t.prototype=L,n.prototype=new t,n}());DG.when=function(n){function t(n,t,e,u){return r(n).then(t,e,u)}function e(n,t){this._message=n,this.inspect=t}function r(n){return o(function(t){t(n)})}function u(n){return t(n,s)}function i(){function n(n,i,o){t.resolve=t.resolver.resolve=function(t){return u?r(t):(u=!0,n(t),e)},t.reject=t.resolver.reject=function(n){return u?r(s(n)):(u=!0,i(n),e)},t.notify=t.resolver.notify=function(n){return o(n),n}}var t,e,u;return t={promise:J,resolve:J,reject:J,notify:J,resolver:{resolve:J,reject:J,notify:J}},t.promise=e=o(n),t}function o(n){return c(n,H.PromiseStatus&&H.PromiseStatus())}function c(n,t){function r(n,t,e,r){function u(u){u._message(n,t,e,r)}p?p.push(u):I(function(){u(a)})}function u(){return a?a.inspect():C()}function i(n){p&&(a=l(n),v(p,a),p=J,t&&m(a,t))}function o(n){i(s(n))}function c(n){p&&v(p,h(n))}var f,a,p=[];f=new e(r,u),f._status=t;try{n(i,o,c)}catch(y){o(y)}return f}function f(n){return a(new p(n),function(){return T(n)})}function s(n){return a(new y(n),function(){return x(n)})}function a(n,t){return new e(function(t,e,r){try{r(n[t].apply(n,e))}catch(u){r(s(u))}},t)}function h(n){return new e(function(t,e,r,u){var i=e[2];try{u("function"==typeof i?i(n):n)}catch(o){u(o)}})}function l(n){return n instanceof e?n:n===Object(n)&&"then"in n?o(function(t,e,r){I(function(){try{var u=n.then;"function"==typeof u?F(u,n,t,e,r):t(f(n))}catch(i){e(i)}})}):f(n)}function p(n){this.value=n}function y(n){this.reason=n}function v(n,t){I(function(){for(var e,r=0;e=n[r++];)e(t)})}function m(n,t){function e(){t.fulfilled()}function r(n){t.rejected(n)}n.then(e,r)}function d(n){return n&&"function"==typeof n.then}function g(n,e,r,u,i){return t(n,function(n){function c(r,u,i){function o(n){p(n)}function c(n){l(n)}var f,s,a,h,l,p,y,v;if(y=n.length>>>0,f=Math.max(0,Math.min(e,y)),a=[],s=y-f+1,h=[],f)for(p=function(n){h.push(n),--s||(l=p=S,u(h))},l=function(n){a.push(n),--f||(l=p=S,r(a))},v=0;y>v;++v)v in n&&t(n[v],c,o,i);else r(a)}return o(c).then(r,u,i)})}function w(n,t,e,r){function u(n){return t?t(n[0]):n[0]}return g(n,1,u,e,r)}function j(n,t,e,r){return k(n,S).then(t,e,r)}function b(){return k(arguments,S)}function _(n){return k(n,T,x)}function M(n,t){return k(n,t)}function k(n,e,r){return t(n,function(n){function u(u,i,o){function c(n,c){t(n,e,r).then(function(n){f[c]=n,o(n),--a||u(f)},i)}var f,s,a,h;if(a=s=n.length>>>0,f=[],!a)return u(f),void 0;for(h=0;s>h;h++)h in n?c(n[h],h):--a}return c(u)})}function P(n,e){var r=F(E,arguments,1);return t(n,function(n){var u;return u=n.length,r[0]=function(n,r,i){return t(n,function(n){return t(r,function(t){return e(n,t,i,u)})})},D.apply(n,r)})}function T(n){return{state:"fulfilled",value:n}}function x(n){return{state:"rejected",reason:n}}function C(){return{state:"pending"}}function I(n){1===L.push(n)&&G(O)}function O(){for(var n,t=0;n=L[t++];)n();L=[]}function S(n){return n}t.promise=o,t.resolve=r,t.reject=u,t.defer=i,t.join=b,t.all=j,t.map=M,t.reduce=P,t.settle=_,t.any=w,t.some=g,t.isPromise=d,t.isPromiseLike=d,e.prototype={then:function(){var n,t;return n=arguments,t=this._message,c(function(e,r,u){t("when",n,e,u)},this._status&&this._status.observed())},otherwise:function(n){return this.then(J,n)},ensure:function(n){function t(){return r(n())}return this.then(t,t).yield(this)},yield:function(n){return this.then(function(){return n})},tap:function(n){return this.then(n).yield(this)},spread:function(n){return this.then(function(t){return j(t,function(t){return n.apply(J,t)})})},always:function(n,t){return this.then(n,n,t)}},p.prototype.when=function(n){return"function"==typeof n?n(this.value):this.value},y.prototype.when=function(n,t){return"function"==typeof t?t(this.reason):this.reason};var D,E,F,G,L,q,z,A,B,H,J;if(L=[],q=n.setTimeout,H="undefined"!=typeof console?console:t,"function"==typeof setImmediate)G=setImmediate.bind(n);else if("undefined"!=typeof MessageChannel){var K=new MessageChannel;K.port1.onmessage=O,G=function(){K.port2.postMessage(0)}}else G="object"==typeof process&&process.nextTick?process.nextTick:function(n){q(n,0)};return z=Function.prototype,A=z.call,F=z.bind?A.bind(A):function(n,t){return n.apply(t,E.call(arguments,2))},B=[],E=B.slice,D=B.reduce||function(n){var t,e,r,u,i;if(i=0,t=Object(this),u=t.length>>>0,e=arguments,e.length<=1)for(;;){if(i in t){r=t[i++];break}if(++i>=u)throw new TypeError}else r=e[1];for(;u>i;++i)i in t&&(r=n(r,t[i],i,t));return r},t}(this);DG.ajax=function(){function handleReadyState(e,t,r){return function(){return e._aborted?r(e.request):(e.request&&4===e.request[readyState]&&(e.request.onreadystatechange=noop,twoHundo.test(e.request.status)?t(e.request):r(e.request)),void 0)}}function setHeaders(e,t){var r,a=t.headers||{};a.Accept=a.Accept||defaultHeaders.accept[t.dataType]||defaultHeaders.accept["*"],t.crossDomain||a[requestedWith]||(a[requestedWith]=defaultHeaders.requestedWith),a[contentType]||(a[contentType]=t.contentType||defaultHeaders.contentType);for(r in a)a.hasOwnProperty(r)&&"setRequestHeader"in e&&e.setRequestHeader(r,a[r])}function setCredentials(e,t){"undefined"!=typeof t.withCredentials&&"undefined"!=typeof e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,r,a,n){var s=uniqid++,o=e.jsonpCallback||"callback",l=e.jsonpCallbackName||callbackPrefix,i=new RegExp("((^|\\?|&)"+o+")=([^&]+)"),u=n.match(i),c=doc.createElement("script"),p=0,d=-1!==navigator.userAgent.indexOf("MSIE 10.0");return u?"?"===u[3]?n=n.replace(i,"$1="+l):l=u[3]:n=urlappend(n,o+"="+l),win[l]=generalCallback,c.type="text/javascript",c.src=n,c.async=!0,"undefined"==typeof c.onreadystatechange||d||(c.event="onclick",c.htmlFor=c.id="_request_"+s),c.onerror=function(){c.onerror=c.onload=c.onreadystatechange=null,r({},"Request unknown error",{}),lastValue=void 0,head.removeChild(c),p=1},c.onload=c.onreadystatechange=function(){return c[readyState]&&"complete"!==c[readyState]&&"loaded"!==c[readyState]||p?!1:(c.onerror=c.onload=c.onreadystatechange=null,c.onclick&&c.onclick(),t(lastValue),lastValue=void 0,head.removeChild(c),p=1,void 0)},a(),head.appendChild(c),{abort:function(){c.onerror=c.onload=c.onreadystatechange=null,r({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(c),p=1}}}function getRequest(e,t,r){var a,n=this.options,s=(n.type||"GET").toUpperCase(),o="string"==typeof n?n:n.url,l=n.processData!==!1&&n.data&&"string"!=typeof n.data?Ajax.toQueryString(n.data):n.data||null,i=!1;return"jsonp"!==n.type&&"GET"!==s||!l||(o=urlappend(o,l),l=null),"jsonp"===n.type?handleJsonp(n,e,t,r,o):(a=xhr(n),a.open(s,o,n.async===!1?!1:!0),setHeaders(a,n),setCredentials(a,n),win[xDomainRequest]&&a instanceof win[xDomainRequest]?(a.onload=e,a.onerror=t,a.onprogress=function(){},i=!0):a.onreadystatechange=handleReadyState(this,e,t),r&&r(a),i?setTimeout(function(){a.send(l)},200):a.send(l),a)}function buildParams(e,t,r,a){var n,s,o,l=/\[\]$/;if(DG.Util.isArray(t))for(s=0;t&&s<t.length;s++)o=t[s],r||l.test(e)?a(e,o):buildParams(e+"["+("object"==typeof o?s:"")+"]",o,r,a);else if(t&&"[object Object]"===t.toString())for(n in t)t.hasOwnProperty(n)&&buildParams(e+"["+n+"]",t[n],r,a);else a(e,t)}function setType(e){var t=e.match(/\.(json|jsonp|html|xml)(\?|$)/);return t?t[1]:"js"}function isCrossDomain(e){var t=rurl.exec(e.toLowerCase());return!(!t||t[1]===ajaxLocParts[1]&&t[2]===ajaxLocParts[2]&&(t[3]||("http:"===t[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))}function doRequest(o){function complete(e){o.timeout&&clearTimeout(self.timeout),self.timeout=null,self._erred?self.reject(e):self.resolve(e)}function success(resp){resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval("("+r+")");break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}self._responseArgs.resp=resp,complete(resp)}function error(e,t,r){e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=r,self._erred=!0,complete(e)}function progress(){self.notify.call(self,arguments)}"crossDomain"in o||(o.crossDomain=isCrossDomain(o.url));var self=DG.when.defer();self.abort=function(){self._aborted=!0,self.reject("aborted")},self.url=o.url,self.timeout=null,self.options=o,self._aborted=!1,self._erred=!1,self._responseArgs={};var type="jsonp"===o.type?o.type:o.dataType||setType(self.url);return o.timeout&&(self.timeout=setTimeout(function(){self.abort()},o.timeout)),self.request=getRequest.call(self,success,error,progress),self}function Ajax(e,t){"[object Object]"===Object.prototype.toString.call(e)&&(t=e,e=void 0),t=t||{},t.url=e||t.url;var r=doRequest(t),a=r.promise;return(t.success||t.error||t.progress||t.complete)&&a.then(t.success,t.error,t.progress).ensure(t.complete),a.abort=r.abort,a}var win=window,doc=document,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,twoHundo=/^20\d$/,ajaxLocParts,ajaxLocation,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="l_dg_ajax_callback_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossDomain===!0){var t=win[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],Ajax.setup=function(e){e=e||{};for(var t in e)e.hasOwnProperty(t)&&(globalSetupOptions[t]=e[t])},Ajax.toQueryString=function(e,t){var r,a,n=t||!1,s=[],o=encodeURIComponent,l=function(e,t){t="function"==typeof t?t():t?t:"",s[s.length]=o(e)+"="+o(t)};if(DG.Util.isArray(e))for(a=0;e&&a<e.length;a++)l(e[a].name,e[a].value);else for(r in e)e.hasOwnProperty(r)&&buildParams(r,e[r],n,l);return s.join("&").replace(/%20/g,"+")};var testxhr=win[xmlHttpRequest]?new XMLHttpRequest:null;return Ajax.corsSupport=!!(testxhr&&"withCredentials"in testxhr||win[xDomainRequest]),Ajax}();!function(root){function Context(t,e,n,r){this.stack=t,this.global=e,this.blocks=n,this.templateName=r}function Stack(t,e,n,r){this.tail=e,this.isObject=t&&"object"==typeof t,this.head=t,this.index=n,this.of=r}function Stub(t){this.head=new Chunk(this),this.callback=t,this.out=""}function Stream(){this.head=new Chunk(this)}function Chunk(t,e,n){this.root=t,this.next=e,this.data=[],this.flushable=!1,this.taps=n}function Tap(t,e){this.head=t,this.tail=e}var dust={},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",loggingLevels=[DEBUG,INFO,WARN,ERROR,NONE],EMPTY_FUNC=function(){},logger=EMPTY_FUNC,loggerContext=this;dust.debugLevel=NONE,dust.silenceErrors=!1,root&&root.console&&root.console.log&&(logger=root.console.log,loggerContext=root.console),dust.log=function(t,e){if(dust.isDebug&&dust.debugLevel===NONE&&(logger.call(loggerContext,'[!!!DEPRECATION WARNING!!!]: dust.isDebug is deprecated.  Set dust.debugLevel instead to the level of logging you want ["debug","info","warn","error","none"]'),dust.debugLevel=INFO),e=e||INFO,loggingLevels.indexOf(e)>=loggingLevels.indexOf(dust.debugLevel)&&(dust.logQueue||(dust.logQueue=[]),dust.logQueue.push({message:t,type:e}),logger.call(loggerContext,"[DUST "+e+"]: "+t)),!dust.silenceErrors&&e===ERROR)throw"string"==typeof t?new Error(t):t},dust.onError=function(t,e){if(logger.call(loggerContext,"[!!!DEPRECATION WARNING!!!]: dust.onError will no longer return a chunk object."),dust.log(t.message||t,ERROR),dust.silenceErrors)return e;throw t},dust.helpers={},dust.cache={},dust.register=function(t,e){t&&(dust.cache[t]=e)},dust.render=function(t,e,n){var r=new Stub(n).head;try{dust.load(t,r,Context.wrap(e,t)).end()}catch(o){dust.log(o,ERROR)}},dust.stream=function(t,e){var n=new Stream;return dust.nextTick(function(){try{dust.load(t,n.head,Context.wrap(e,t)).end()}catch(r){dust.log(r,ERROR)}}),n},dust.renderSource=function(t,e,n){return dust.compileFn(t)(e,n)},dust.compileFn=function(t,e){e=e||null;var n=dust.loadSource(dust.compile(t,e));return function(t,r){var o=r?new Stub(r):new Stream;return dust.nextTick(function(){"function"==typeof n?n(o.head,Context.wrap(t,e)).end():dust.log(new Error("Template ["+e+"] cannot be resolved to a Dust function"),ERROR)}),o}},dust.load=function(t,e,n){var r=dust.cache[t];return r?r(e,n):dust.onLoad?e.map(function(e){dust.onLoad(t,function(r,o){return r?e.setError(r):(dust.cache[t]||dust.loadSource(dust.compile(o,t)),dust.cache[t](e,n).end(),void 0)})}):e.setError(new Error("Template Not Found: "+t))},dust.loadSource=function(source,path){return eval(source)},dust.isArray=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},dust.nextTick=function(){return function(t){setTimeout(t,0)}}(),dust.isEmpty=function(t){return dust.isArray(t)&&!t.length?!0:0===t?!1:!t},dust.filter=function(t,e,n){if(n)for(var r=0,o=n.length;o>r;r++){var s=n[r];"s"===s?(e=null,dust.log("Using unescape filter on ["+t+"]",DEBUG)):"function"==typeof dust.filters[s]?t=dust.filters[s](t):dust.log(new Error("Invalid filter ["+s+"]"),ERROR)}return e&&(t=dust.filters[e](t)),t},dust.filters={h:function(t){return dust.escapeHtml(t)},j:function(t){return dust.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(t){return JSON?JSON.stringify(t):(dust.log("JSON is undefined.  JSON stringify has not been used on ["+t+"]",WARN),t)},jp:function(t){return JSON?JSON.parse(t):(dust.log("JSON is undefined.  JSON parse has not been used on ["+t+"]",WARN),t)}},dust.makeBase=function(t){return new Context(new Stack,t)},Context.wrap=function(t,e){return t instanceof Context?t:new Context(new Stack(t),{},null,e)},Context.prototype.get=function(t,e){return"string"==typeof t&&("."===t[0]&&(e=!0,t=t.substr(1)),t=t.split(".")),this._get(e,t)},Context.prototype._get=function(t,e){var n,r,o,s,i=this.stack,u=1;if(dust.log("Searching for reference [{"+e.join(".")+"}] in template ["+this.getTemplateName()+"]",DEBUG),r=e[0],o=e.length,t&&0===o)s=i,i=i.head;else{if(t)i=i.head[r];else{for(;i&&(!i.isObject||(s=i.head,n=i.head[r],void 0===n));)i=i.tail;i=void 0!==n?n:this.global?this.global[r]:void 0}for(;i&&o>u;)s=i,i=i[e[u]],u++}if("function"==typeof i){var a=function(){try{return i.apply(s,arguments)}catch(t){return dust.log(t,ERROR)}};return a.isFunction=!0,a}return void 0===i&&dust.log("Cannot find the value for reference [{"+e.join(".")+"}] in template ["+this.getTemplateName()+"]"),i},Context.prototype.getPath=function(t,e){return this._get(t,e)},Context.prototype.push=function(t,e,n){return new Context(new Stack(t,this.stack,e,n),this.global,this.blocks,this.getTemplateName())},Context.prototype.rebase=function(t){return new Context(new Stack(t),this.global,this.blocks,this.getTemplateName())},Context.prototype.current=function(){return this.stack.head},Context.prototype.getBlock=function(t){if("function"==typeof t){var e=new Chunk;t=t(e,this).data.join("")}var n=this.blocks;if(!n)return dust.log("No blocks for context[{"+t+"}] in template ["+this.getTemplateName()+"]",DEBUG),void 0;for(var r,o=n.length;o--;)if(r=n[o][t])return r},Context.prototype.shiftBlocks=function(t){var e,n=this.blocks;return t?(e=n?n.concat([t]):[t],new Context(this.stack,this.global,e,this.getTemplateName())):this},Context.prototype.getTemplateName=function(){return this.templateName},Stub.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.callback(t.error),dust.log(new Error("Chunk error ["+t.error+"] thrown. Ceasing to render this template."),ERROR),this.flush=EMPTY_FUNC,void 0):void 0;this.out+=t.data.join(""),t=t.next,this.head=t}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.emit("error",t.error),dust.log(new Error("Chunk error ["+t.error+"] thrown. Ceasing to render this template."),ERROR),this.flush=EMPTY_FUNC,void 0):void 0;this.emit("data",t.data.join("")),t=t.next,this.head=t}this.emit("end")},Stream.prototype.emit=function(t,e){if(!this.events)return dust.log("No events to emit",INFO),!1;var n=this.events[t];if(!n)return dust.log("Event type ["+t+"] does not exist",WARN),!1;if("function"==typeof n)n(e);else if(dust.isArray(n))for(var r=n.slice(0),o=0,s=r.length;s>o;o++)r[o](e);else dust.log(new Error("Event Handler ["+n+"] is not of a type that is handled by emit"),ERROR)},Stream.prototype.on=function(t,e){return this.events||(this.events={}),this.events[t]?"function"==typeof this.events[t]?this.events[t]=[this.events[t],e]:this.events[t].push(e):(dust.log("Event type ["+t+"] does not exist. Using just the specified callback.",WARN),e?this.events[t]=e:dust.log("Callback for type ["+t+"] does not exist. Listener not registered.",WARN)),this},Stream.prototype.pipe=function(t){return this.on("data",function(e){try{t.write(e,"utf8")}catch(n){dust.log(n,ERROR)}}).on("end",function(){try{return t.end()}catch(e){dust.log(e,ERROR)}}).on("error",function(e){t.error(e)}),this},Chunk.prototype.write=function(t){var e=this.taps;return e&&(t=e.go(t)),this.data.push(t),this},Chunk.prototype.end=function(t){return t&&this.write(t),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(t){var e=new Chunk(this.root,this.next,this.taps),n=new Chunk(this.root,e,this.taps);return this.next=n,this.flushable=!0,t(n),e},Chunk.prototype.tap=function(t){var e=this.taps;return this.taps=e?e.push(t):new Tap(t),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(t,e){return t(this,e)},Chunk.prototype.reference=function(t,e,n,r){return"function"==typeof t&&(t.isFunction=!0,t=t.apply(e.current(),[this,e,null,{auto:n,filters:r}]),t instanceof Chunk)?t:dust.isEmpty(t)?this:this.write(dust.filter(t,n,r))},Chunk.prototype.section=function(t,e,n,r){if("function"==typeof t&&(t=t.apply(e.current(),[this,e,n,r]),t instanceof Chunk))return t;var o=n.block,s=n["else"];if(r&&(e=e.push(r)),dust.isArray(t)){if(o){var i=t.length,u=this;if(i>0){e.stack.head&&(e.stack.head.$len=i);for(var a=0;i>a;a++)e.stack.head&&(e.stack.head.$idx=a),u=o(u,e.push(t[a],a,i));return e.stack.head&&(e.stack.head.$idx=void 0,e.stack.head.$len=void 0),u}if(s)return s(this,e)}}else if(t===!0){if(o)return o(this,e)}else if(t||0===t){if(o)return o(this,e.push(t))}else if(s)return s(this,e);return dust.log("Not rendering section (#) block in template ["+e.getTemplateName()+"], because above key was not found",DEBUG),this},Chunk.prototype.exists=function(t,e,n){var r=n.block,o=n["else"];if(dust.isEmpty(t)){if(o)return o(this,e)}else if(r)return r(this,e);return dust.log("Not rendering exists (?) block in template ["+e.getTemplateName()+"], because above key was not found",DEBUG),this},Chunk.prototype.notexists=function(t,e,n){var r=n.block,o=n["else"];if(dust.isEmpty(t)){if(r)return r(this,e)}else if(o)return o(this,e);return dust.log("Not rendering not exists (^) block check in template ["+e.getTemplateName()+"], because above key was found",DEBUG),this},Chunk.prototype.block=function(t,e,n){var r=n.block;return t&&(r=t),r?r(this,e):this},Chunk.prototype.partial=function(t,e,n){var r;r=dust.makeBase(e.global),r.blocks=e.blocks,e.stack&&e.stack.tail&&(r.stack=e.stack.tail),n&&(r=r.push(n)),"string"==typeof t&&(r.templateName=t),r=r.push(e.stack.head);var o;return o="function"==typeof t?this.capture(t,r,function(t,e){r.templateName=r.templateName||t,dust.load(t,e,r).end()}):dust.load(t,this,r)},Chunk.prototype.helper=function(t,e,n,r){var o=this;try{return dust.helpers[t]?dust.helpers[t](o,e,n,r):(dust.log(new Error("Invalid helper ["+t+"]"),ERROR),o)}catch(s){return dust.log(s,ERROR),o}},Chunk.prototype.capture=function(t,e,n){return this.map(function(r){var o=new Stub(function(t,e){t?r.setError(t):n(e,r)});t(o.head,e).end()})},Chunk.prototype.setError=function(t){return this.error=t,this.root.flush(),this},Tap.prototype.push=function(t){return new Tap(t,this)},Tap.prototype.go=function(t){for(var e=this;e;)t=e.head(t),e=e.tail;return t};var HCHARS=new RegExp(/[&<>\"\']/),AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(t){return"string"==typeof t?HCHARS.test(t)?t.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):t:t};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;dust.escapeJs=function(t){return"string"==typeof t?t.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):t},"object"==typeof exports?module.exports=dust:root.dust=dust}(this);!function(dust){function isSelect(e){var t=e.current();return"object"==typeof t&&t.isSelect===!0}function jsonFilter(e,t){return"function"==typeof t?t.toString().replace(/(^\s+|\s+$)/gm,"").replace(/\n/gm,"").replace(/,\s*/gm,", ").replace(/\)\{/gm,") {"):t}function filter(e,t,r,n,o){n=n||{};var s,l,i=r.block,c=n.filterOpType||"";if("undefined"!=typeof n.key)s=dust.helpers.tap(n.key,e,t);else{if(!isSelect(t))return _console.log("No key specified for filter in:"+c+" helper "),e;s=t.current().selectKey,t.current().isResolved&&(o=function(){return!1})}return l=dust.helpers.tap(n.value,e,t),o(coerce(l,n.type,t),coerce(s,n.type,t))?(isSelect(t)&&(t.current().isResolved=!0),i?e.render(i,t):(_console.log("Missing body block in the "+c+" helper "),e)):r["else"]?e.render(r["else"],t):e}function coerce(e,t,r){if(e)switch(t||typeof e){case"number":return+e;case"string":return String(e);case"boolean":return e="false"===e?!1:e,Boolean(e);case"date":return new Date(e);case"context":return r.get(e)}return e}var _console="undefined"!=typeof console?console:{log:function(){}},helpers={tap:function(e,t,r){var n=e;return"function"==typeof e&&(e.isFunction===!0?n=e():(n="",t.tap(function(e){return n+=e,""}).render(e,r).untap(),""===n&&(n=!1))),n},sep:function(e,t,r){var n=r.block;return t.stack.index===t.stack.of-1?e:n?r.block(e,t):e},idx:function(e,t,r){var n=r.block;return n?r.block(e,t.push(t.stack.index)):e},contextDump:function(e,t,r,n){var o,s=n||{},l=s.to||"output",i=s.key||"current";return l=dust.helpers.tap(l,e,t),i=dust.helpers.tap(i,e,t),o="full"===i?JSON.stringify(t.stack,jsonFilter,2):JSON.stringify(t.stack.head,jsonFilter,2),"console"===l?(_console.log(o),e):e.write(o)},"if":function(chunk,context,bodies,params){var body=bodies.block,skip=bodies["else"];if(params&&params.cond){var cond=params.cond;if(cond=dust.helpers.tap(cond,chunk,context),eval(cond))return body?chunk.render(bodies.block,context):(_console.log("Missing body block in the if helper!"),chunk);if(skip)return chunk.render(bodies["else"],context)}else _console.log("No condition given in the if helper!");return chunk},math:function(e,t,r,n){if(n&&"undefined"!=typeof n.key&&n.method){var o=n.key,s=n.method,l=n.operand,i=n.round,c=null;switch(o=dust.helpers.tap(o,e,t),l=dust.helpers.tap(l,e,t),s){case"mod":(0===l||l===-0)&&_console.log("operand for divide operation is 0/-0: expect Nan!"),c=parseFloat(o)%parseFloat(l);break;case"add":c=parseFloat(o)+parseFloat(l);break;case"subtract":c=parseFloat(o)-parseFloat(l);break;case"multiply":c=parseFloat(o)*parseFloat(l);break;case"divide":(0===l||l===-0)&&_console.log("operand for divide operation is 0/-0: expect Nan/Infinity!"),c=parseFloat(o)/parseFloat(l);break;case"ceil":c=Math.ceil(parseFloat(o));break;case"floor":c=Math.floor(parseFloat(o));break;case"round":c=Math.round(parseFloat(o));break;case"abs":c=Math.abs(parseFloat(o));break;default:_console.log("method passed is not supported")}return null!==c?(i&&(c=Math.round(c)),r&&r.block?e.render(r.block,t.push({isSelect:!0,isResolved:!1,selectKey:c})):e.write(c)):e}return _console.log("Key is a required parameter for math helper along with method/operand!"),e},select:function(e,t,r,n){var o=r.block;if(n&&"undefined"!=typeof n.key){var s=dust.helpers.tap(n.key,e,t);return o?e.render(r.block,t.push({isSelect:!0,isResolved:!1,selectKey:s})):(_console.log("Missing body block in the select helper "),e)}return _console.log("No key given in the select helper!"),e},eq:function(e,t,r,n){return n&&(n.filterOpType="eq"),filter(e,t,r,n,function(e,t){return t===e})},ne:function(e,t,r,n){return n?(n.filterOpType="ne",filter(e,t,r,n,function(e,t){return t!==e})):e},lt:function(e,t,r,n){return n?(n.filterOpType="lt",filter(e,t,r,n,function(e,t){return e>t})):void 0},lte:function(e,t,r,n){return n?(n.filterOpType="lte",filter(e,t,r,n,function(e,t){return e>=t})):e},gt:function(e,t,r,n){return n?(n.filterOpType="gt",filter(e,t,r,n,function(e,t){return t>e})):e},gte:function(e,t,r,n){return n?(n.filterOpType="gte",filter(e,t,r,n,function(e,t){return t>=e})):e},"default":function(e,t,r,n){return n&&(n.filterOpType="default"),filter(e,t,r,n,function(){return!0})},size:function(e,t,r,n){var o,s,l,i=0;if(n=n||{},o=n.key,o&&o!==!0)if(dust.isArray(o))i=o.length;else if(!isNaN(parseFloat(o))&&isFinite(o))i=o;else if("object"==typeof o){s=0;for(l in o)Object.hasOwnProperty.call(o,l)&&s++;i=s}else i=(o+"").length;else i=0;return e.write(i)}};dust.helpers=helpers}("undefined"!=typeof exports?module.exports=require("dustjs-linkedin"):dust);DG.dust=function(u){return function(n,t){dust.cache[n]||dust.loadSource(u[n]);var r;return dust.render(n,t,function(u,n){r=n}),r}};DG.Dictionary={},DG.Dictionary.ru={pluralRules:function(n){return n%10===1&&n%100!==11?0:n%10>=2&&4>=n%10&&n%10%1===0&&(12>n%100||n%100>14)?1:n%10===0||n%10>=5&&9>=n%10&&n%10%1===0||n%100>=11&&14>=n%100&&n%100%1===0?2:void 0}},DG.Dictionary.en={pluralRules:function(n){return 1===n?0:1}},DG.Dictionary.it={pluralRules:function(n){return 1===n?0:1}},DG.Dictionary.cs={pluralRules:function(n){return 1===n?0:n>=2&&4>=n?1:2}};function getPageLang(){var t=document.documentElement,n=t.lang||t.getAttributeNS&&t.getAttributeNS("http://www.w3.org/XML/1998/namespace","lang")||"ru";return n}DG.Locale={t:function(t,n){var e,r,a,i=this._map.options.currentLang,o=!1;return"undefined"==typeof this.constructor.Dictionary[i]&&(i="ru",this._map.setLang(i)),r=this.constructor.Dictionary[i][t],(o="undefined"!=typeof r)?(e=o?r:t,void 0!==n&&(n=parseInt(n,10),n=isNaN(n)?0:n,a=this.constructor.Dictionary[i].pluralRules(n),e=r[a]),e=DG.Util.template(e,{n:n}),e?e:t):t}},DG.Map.mergeOptions({currentLang:getPageLang()}),DG.Map.include({setLang:function(t){t&&"[object String]"===Object.prototype.toString.call(t)&&(this.options.currentLang=t,this.fire("langchange",{lang:t}))},getLang:function(){return this.options.currentLang}});DG.Control.Attribution.include(DG.Locale),DG.Control.Attribution.Dictionary={},DG.Control.Attribution.include({options:{position:"bottomright"},onAdd:function(t){return t._copyright||(t._copyright=!0,this._first=!0),this._onAdd.call(this,t)},_update:function(t){if(this._map){var i=[];for(var r in this._attributions)this._attributions[r]&&i.push(r);var e=[],n="";this._first&&(n=this._getAttributionHTML(t)),this.options.prefix&&e.push(this.options.prefix),i.length&&e.push(i.join(", ")),this._container.innerHTML=n+e.join(" | ")}},_tmpl:DG.dust(JSON.parse('{"copyright":"(function(){dust.register(\\"copyright\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-attribution__copyright\\\\\\"><ul class=\\\\\\"dg-attribution__links\\\\\\"><li><a href=\\\\\\"\\").reference(ctx.get([\\"copyright_apilink\\"], false),ctx,\\"h\\").write(\\"\\\\\\" target=\\\\\\"_blank\\\\\\" class=\\\\\\"dg-attribution__link\\\\\\">\\").reference(ctx.get([\\"API_2GIS\\"], false),ctx,\\"h\\").write(\\"</a></li><li><a href=\\\\\\"\\").reference(ctx.get([\\"copyright_license\\"], false),ctx,\\"h\\").write(\\"\\\\\\" target=\\\\\\"_blank\\\\\\" class=\\\\\\"dg-attribution__link\\\\\\">\\").reference(ctx.get([\\"license_agreement\\"], false),ctx,\\"h\\").write(\\"</a></li></ul><a href=\\\\\\"\\").reference(ctx.get([\\"copyright_logo\\"], false),ctx,\\"h\\").write(\\"\\\\\\" target=\\\\\\"_blank\\\\\\" class=\\\\\\"dg-attribution__logo_url\\\\\\"></a></div>\\");}return body_0;})();"}')),_onAdd:DG.Control.Attribution.prototype.onAdd,_getData:function(t){return{lang:t||this._map.getLang(),copyright_apilink:this.t("copyright_apilink"),copyright_license:this.t("copyright_license"),license_agreement:this.t("license_agreement"),copyright_logo:this.t("copyright_logo"),API_2GIS:this.t("API_2GIS"),TWOGIS:this.t("TWO_GIS"),PTC:this.t("PTC")}},_getAttributionHTML:function(t){return this._tmpl("copyright",this._getData(t))},_renderTranslation:function(t){this._update(t.lang)}}),DG.Map.addInitHook(function(){this._copyright||DG.control.attribution().addTo(this)});DG.Control.Attribution.Dictionary.ru={copyright_logo:"http://info.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://api.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://help.2gis.ru/licensing-agreement/",license_agreement:"Лицензионное соглашение",API_2GIS:"Работает на API 2ГИС",TWO_GIS:"ДубльГИС",PTC:"ООО"};DG.Control.Attribution.Dictionary.it={copyright_logo:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://2gis.it/",license_agreement:"Accordo di licenza",API_2GIS:"2GIS API",TWO_GIS:"Double GIS LLC",PTC:"Srl"};DG.Control.Attribution.Dictionary.cs={copyright_logo:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.cz/licensing-agreement/",license_agreement:"Licenční smlouva",API_2GIS:"Pracuje na API 2GIS",TWO_GIS:"DublGIS",PTC:"s.r.o."};DG.Control.Attribution.Dictionary.en={copyright_logo:"http://limassol.2gis.com.cy/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://limassol.2gis.com.cy/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://limassol.2gis.com.cy/",license_agreement:"License agreement",API_2GIS:"Uses 2GIS API",TWO_GIS:"Double GIS",PTC:"LLC"};"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,o,f,u,i=gap,p=e[t];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(t)),"function"==typeof rep&&(p=rep.call(e,t,p)),typeof p){case"string":return quote(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(gap+=indent,u=[],"[object Array]"===Object.prototype.toString.apply(p)){for(f=p.length,n=0;f>n;n+=1)u[n]=str(n,p)||"null";return o=0===u.length?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+i+"]":"["+u.join(",")+"]",gap=i,o}if(rep&&"object"==typeof rep)for(f=rep.length,n=0;f>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],o=str(r,p),o&&u.push(quote(r)+(gap?": ":":")+o));else for(r in p)Object.prototype.hasOwnProperty.call(p,r)&&(o=str(r,p),o&&u.push(quote(r)+(gap?": ":":")+o));return o=0===u.length?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+i+"}":"{"+u.join(",")+"}",gap=i,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,r,o=t[e];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r=walk(o,n),void 0!==r?o[n]=r:delete o[n]);return reviver.call(t,e,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();!function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=E.elements;return"string"==typeof e?e.split(" "):e}function a(e){var t=v[e[g]];return t||(t={},p++,e[g]=p,v[p]=t),t}function c(e,n,r){if(n||(n=t),u)return n.createElement(e);r||(r=a(n));var c;return c=r.cache[e]?r.cache[e].cloneNode():f.test(e)?(r.cache[e]=r.createElem(e)).cloneNode():r.createElem(e),!c.canHaveChildren||h.test(e)||c.tagUrn?c:r.frag.appendChild(c)}function o(e,n){if(e||(e=t),u)return e.createDocumentFragment();n=n||a(e);for(var c=n.frag.cloneNode(),o=0,i=r(),l=i.length;l>o;o++)c.createElement(i[o]);return c}function i(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return E.shivMethods?c(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(E,t.frag)}function l(e){e||(e=t);var r=a(e);return!E.shivCSS||m||r.hasCSS||(r.hasCSS=!!n(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||i(e,r),e}var m,u,s="3.7.0",d=e.html5||{},h=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g="_html5shiv",p=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",m="hidden"in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){m=!0,u=!0}}();var E={elements:d.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:s,shivCSS:d.shivCSS!==!1,supportsUnknownElements:u,shivMethods:d.shivMethods!==!1,type:"default",shivDocument:l,createElement:c,createDocumentFragment:o};e.html5=E,l(t)}(this,document);Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var r=Object(this),o=r.length>>>0;if("function"!=typeof t)throw new TypeError;for(var e=new Array(o),n=arguments.length>=2?arguments[1]:void 0,i=0;o>i;i++)i in r&&(e[i]=t.call(n,r[i],i,r));return e}),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,r){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var o,e,n=this.length>>>0,i=!1;for(1<arguments.length&&(e=r,i=!0),o=0;n>o;++o)this.hasOwnProperty(o)&&(i?e=t(e,this[o],o,this):(e=this[o],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return e}),Array.prototype.forEach||(Array.prototype.forEach=function(t,r){"use strict";var o,e;if(null==this)throw new TypeError("this is null or not defined");var n,i=Object(this),p=i.length>>>0;if("[object Function]"!=={}.toString.call(t))throw new TypeError(t+" is not a function");for(arguments.length>=2&&(o=r),e=0;p>e;)e in i&&(n=i[e],t.call(o,n,e,i)),e++}),Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],e=o.length;return function(n){if("object"!=typeof n&&("function"!=typeof n||null===n))throw new TypeError("Object.keys called on non-object");var i,p,a=[];for(i in n)t.call(n,i)&&a.push(i);if(r)for(p=0;e>p;p++)t.call(n,o[p])&&a.push(o[p]);return a}}()),Array.prototype.some||(Array.prototype.some=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var r=Object(this),o=r.length>>>0;if("function"!=typeof t)throw new TypeError;for(var e=arguments.length>=2?arguments[1]:void 0,n=0;o>n;n++)if(n in r&&t.call(e,r[n],n,r))return!0;return!1}),Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var r=Object(this),o=r.length>>>0;if("function"!=typeof t)throw new TypeError;for(var e=new Array(o),n=arguments.length>=2?arguments[1]:void 0,i=0;o>i;i++)i in r&&(e[i]=t.call(n,r[i],i,r));return e}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var r=Object(this),o=r.length>>>0;if("function"!=typeof t)throw new TypeError;for(var e=[],n=arguments.length>=2?arguments[1]:void 0,i=0;o>i;i++)if(i in r){var p=r[i];t.call(n,p,i,r)&&e.push(p)}return e}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),o=this,e=function(){},n=function(){return o.apply(this instanceof e&&t?this:t,r.concat(Array.prototype.slice.call(arguments)))};return e.prototype=this.prototype,n.prototype=new e,n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,r){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var o=this.length>>>0;for(r=+r||0,1/0===Math.abs(r)&&(r=0),0>r&&(r+=o,0>r&&(r=0));o>r;r++)if(this[r]===t)return r;return-1});DG.version=window.__dgApi_version,window.__dgApi_version=void 0,DG.Icon.Default.imagePath="../img/vendors/leaflet",function(e,n,i,t,a,s,o){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,s=n.createElement(i),o=n.getElementsByTagName(i)[0],s.async=1,s.src=t,o.parentNode.insertBefore(s,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-38243181-2","none"),ga("send","pageview");var newImg=new Image;newImg.src="http://maps.api.2gis.ru/analytics/track-user.png?sr="+window.screen.width+"x"+window.screen.height+"&v="+DG.version,DG.Map.include({addHandler:function(e,n){if(n){var i=this.options[e],t=i===Object(i)?i:null,a=this[e]=new n(this,t);return this._handlers.push(a),i&&a.enable(),this}}});DG.plugin=function(e){function t(){c--,0===c&&s.resolve()}function n(e){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),n.onload=function(){t()},n.onerror=function(){t()},n.onreadystatechange=function(){("complete"===n.readyState||"loaded"===n.readyState)&&t()},document.getElementsByTagName("head")[0].appendChild(n)}function r(e){var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(n),t()}function i(e){return u.test(e)}function a(e){return d.test(e)}function o(e){i(e)?n(e):a(e)?r(e):c--}var c,s=DG.when.defer(),u=new RegExp(/.js$/i),d=new RegExp(/.css$/i);return DG.Util.isArray(e)&&(c=e.length,e.forEach(function(e){o(e)})),"string"==typeof e&&(c=1,o(e)),s.promise};var handlers=window.__dgApi_callbacks||[],def=DG.when.defer(),chain=def.promise;window.__dgApi_callbacks=void 0,handlers.forEach(function(n){chain=chain.then(n)}),def.resolve(),DG.then=function(n,e){return chain=chain.then(n,e),this};DG.Label=DG.Layer.extend({options:{offset:new DG.Point(12,15),className:"dg-label",zIndexOffset:0},_typeOfString:Object.prototype.toString.call("s"),_defaultZIndex:100,initialize:function(t,i){DG.Util.setOptions(this,i),this._animated=DG.Browser.any3d,this._content=t},onAdd:function(t){this._map=t,this._el||this._initDOM(),this._visible=!0,this.setContent(this._content)._onViewReset(),t.on("viewreset",this._onViewReset,this).on("zoomanim",this._onZoomAnimation,this)},onRemove:function(t){t.off("viewreset",this._onViewReset,this).off("zoomanim",this._onZoomAnimation,this),this._visible=!1,this._el.removeChild(this._container),DG.Util.falseFn(this._container.offsetWidth),this._container=null,t.getPanes().markerPane.removeChild(this._el),this._el=null},_initDOM:function(){this._el=DG.DomUtil.create("div",this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),this._map.getPanes().markerPane),this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset,this._container=DG.DomUtil.create("div",this.options.className+"__content",this._el),DG.DomUtil.disableTextSelection(this._container),DG.DomEvent.disableClickPropagation(this._el).on(this._container,"mousewheel",DG.DomEvent.stopPropagation).on(this._container,"contextmenu",DG.DomEvent.stopPropagation)},_onViewReset:function(){this._visible&&this._latlng&&DG.DomUtil.setPosition(this._el,this._map.latLngToLayerPoint(this._latlng).add(this.options.offset),DG.Browser.ie)},_onZoomAnimation:function(t){this._latlng&&DG.DomUtil.setPosition(this._el,this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).add(this.options.offset))},setOffset:function(t){return t instanceof DG.Point&&(this.options.offset=t,this._onViewReset()),this},setZIndexOffset:function(t){return isNaN(+t)||(this.options.zIndexOffset=+t,this._visible&&(this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset)),this},setContent:function(t){return Object.prototype.toString.call(t)!==this._typeOfString?this:(this._content=t,this._visible&&(this._container.innerHTML=t),this)},setPosition:function(t){return t instanceof DG.LatLng?(this._latlng=t,this._onViewReset(),this):this}}),DG.label=function(t,i){return new DG.Label(t,i)};DG.Marker.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),e&&(this.options.offset!==e.offset&&this._label.setOffset(this.options.offset=e.offset),this.options.static!==e.static&&this.unbindLabel().bindLabel(t,e))):(e=DG.extend({offset:new DG.Point(5,5)},e),this._label=DG.label(t,e),this.once("remove",this.unbindLabel),e.static?this.showLabel():this.once("mouseover",this._mouseOverLabel),"undefined"!=typeof this._map?this._updateLabelZIndex():this.once("add",this._updateLabelZIndex)),this},unbindLabel:function(){return this._label&&(this.hideLabel().off("remove",this.unbindLabel).off("mouseover",this._mouseOverLabel).off("mouseout",this._mouseOutLabel).off("dragstart",this._dragStartLabel).off("dragend",this._dragEndLabel).off("move",this._updatePosition).off("add",this._updateLabelZIndex),this._label=null),this},getLabel:function(){return this._label?this._label:null},_originalUpdateZIndex:DG.Marker.prototype._updateZIndex,_updateZIndex:function(t){return this._originalUpdateZIndex(t),this._updateLabelZIndex(),this},_updateLabelZIndex:function(){return this._label&&this._icon&&this._label.setZIndexOffset(this._icon.style.zIndex),this},showLabel:function(){return this._label&&this.on("move",this._updatePosition)._map.addLayer(this._label.setPosition(this.getLatLng())),this},hideLabel:function(){return this._label&&this.off("move",this._updatePosition)._map.removeLayer(this._label),this},_updatePosition:function(){this._label.setPosition(this.getLatLng())},_dragStartLabel:function(){this.off("mouseout",this._mouseOutLabel).off("dragstart",this._mouseOutLabel).once("dragend",this._dragEndLabel).hideLabel()},_dragEndLabel:function(){this.once("mouseover",this._mouseOverLabel)},_mouseOverLabel:function(){this.showLabel().on("dragstart",this._dragStartLabel).on("mouseout",this._mouseOutLabel)},_mouseOutLabel:function(){this.hideLabel().off("mouseout",this._mouseOutLabel).off("dragstart",this._dragStartLabel).once("mouseover",this._mouseOverLabel)}}),DG.Marker.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)});DG.Path.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),this._label.options.offset!==e.offset&&this._label.setOffset(e.offset)):(this._label=DG.label(t,e),this.on(this._labelEvents,this)),this},unbindLabel:function(){return this._label&&(this.off(this._labelEvents,this),this._map.removeLayer(this._label),this._label=null),this},getLabel:function(){return this._label?this._label:null},_labelEvents:{mouseover:function(t){this._map.addLayer(this._label.setPosition(t.latlng))},mousemove:function(t){this._label.setPosition(t.latlng)},mouseout:function(){this._map.removeLayer(this._label)},remove:function(){this._map.removeLayer(this._label)}}}),DG.Path.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)});DG.Wkt={},DG.Wkt.toGeoJSON=function(n){function t(t){var r=n.substring(y).match(t);return r?(y+=r[0].length,r[0]):null}function r(n){return n&&D.match(/\d+/)&&(n.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+D}}),n}function o(){t(/^\s*/)}function e(){o();for(var n,r=0,e=[],i=[e],u=e;n=t(/^(\()/)||t(/^(\))/)||t(/^(\,)/)||t(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/);){if("("===n)i.push(u),u=[],i[i.length-1].push(u),r++;else if(")"===n){if(u=i.pop(),r--,0===r)break}else","===n?(u=[],i[i.length-1].push(u)):u.push(parseFloat(n));o()}return i.length=0,0!==r?null:e}function i(){for(var n,r,e=[];r=t(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/)||t(/^(\,)/);)","===r?(e.push(n),n=[]):(n||(n=[]),n.push(parseFloat(r))),o();return n&&e.push(n),e.length?e:null}function u(){if(!t(/^(point)/i))return null;if(o(),!t(/^(\()/))return null;var n=i();return o(),t(/^(\))/)?{type:"Point",coordinates:n[0]}:null}function l(){if(!t(/^(multipoint)/i))return null;o();var n=e();return o(),{type:"MultiPoint",coordinates:n}}function s(){if(!t(/^(multilinestring)/i))return null;o();var n=e();return o(),{type:"MultiLineString",coordinates:n}}function a(){if(!t(/^(linestring)/i))return null;if(o(),!t(/^(\()/))return null;var n=i();return t(/^(\))/)?{type:"LineString",coordinates:n}:null}function c(){return t(/^(polygon)/i)?(o(),{type:"Polygon",coordinates:e()}):null}function f(){return t(/^(multipolygon)/i)?(o(),{type:"MultiPolygon",coordinates:e()}):null}function p(){var n,r=[];if(!t(/^(geometrycollection)/i))return null;if(o(),!t(/^(\()/))return null;for(;n=G();)r.push(n),o(),t(/^(\,)/),o();return t(/^(\))/)?{type:"GeometryCollection",geometries:r}:null}function G(){return u()||a()||c()||l()||s()||f()||p()}DG.Util.isArray(n)&&(n=n[0]);var g=n.split(";");n=g.pop();var y=0,D=(g.shift()||"").split("=").pop();return r(G())},DG.Wkt.geoJsonLayer=function(n,t){return DG.geoJson(DG.Wkt.toGeoJSON(n),t)},DG.Wkt.toLatLngs=function(n){var t=DG.Wkt.toGeoJSON(n).coordinates;return DG.Util.isArray(t)?t.map(function(n){return DG.Util.isArray(n[0])?DG.GeoJSON.coordsToLatLngs(n):[DG.GeoJSON.coordsToLatLng(n)]}).reduce(function(n,t){return n.concat(t)}):DG.GeoJSON.coordsToLatLngs(t)},DG.Wkt.toPoints=function(n){return DG.Wkt.toGeoJSON(n).coordinates},DG.Wkt.pointsToLatLngOnMap=function(n,t){return function r(n){return Array.isArray(n)&&Array.isArray(n[0])?n.map(r):t.containerPointToLatLng(n)}(DG.Wkt.toPoints(n))};DG.RoundControl=DG.Control.extend({includes:DG.Mixin.Events,options:{position:"topright",iconClass:"default"},onAdd:function(t){var s=this._controlCLass="dg-control-round",o=this._controlIconCLass=this._controlCLass+"_icon",i=DG.DomUtil.create("div","");return this._disable?i:(DG.DomUtil.addClass(i,s),this._link=DG.DomUtil.create("a",o+" "+o+"__"+this.options.iconClass,i),this._link.href="#",this._renderTranslation(),this._map=t,this.fireEvent("add"),DG.DomEvent.on(i,"click",this._toggleControl,this).on(i,"dblclick",DG.DomEvent.stopPropagation),this.fireEvent("add"),i)},onRemove:function(){this.fireEvent("remove"),DG.DomEvent.off(this._link,"click",this._toggleControl)},setState:function(t){return this._link&&this._container?(this._state&&(DG.DomUtil.removeClass(this._container,this._controlCLass+"__"+this._state),DG.DomUtil.removeClass(this._link,this._controlIconCLass+"__"+this._state),DG.DomUtil.removeClass(this._link,this._controlIconCLass+"__"+this.options.iconClass+"__"+this._state),this._state=null),t&&(this._state=t,DG.DomUtil.addClass(this._container,this._controlCLass+"__"+this._state),DG.DomUtil.addClass(this._link,this._controlIconCLass+"__"+this._state),DG.DomUtil.addClass(this._link,this._controlIconCLass+"__"+this.options.iconClass+"__"+this._state)),this):this},_toggleControl:function(t){DG.DomEvent.stop(t),this.fireEvent("click")}}),DG.RoundControl.include(DG.Locale),DG.roundControl=function(t){return new DG.RoundControl(t)};DG.ProjectDetector=DG.Handler.extend({options:{url:"http://catalog.api.2gis.ru/2.0/search",data:{key:"rujrdp3400",fields:"data.bound,data.max_zoom_level,data.min_zoom_level,data.time_zone,data.time_zone_as_offset,data.code",type:"project",lang:"all"}},initialize:function(t){this._map=t,this.project=null,this._loadProjectList()},addHooks:function(){this._map.on("move",this._projectWatch,this)},removeHooks:function(){this._map.off("move",this._projectWatch,this)},getProject:function(){return this.project?DG.Util.extend({},this.project):!1},getProjectsList:function(){return DG.projectsList.slice(0)},isProjectHere:function(t,e){if(t){t instanceof DG.LatLng||t instanceof DG.LatLngBounds||(t=DG.latLng(t)),t=t instanceof DG.LatLngBounds?DG.latLngBounds(t.getSouthWest().wrap(),t.getNorthEast().wrap()):t.wrap();var o=t instanceof DG.LatLngBounds?"intersects":"contains";return e?this._testProject(o,t,e):DG.projectsList.filter(this._testProject.bind(this,o,t))[0]}},_projectWatch:function(){this.project&&this._boundInProject(this.project)&&this._zoomInProject(this.project)||(this.project&&(this.project=null,this._map.fire("projectleave")),this._searchProject())},_loadProjectList:function(){DG.projectsList.map(function(t){return t.latLngBounds=new DG.LatLngBounds(t.bound),t})},_searchProject:function(){DG.projectsList.filter(function(t){return this._boundInProject(t)&&this._zoomInProject(t)},this).some(function(t){return this.project=t,this._map.fire("projectchange",{getProject:this.getProject.bind(this)}),!0},this)},_boundInProject:function(t){try{return this.isProjectHere(this._map.getBounds(),t)}catch(e){return!1}},_testProject:function(t,e,o){return o.latLngBounds[t](e)},_zoomInProject:function(t){return this._map.getZoom()>=t.minZoom}}),DG.Map.mergeOptions({projectDetector:!0}),DG.Map.addInitHook("addHandler","projectDetector",DG.ProjectDetector);DG = DG || {};
DG.configTheme = {
    balloonOptions: {
        offset: {
            x: 1,
            y: 9
        }
    },

    markersData: {
        iconSize: [22, 34],
        className: 'dg-customization__marker dg-customization__marker_type_mushroom',
        iconAnchor: [10, 32]
    }
};

!function(t,i){"use strict";function e(i,e,r){i._eventHandlers=i._eventHandlers||[{element:i.scroller,handler:function(t){i.scroll(t)},type:"scroll"},{element:i.bar,handler:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,i.selection(),i.drag.now=1},type:"touchstart mousedown"},{element:document,handler:function(){i.selection(1),i.drag.now=0},type:"mouseup blur touchend"},{element:i.bar,handler:function(t){2!=t.button&&i._pos0(t)},type:"touchstart mousedown"},{element:document,handler:function(t){i.drag.now&&i.drag(t)},type:"mousemove touchmove"},{element:t,handler:function(){i.update()},type:"resize"},{element:i.root,handler:function(){i.update()},type:"sizeChange"}],f(i._eventHandlers,function(t){t.element&&e(t.element,t.type,t.handler,r)})}function r(t,i,e){var r="data-baron-"+i;if("on"==e)t.setAttribute(r,"inited");else{if("off"!=e)return t.getAttribute(r);t.removeAttribute(r)}}function s(t){if(!r(t.root,t.direction)){var i=new p.prototype.constructor(t);return e(i,t.event,"on"),r(i.root,t.direction,"on"),i.update(),i}}function o(t){var i={};t=t||{};for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function n(t){var i=o(t);i.direction=i.direction||"v";var e=t.event||function(t,e,r,s){i.$(t)[s||"on"](e,r)};return i.event=function(t,i,r,s){f(t,function(t){e(t,i,r,s)})},i}function l(t){if(this.events&&this.events[t])for(var i=0;i<this.events[t].length;i++){var e=Array.prototype.slice.call(arguments,1);this.events[t][i].apply(this,e)}}if(t){var c=t.baron,a=t.jQuery,h={v:{x:"Y",pos:"top",crossPos:"left",size:"height",crossSize:"width",client:"clientHeight",crossClient:"clientWidth",offset:"offsetHeight",crossOffset:"offsetWidth",offsetPos:"offsetTop",scroll:"scrollTop",scrollSize:"scrollHeight"},h:{x:"X",pos:"left",crossPos:"top",size:"width",crossSize:"height",client:"clientWidth",crossClient:"clientHeight",offset:"offsetWidth",crossOffset:"offsetHeight",offsetPos:"offsetLeft",scroll:"scrollLeft",scrollSize:"scrollWidth"}},f=function(e,r){var s=0;for((e.length===i||e===t)&&(e=[e]);e[s];)r.call(this,e[s],s),s++},u=function(i){var e,r,s=!1;return i=i||{},r=i.$||t.jQuery,s?i.root=e=this:e=r(i.root||i.scroller),new u.fn.constructor(e,i,r)};u.fn={constructor:function(t,i,e){var r=n(i);r.$=e,f.call(this,t,function(t,i){var e=o(r);r.root&&r.scroller?(e.scroller=r.$(r.scroller,t),e.scroller.length||(e.scroller=t)):e.scroller=t,e.root=t,this[i]=s(e),this.length=i+1}),this.params=r},dispose:function(){var t=this.params;f(this,function(i){i.dispose(t)}),this.params=null},update:function(){for(var t=0;this[t];)this[t].update.apply(this[t],arguments),t++},baron:function(t){return t.root=[],t.scroller=this.params.scroller,f.call(this,this,function(i){t.root.push(i.root)}),t.direction="v"==this.params.direction?"h":"v",t._chain=!0,u(t)}};var p={};p.prototype={constructor:function(t){function e(t,i){return f(t,i)[0]}function r(t){var i=this.barMinSize||20;t>0&&i>t&&(t=i),this.bar&&f(this.bar).css(this.origin.size,parseInt(t,10)+"px")}function s(t){this.bar&&f(this.bar).css(this.origin.pos,+t+"px")}function o(){return v[this.origin.client]-this.barTopLimit-this.bar[this.origin.offset]}function n(t){return t*o.call(this)+this.barTopLimit}function c(t){return(t-this.barTopLimit)/o.call(this)}function a(){return!1}var f,u,p,v,d,g,m,b,w;return w=b=(new Date).getTime(),f=this.$=t.$,this.event=t.event,this.events={},this.root=t.root,this.scroller=e(t.scroller),this.bar=e(t.bar,this.root),v=this.track=e(t.track,this.root),!this.track&&this.bar&&(v=this.bar.parentNode),this.clipper=this.scroller.parentNode,this.direction=t.direction,this.origin=h[this.direction],this.barOnCls=t.barOnCls,this.barTopLimit=0,m=1e3*t.pause||0,this.cursor=function(t){return t["client"+this.origin.x]||(((t.originalEvent||t).touches||{})[0]||{})["page"+this.origin.x]},this.pos=function(t){var e="page"+this.origin.x+"Offset",r=this.scroller[e]?e:this.origin.scroll;return t!==i&&(this.scroller[r]=t),this.scroller[r]},this.rpos=function(t){var i,e=this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client];return i=t?this.pos(t*e):this.pos(),i/(e||1)},this.barOn=function(t){this.barOnCls&&(t||this.scroller[this.origin.client]>=this.scroller[this.origin.scrollSize]?f(this.root).removeClass(this.barOnCls):f(this.root).addClass(this.barOnCls))},this._pos0=function(t){p=this.cursor(t)-u},this.drag=function(t){this.scroller[this.origin.scroll]=c.call(this,this.cursor(t)-p)*(this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client])},this.selection=function(t){this.event(document,"selectpos selectstart",a,t?"off":"on")},this.resize=function(){function i(){var i=e.scroller[e.origin.crossOffset]-e.scroller[e.origin.crossClient];t.freeze&&!e.clipper.style[e.origin.crossSize]&&f(e.clipper).css(e.origin.crossSize,e.clipper[e.origin.crossClient]-i+"px"),f(e.scroller).css(e.origin.crossSize,e.clipper[e.origin.crossClient]+i+"px"),Array.prototype.unshift.call(arguments,"resize"),l.apply(e,arguments),w=(new Date).getTime()}var e=this,r=0;(new Date).getTime()-w<m&&(clearTimeout(d),r=m),r?d=setTimeout(i,r):i()},this.scroll=function(){function t(){c.bar&&(e=(v[c.origin.client]-c.barTopLimit)*c.scroller[c.origin.client]/c.scroller[c.origin.scrollSize],i!=e&&(r.call(c,e),i=e),u=n.call(c,c.rpos()),s.call(c,u)),Array.prototype.unshift.call(arguments,"scroll"),l.apply(c,arguments),b=(new Date).getTime()}var i,e,o=0,c=this;(new Date).getTime()-b<m&&(clearTimeout(g),o=m),o?g=setTimeout(t,o):t()},this},update:function(t){return l.call(this,"upd",t),this.resize(1),this.barOn(),this.scroll(),this},dispose:function(t){e(this,this.event,"off"),r(this.root,t.direction,"off"),a(this.scroller).css(this.origin.crossSize,""),this.barOn(!0),l.call(this,"dispose")},on:function(t,i,e){for(var r=t.split(" "),s=0;s<r.length;s++)"init"==r[s]?i.call(this,e):(this.events[r[s]]=this.events[r[s]]||[],this.events[r[s]].push(function(t){i.call(this,t||e)}))}},u.fn.constructor.prototype=u.fn,p.prototype.constructor.prototype=p.prototype,u.noConflict=function(){return t.baron=c,u},u.version="0.6.6",a&&a.fn&&(a.fn.baron=u),t.baron=u,t.module&&module.exports&&(module.exports=u.noConflict())}}(window),function(t,e){var r=function(t){function r(t,i){l<(c.minView||0)&&(i=e),i!==e?(i+="px",this.$(n[t]).css(this.origin.pos,i).addClass(c.outside)):this.$(n[t]).css(this.origin.pos,"").removeClass(c.outside)}function s(t){try{i=document.createEvent("WheelEvent"),i.initWebKitWheelEvent(t.originalEvent.wheelDeltaX,t.originalEvent.wheelDeltaY),u.dispatchEvent(i),t.preventDefault()}catch(t){}}function o(t){var i;for(var e in t)c[e]=t[e];if(n=this.$(c.elements,this.scroller)){l=this.scroller[this.origin.client];for(var r=0;r<n.length;r++)i={},i[this.origin.size]=n[r][this.origin.offset],n[r].parentNode!==this.scroller&&this.$(n[r].parentNode).css(i),i={},i[this.origin.crossSize]=n[r].parentNode[this.origin.crossClient],this.$(n[r]).css(i),l-=n[r][this.origin.offset],f[r]=n[r].parentNode[this.origin.offsetPos],a[r]=a[r-1]||0,h[r]=h[r-1]||Math.min(f[r],0),n[r-1]&&(a[r]+=n[r-1][this.origin.offset],h[r]+=n[r-1][this.origin.offset]),(0!=r||0!=f[r])&&(this.event(n[r],"mousewheel",s,"off"),this.event(n[r],"mousewheel",s));c.limiter&&n[0]&&(this.track&&this.track!=this.scroller?(i={},i[this.origin.pos]=n[0].parentNode[this.origin.offset],this.$(this.track).css(i)):this.barTopLimit=n[0].parentNode[this.origin.offset],this.scroll()),c.limiter===!1&&(this.barTopLimit=0)}var o={element:n,handler:function(){for(var t,i=v(this)[0].parentNode,e=i.offsetTop,r=0;r<n.length;r++)n[r]===this&&(t=r);var s=e-a[t];c.scroll?c.scroll({x1:d.scroller.scrollTop,x2:s}):d.scroller.scrollTop=s},type:"click"};c.clickable&&(this._eventHandlers.push(o),p(o.element,o.type,o.handler,"off"),p(o.element,o.type,o.handler,"on"))}var n,l,c={outside:"",before:"",after:"",past:"",future:"",radius:0,minView:0},a=[],h=[],f=[],u=this.scroller,p=this.event,v=this.$,d=this;this.on("init",o,t),this.on("init scroll",function(){var t,i,s=[];if(n){for(var o,u=0;u<n.length;u++)t=0,f[u]-this.pos()<h[u]+c.radius?(t=1,i=a[u]):f[u]-this.pos()>h[u]+l-c.radius?(t=2,i=a[u]+l):(t=3,i=e),t!=s[u]&&(r.call(this,u,i),s[u]=t,o=!0);if(o)for(u=0;u<n.length;u++)1==s[u]&&c.past&&this.$(n[u]).addClass(c.past).removeClass(c.future),2==s[u]&&c.future&&this.$(n[u]).addClass(c.future).removeClass(c.past),3==s[u]&&(c.future||c.past)&&this.$(n[u]).removeClass(c.past).removeClass(c.future),s[u]!=s[u+1]&&1==s[u]&&c.before?this.$(n[u]).addClass(c.before).removeClass(c.after):s[u]!=s[u-1]&&2==s[u]&&c.after?this.$(n[u]).addClass(c.after).removeClass(c.before):this.$(n[u]).removeClass(c.before).removeClass(c.after)}}),this.on("resize upd",function(t){o.call(this,t&&t.fix)})};baron.fn.fix=function(t){for(var i=0;this[i];)r.call(this[i],t),i++;return this}}(window),function(){var t=function(t){var i,e,r,s,o=this;s=t.screen||.9,t.forward&&(i=this.$(t.forward,this.clipper),this.event(i,"click",function(){var i=o.pos()-t.delta||30;o.pos(i)})),t.backward&&(e=this.$(t.backward,this.clipper),this.event(e,"click",function(){var i=o.pos()+t.delta||30;o.pos(i)})),t.track&&(r=t.track===!0?this.track:this.$(t.track,this.clipper)[0],r&&this.event(r,"mousedown",function(t){var i=t["offset"+o.origin.x],e=o.bar[o.origin.offsetPos],r=0;e>i?r=-1:i>e+o.bar[o.origin.offset]&&(r=1);var n=o.pos()+r*s*o.scroller[o.origin.client];o.pos(n)}))};baron.fn.controls=function(i){for(var e=0;this[e];)t.call(this[e],i),e++;return this}}(window),function(){var t=function(t){function i(){return m.scroller[m.origin.scroll]+m.scroller[m.origin.offset]}function e(){return m.scroller[m.origin.scrollSize]}function r(){return m.scroller[m.origin.client]}function s(t,i){var e=5e-4*t;return Math.floor(i-e*(t+550))}function o(t){h=t,t?(n(),l=setInterval(n,200)):clearInterval(l)}function n(){var n,l,h={},z=i(),$=e(),T=1==b;if(l=0,b>0&&(l=40),n=s(C,l),z>=$-C&&b>-1?T&&(C+=n):C=0,0>C&&(C=0),h[u]=C+"px",r()<=e()){m.$(f).css(h);for(var x=0;x<d.length;x++)m.$(d[x].self).css(d[x].property,Math.min(C/p*100,100)+"%")}g&&C&&m.$(m.root).addClass(g),0==C&&t.onCollapse&&t.onCollapse(),b=0,c=setTimeout(function(){b=-1},y),v&&C>p&&!a&&(v(),a=!0),0==C?w++:w=0,w>1&&(o(!1),a=!1,g&&m.$(m.root).removeClass(g))}var l,c,a,h,f=this.$(t.block),u=t.size||this.origin.size,p=t.limit||80,v=t.onExpand,d=t.elements||[],g=t.inProgress||"",m=this,b=0,w=0,C=0,y=t.waiting||500;this.on("init",function(){o(!0)}),this.on("dispose",function(){o(!1)}),this.event(this.scroller,"mousewheel DOMMouseScroll",function(t){var r=t.wheelDelta<0||t.originalEvent&&t.originalEvent.wheelDelta<0||t.detail>0;r&&(b=1,clearTimeout(c),!h&&i()>=e()&&o(!0))})};baron.fn.pull=function(i){for(var e=0;this[e];)t.call(this[e],i),e++;return this}}(window);var controlAddTo=DG.Control.prototype.addTo,panBy=DG.Map.prototype.panBy,getBoundsZoom=DG.Map.prototype.getBoundsZoom;DG.Control.include({addTo:function(t){return t.on("langchange",this._renderTranslation,this),controlAddTo.call(this,t)},_renderTranslation:function(){}}),DG.Marker.prototype.options.icon=DG.divIcon(DG.configTheme.markersData),DG.Map.include({_mapMaxZoomCache:void 0,initialize:function(t,o){o=L.setOptions(this,o),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(o.layers),o.center&&void 0!==o.zoom&&this.setView(L.latLng(o.center),o.zoom,{reset:!0})},setView:function(t,o,i){if(this._resctrictZoom(t),o=this._limitZoom(void 0===o?this._zoom:o),t=this._limitCenter(DG.latLng(t),o,this.options.maxBounds),i=i||{},i.animate&&(i.animate=this._testAnimation(t)),this._panAnim&&this._panAnim.stop(),this._loaded&&!i.reset&&i!==!0){void 0!==i.animate&&(i.zoom=DG.extend({animate:i.animate},i.zoom),i.pan=DG.extend({animate:i.animate},i.pan));var e=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,o,i.zoom):this._tryAnimatedPan(t,i.pan);if(e)return clearTimeout(this._sizeTimer),this}return this._resetView(t,o),this},panBy:function(t,o){var i=panBy.call(this,t,o),e=this._resctrictZoom(this.getCenter());return this.getZoom()>e&&this.setZoom(e),i},getBoundsZoom:function(t,o,i){return this._resctrictZoom(t),getBoundsZoom.call(this,t,o,i)},_testAnimation:function(t){return this.projectDetector.enabled()?this.projectDetector.getProject().code===this.projectDetector.isProjectHere(t).code:!0},_updateTln:function(t){"string"==typeof this._tln&&(this._tln=0),t.layer instanceof DG.TileLayer&&!(t.layer instanceof DG.Traffic)&&("layeradd"===t.type?this._tln++:this._tln--)},_resctrictZoom:function(t){if(this._layers&&this.projectDetector.enabled()&&(1===this._tln||"dgTiles"===this._tln)){var o=this.options,i=!!o.maxZoom,e=this.baseLayer,n=this.projectDetector.isProjectHere(t);return i?(this._mapMaxZoomCache||(this._mapMaxZoomCache=o.maxZoom),o.maxZoom=this._mapMaxZoomCache&&n?this._mapMaxZoomCache:"13",n&&(this._mapMaxZoomCache=o.maxZoom),o.maxZoom):(e.options.maxZoom=n?n.maxZoom:"13",this._updateZoomLevels(),e.options.maxZoom)}}}),DG.Map.addInitHook(function(){this.on("layeradd layerremove",this._updateTln)}),DG.Browser.safari51=/5\.1[\.\d]* Safari/.test(navigator.userAgent);!function(){var t=DG.configTheme.balloonOptions.offset.x,i=DG.configTheme.balloonOptions.offset.y,e=DG.Popup.prototype.initialize,o=DG.Popup.prototype._initLayout,s=DG.Popup.prototype._onCloseButtonClick,r=DG.Popup.prototype.onAdd,n=DG.Popup.prototype.onRemove,a=DG.Popup.prototype._adjustPan,p=baron.noConflict(),l=function(t){this[0]=t,this.length=1};l.prototype={setAttribute:function(t,i){return this[0].setAttribute(t,i),this},getAttribute:function(t){return this[0].getAttribute(t)},removeAttribute:function(t){return this[0].removeAttribute(t),this},css:function(t,i){return i?(this[0].style[t]=i,this):DG.DomUtil.getStyle(this[0],t)}},DG.Popup.prototype.options.offset=DG.point(t,i),DG.Popup.mergeOptions({border:16}),DG.Popup.include({_headerContent:null,_footerContent:null,_scroller:null,_scrollerBar:null,_barWrapper:null,_baron:null,_isBaronExist:!1,_popupShowClass:"leaflet-popup_show_true",_popupHideClass:"leaflet-popup_show_false",_popupTipClass:"leaflet-popup-tip-container",_tipSVGPath:"M0 0c12.643 0 28 7.115 28 44h2c0-36.885 15.358-44 28-44h-58z",initialize:function(t,i){this._popupStructure={},e.call(this,t,i)},onAdd:function(t){t.on("entranceshow",this._closePopup,this),r.call(this,t),this._animateOpening()},onRemove:function(t){this._animateClosing(),t.off("entranceshow",this._closePopup,this),n.call(this,t)},setContent:function(t){return this._isNode(t)||"object"!=typeof t||null===typeof t?this._bodyContent=t:Object.keys(t).forEach(function(i){this["_"+i+"Content"]=t[i]},this),this.update(),this},setHeaderContent:function(t){return this._headerContent=t,this.update(),this},setFooterContent:function(t){return this._footerContent=t,this.update(),this},clear:function(){return Object.keys(this._popupStructure).forEach(this._clearElement,this),this._isBaronExist=!1,this},clearHeader:function(){return this._clearElement("header")},clearFooter:function(){return this._clearElement("footer")},findElement:function(t){return this._contentNode.querySelector(t)},_animateOpening:function(){DG.DomUtil.addClass(this._innerContainer,this._popupShowClass),DG.DomUtil.removeClass(this._innerContainer,this._popupHideClass)},_animateClosing:function(){DG.DomUtil.addClass(this._innerContainer,this._popupHideClass),DG.DomUtil.removeClass(this._innerContainer,this._popupShowClass)},_closePopup:function(){this._map.closePopup(this)},_isNode:function(t){return t.nodeName?!0:!1},_initLayout:function(){o.call(this),this._innerContainer=DG.DomUtil.create("div","leaflet-popup-inner "+this._popupHideClass,this._container),this.options.closeButton&&this._innerContainer.appendChild(this._detachEl(this._closeButton)),this._innerContainer.appendChild(this._detachEl(this._wrapper));var t=this._detachEl(this._tipContainer);if(DG.Browser.svg){var i=DG.SVG.create("path"),e=this._popupTipClass+" "+this._popupTipClass+"_svg";i.setAttribute("d",this._tipSVGPath),t=DG.SVG.create("svg"),t.setAttribute("class",e),t.appendChild(i),DG.DomEvent.disableClickPropagation(i)}else DG.DomUtil.addClass(t,this._popupTipClass+"_image"),DG.DomEvent.disableClickPropagation(t);this._innerContainer.appendChild(t)},_clearElement:function(t){return this["_"+t+"Content"]=null,this._detachEl(this._popupStructure[t]),delete this._popupStructure[t],this},_updateScrollPosition:function(){this._baron&&this._baron.update()},resize:function(){var t=this._isBaronExist?this._scroller.scrollTop:!1;this._updateLayout(),this._updatePosition(),this._isContentHeightFit()?this._isBaronExist?(DG.DomUtil.removeClass(this._scroller,"dg-baron-hide"),DG.DomUtil.addClass(this._scroller,"scroller-with-header"),DG.DomUtil.addClass(this._scroller,"scroller"),t&&(this._scroller.scrollTop=t),this._updateScrollPosition()):(this._initBaronScroller(),this._initBaron()):this._isBaronExist&&(DG.DomUtil.addClass(this._scroller,"dg-baron-hide"),DG.DomUtil.removeClass(this._scroller,"scroller-with-header"),DG.DomUtil.removeClass(this._scroller,"scroller"),DG.DomEvent.off(this._scroller,"scroll",this._onScroll)),a.call(this),this._bindAdjustPanOnTransitionEnd()},_adjustPan:function(t){this._map&&(t?"max-height"===t.propertyName&&(setTimeout(a.bind(this),1),DG.DomEvent.off(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan)):a.call(this))},_bindAdjustPanOnTransitionEnd:function(){DG.DomUtil.TRANSITION?DG.DomEvent.on(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan,this):this._adjustPan()},_isContentHeightFit:function(){var t,i=this.options.maxHeight;return t=this._popupStructure.body?this._popupStructure.body.offsetHeight+this._getDelta():this._contentNode.offsetHeight,t+=2*this.options.border,i&&t>i},_initBaronScroller:function(){var t=this._popupStructure.body.parentNode,i=this._scrollerWrapper=DG.DomUtil.create("div","scroller-wrapper",t),e=this._scroller=DG.DomUtil.create("div","scroller",i),o=this._barWrapper=DG.DomUtil.create("div","scroller__bar-wrapper",e),s=this.options.maxHeight-2*this.options.border;this._scrollerBar=DG.DomUtil.create("div","scroller__bar",o),e.appendChild(this._detachEl(this._popupStructure.body)),s-=this._getDelta(),i.style.height=Math.max(18,s)+"px",i.style.width=t.offsetWidth+5+"px",this._isBaronExist=!0,DG.DomEvent.on(e,"scroll",this._onScroll,this)},_onScroll:function(t){this.fire("scroll",{originalEvent:t})},_initBaron:function(){var t=this._scrollerWrapper;this._baron=p({scroller:".scroller",bar:".scroller__bar",track:".scroller__bar-wrapper",$:function(i){var e="[object String]"==={}.toString.call(i)?t.querySelector(i):i;return new l(e)},event:function(t,i,e,o){i.split(" ").forEach(function(i){DG.DomEvent[o||"on"](t,i,e)})}})},_initHeader:function(){this._popupStructure.header=DG.DomUtil.create("header","dg-popup-header",this._contentNode)},_initFooter:function(){this._popupStructure.footer=DG.DomUtil.create("footer","dg-popup-footer",this._contentNode)},_initBodyContainer:function(){this._popupStructure.wrapper=DG.DomUtil.create("div","dg-popup-container-wrapper",this._contentNode),this._popupStructure.body=DG.DomUtil.create("div","dg-popup-container",this._popupStructure.wrapper)},update:function(){if(this._map){if(this._container.style.visibility="hidden",this._clearNode(this._contentNode),this._headerContent&&this._initHeader(),this._bodyContent&&this._initBodyContainer(),this._footerContent&&this._initFooter(),this._updatePopupStructure(),this.resize(),DG.DomEvent.on(this._wrapper,"click",DG.DomEvent.stopPropagation),DG.Browser.ielt9){var t=this._popupStructure.footer;t&&(t.className+=" ie-shit")}this._container.style.visibility=""}},_getDelta:function(){var t=0,i=this._popupStructure;return i.header&&(t+=i.header.offsetHeight),i.footer&&(t+=i.footer.offsetHeight),t},_updateLayout:function(){var t,i=this._contentNode,e=this._wrapper,o=i.style,s=e.style,r="leaflet-popup-scrolled";o.margin=this.options.border+"px",this._isContentHeightFit()?(s.maxHeight=this.options.maxHeight+"px",DG.DomUtil.addClass(i,r)):(s.maxHeight=i.offsetHeight+2*this.options.border+"px",DG.DomUtil.removeClass(i,r)),o.whiteSpace="nowrap",t=e.offsetWidth,o.whiteSpace="",t=Math.min(t,this.options.maxWidth),t=Math.max(t,this.options.minWidth),s.width=t+"px",this._containerWidth=this._container.offsetWidth},_updatePopupStructure:function(){Object.keys(this._popupStructure).forEach(function(t){this._insertContent(this["_"+t+"Content"],this._popupStructure[t])},this),this.fire("contentupdate")},_insertContent:function(t,i){t&&i&&("string"==typeof t?i.innerHTML=t:(this._clearNode(i),i.appendChild(t)))},_clearNode:function(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)},_detachEl:function(t){return t.parentNode&&t.parentNode.removeChild(t),t},_onCloseButtonClick:function(t){this._animateClosing(),DG.DomUtil.TRANSITION?DG.DomEvent.on(this._innerContainer,DG.DomUtil.TRANSITION_END,this._firePopupClose,this):this._firePopupClose(t),DG.DomEvent.stop(t)},_firePopupClose:function(t){DG.DomUtil.TRANSITION&&DG.DomEvent.off(this._innerContainer,DG.DomUtil.TRANSITION_END,this._firePopupClose,this),s.call(this,t)}})}(),DG.Map.include({_markerClass:"dg-customization__marker_type_mushroom",_markerShowClass:"dg-customization__marker_appear",_markerHideClass:"dg-customization__marker_disappear",_dgHideClass:"dg-hidden",openPopup:function(t,i,e){if(!(t instanceof L.Popup)){var o=t;t=new L.Popup(e).setContent(o)}return i&&t.setLatLng(i),this.hasLayer(t)?this:(this.closePopup(),this._popup=t,t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerShowClass),DG.DomUtil.addClass(t._source._icon,this._markerHideClass)):(DG.DomUtil.addClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.addClass(t._source._shadow,this._dgHideClass))),this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerHideClass),DG.DomUtil.addClass(t._source._icon,this._markerShowClass)):(DG.DomUtil.removeClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.removeClass(t._source._shadow,this._dgHideClass))),this.removeLayer(t)),this}});DG.Control.Zoom.include(DG.Locale),DG.Control.Zoom.Dictionary={},DG.Control.Zoom.include({options:{position:DG.Browser.touch?"bottomright":"topleft"},onAdd:function(t){var o="dg-zoom",i='<div class="dg-control-round_icon dg-zoom__control dg-zoom__{type}-button"></div>',n=DG.DomUtil.create("div",o);return this._map=t,this._zoomInButton=this._createButton(DG.Util.template(i,{type:"in"}),this.t("zoom_in"),"dg-control-round "+o+"__in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(DG.Util.template(i,{type:"out"}),this.t("zoom_out"),"dg-control-round "+o+"__out",n,this._zoomOut,this),this._eventListeners={},this._eventListeners.zoomend=this._eventListeners.zoomlevelschange=this._updateDisabled,this._updateDisabled(),t.on(this._eventListeners,this),n},onRemove:function(t){t.off(this._eventListeners,this)},_renderTranslation:function(){this._zoomInButton.title=this.t("zoom_in"),this._zoomOutButton.title=this.t("zoom_out")}});DG.Control.Zoom.Dictionary.ru={zoom_in:"Приблизить",zoom_out:"Отдалить"};DG.Control.Zoom.Dictionary.it={zoom_in:"Zoom avanti",zoom_out:"Zoom indietro"};DG.Control.Zoom.Dictionary.cs={zoom_in:"Přiblížit",zoom_out:"Oddálit"};DG.Control.Zoom.Dictionary.en={zoom_in:"Zoom in",zoom_out:"Zoom out"};DG.Control.Location=DG.RoundControl.extend({statics:{Dictionary:{}},options:{iconClass:"locate",position:DG.Browser.touch?"bottomright":"topleft",drawCircle:!0,follow:!0,stopFollowingOnDrag:!1,metric:!0,onLocationError:function(){},onLocationOutsideMapBounds:function(){},locateOptions:{}},initialize:function(t){return DG.Util.setOptions(this,t),navigator.geolocation?(this._event=void 0,this._locateOptions={watch:!0,setView:!1},DG.extend(this._locateOptions,this.options.locateOptions),this._resetVariables(),this.on({click:this._handleLocate,add:this._initLocate}),void 0):(this._disable=!0,void 0)},_initLocate:function(){this._layer=new DG.LayerGroup,this._layer.addTo(this._map),this._map.on({locationfound:this._onLocationFound,locationerror:this._onLocationError},this)},_handleLocate:function(){this._active&&this._event&&(this._map.getBounds().contains(this._event.latlng)||this._isOutsideMapBounds())?this._stopLocate():(this._locateOnNextLocationFound=!0,this._active||this._map.locate(this._locateOptions),this._active=!0,this.options.follow&&this._startFollowing(),this._clearError(),this._event?this._visualizeLocation():this.setState("requesting"))},_onLocationFound:function(t){this._event&&this._event.latlng.lat===t.latlng.lat&&this._event.latlng.lng===t.latlng.lng&&this._event.accuracy===t.accuracy||this._active&&(this._event=t,this.options.follow&&this._following&&(this._locateOnNextLocationFound=!0),this._visualizeLocation())},_startFollowing:function(){this._following=!0,this.options.stopFollowingOnDrag&&this._map.on("dragstart",this._stopFollowing)},_stopFollowing:function(){this._following=!1,this.options.stopFollowingOnDrag&&this._map.off("dragstart",this._stopFollowing),this._visualizeLocation()},_isOutsideMapBounds:function(){return void 0===this._event?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_visualizeLocation:function(){void 0===this._event.accuracy&&(this._event.accuracy=0);var t=this._event.accuracy;if(this._locateOnNextLocationFound){if(this._isOutsideMapBounds())this.options.onLocationOutsideMapBounds(this);else{this._map.setView(this._event.latlng,13);var i=this._map.projectDetector.getProject().maxZoom||13;this._map.setZoom(i)}this._locateOnNextLocationFound=!1}var o={color:"#FFF",fillColor:"#FFF",fillOpacity:.4,weight:0,opacity:.3};this.options.drawCircle&&(this._circle?this._circle.setLatLng(this._event.latlng).setRadius(t):this._circle=DG.circle(this._event.latlng,t,o).addTo(this._layer));var n,s;this.options.metric?(n=t.toFixed(0),s="meters"):(n=(3.2808399*t).toFixed(0),s="feet");var e={icon:DG.divIcon({className:"dg-locate-pin",iconSize:[20,20]})};this._marker?this._marker.setLatLng(this._event.latlng):this._marker=DG.marker(this._event.latlng,e).bindLabel(this.t("you_are_here")).addTo(this._layer),DG.DomEvent.on(this._marker,"click",function(){this._map.fireEvent("dgLocateClick")}),this._container&&this.setState("active")},_resetVariables:function(){this._active=!1,this._following=!1},_stopLocate:function(){this._map.stopLocate(),this._map.off("dragstart",this._stopFollowing),this.setState(),this._resetVariables(),this._layer.clearLayers(),this._marker=void 0,this._circle=void 0,this._event=void 0},_onLocationError:function(t){if(3!==t.code||!this._locateOptions.watch){this._stopLocate(),this._error=DG.DomUtil.create("div","dg-label dg-label_location-error",this._container),this._errorText=DG.DomUtil.create("div","dg-label__content",this._error),this._errorText.innerHTML=this.t("cant_find");var i=this;setTimeout(function(){i._clearError()},3e3),this.options.onLocationError(t)}},_clearError:function(){this._error&&(this._container.removeChild(this._error),this._error=void 0,this._errorText=void 0)},_renderTranslation:function(){this._link&&(this._link.title=this.t("button_title")),this._marker&&this._marker.bindLabel(this.t("you_are_here"))}}),DG.control.location=function(t){return new DG.Control.Location(t)},DG.Map.addInitHook(function(){this.options.locationControl&&(this.locationControl=DG.control.location(this.options.locationControl),this.addControl(this.locationControl))});DG.Control.Location.Dictionary.ru={cant_find:"Мы не смогли Вас найти",you_are_here:"Вы здесь",button_title:"Найти Вас на карте"};DG.Control.Location.Dictionary.it={cant_find:"Non siamo riusciti a localizzarti",you_are_here:"Voi siete qui",button_title:"Trova la tua posizione sulla mappa"};DG.Control.Location.Dictionary.cs={cant_find:"Nepodařilo se nám určit Vaši polohu",you_are_here:"Jste tady",button_title:"Určit Vaši polohu na mapě"};DG.Control.Location.Dictionary.en={cant_find:"We can't find you",you_are_here:"You are here",button_title:"Show your location"};DG.Screenfull=DG.Class.extend({_apiMap:[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],initialize:function(){this.api=this._api()},request:function(e){var l=this.api.requestFullscreen;e=e||document.documentElement,e[l](Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[this.api.exitFullscreen]()},isFullscreen:function(){return!!document[this.api.fullscreenElement]},_api:function(){var e={},l=this._apiMap;return l.forEach(function(n){n&&n[1]in document&&n.forEach(function(n,r){e[l[0][r]]=n})}),e.requestFullscreen?e:!1}}),DG.screenfull=new DG.Screenfull;(!DG.screenfull.api||DG.Browser.android&&DG.Browser.gecko||DG.Browser.safari51)&&(DG.Screenfull.include({_fullscreenClass:"DGFullScreen_legacy-mode",_fullscreenBodyClass:this._fullscreenClass+"-body",_api:function(){return{fullscreenchange:"keyup"}},_mapParams:["zIndex","position","left","top","border","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","previousSibling","width","height"],_documentParams:["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","overflow","scrollTop"],_initialDocumentParams:{},_initialMapParams:{},_initialDocumentElementParams:{},exit:function(t){DG.DomUtil.removeClass(t,this._fullscreenClass),DG.DomUtil.removeClass(document.body,this._fullscreenBodyClass),this._mapParams.forEach(function(e){t.style[e]=this._initialMapParams[e]},this),this._documentParams.forEach(function(t){document.body.style[t]=this._initialDocumentParams[t]},this),document.documentElement.scrollTop=this._initialDocumentElementParams.scrollTop},request:function(t){this._storePosition(t),DG.DomUtil.addClass(t,this._fullscreenClass),DG.DomUtil.addClass(document.body,this._fullscreenBodyClass),document.documentElement.scrollTop="0px"},_storePosition:function(t){this._mapParams.forEach(function(e){this._initialMapParams[e]=t.style[e]},this),this._documentParams.forEach(function(t){this._initialDocumentParams[t]=document.body.style[t]},this),this._initialDocumentElementParams.scrollTop=document.documentElement.scrollTop},_onFullScreenStateChange:function(t){t||(t=window.event),27===t.keyCode&&this._exitFullScreen()}}),DG.screenfull=new DG.Screenfull);DG.Control.Fullscreen=DG.RoundControl.extend({statics:{Dictionary:{}},options:{position:DG.Browser.touch?"bottomright":"topright",iconClass:"fullscreen"},initialize:function(e){DG.Util.setOptions(this,e),this._isFullscreen=!1,this.on("click",this._toggleFullscreen)},_toggleFullscreen:function(){this._isFullscreen?this._toggle(!1,"exit","on","cancelfullscreen"):this._toggle(!0,"request","on","requestfullscreen"),this._renderTranslation(),this._map.invalidateSize()},_renderTranslation:function(){this._link.title=this.t(this._isFullscreen?"title_min":"title_max")},_toggle:function(e,t,n,l){var i=this._map._container;this._isFullscreen=e,this.setState(e?"active":""),DG.screenfull[t](i),DG.DomEvent[n](document,DG.screenfull.api.fullscreenchange,this._onFullScreenStateChange,this),this._map.fire(l)},_onFullScreenStateChange:function(){!DG.screenfull.isFullscreen()&&this._toggle(!1,"exit","on","cancelfullscreen")}}),DG.control.fullscreen=function(e){return new DG.Control.Fullscreen(e)},DG.Map.mergeOptions({fullscreenControl:!0}),DG.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=DG.control.fullscreen(this.options.fullscreenControl),this.addControl(this.fullscreenControl))});DG.Control.Fullscreen.Dictionary.ru={title_max:"Развернуть",title_min:"Восстановить"};DG.Control.Fullscreen.Dictionary.it={title_max:"Espandi",title_min:"Ripristina"};DG.Control.Fullscreen.Dictionary.cs={title_max:"Rozbalit",title_min:"Obnovit"};DG.Control.Fullscreen.Dictionary.en={title_max:"Expand",title_min:"Restore"};DG.Map.addInitHook(function(){this._tln="dgTiles",this.baseLayer=new(DG.TileLayer.extend({onRemove:function(A){A.projectDetector.disable(),DG.TileLayer.prototype.onRemove.call(this,A)}}))("http://tile{s}.maps.2gis.ru/tiles?x={x}&y={y}&z={z}&v=1",{subdomains:"0123456789",errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAAA1BMVEX28t5R0k5UAAAAH0lEQVR4Xu3AAQkAAADCMPunNsdhWxwAAAAAAAAAwAEhAAABg2UP5AAAAABJRU5ErkJggg==",detectRetina:!0,maxNativeZoom:18}).addTo(this)});DG.Meta=DG.Handler.extend({_currentPoi:null,_currentBuilding:null,_currentTile:null,_currentTileMetaData:null,_listenPoi:!1,_listenBuildings:!1,_listenTraffic:!1,options:{zoomOffset:0},initialize:function(i,t){DG.setOptions(this,t),this._map=i,this._mapPanes=i.getPanes(),this._tileSize=DG.TileLayer.prototype.options.tileSize,this.options.zoomOffset||i.eachLayer(function(i){i instanceof DG.TileLayer&&i.options.zoomOffset&&(this.options.zoomOffset=i.options.zoomOffset,this.options.maxNativeZoom=i.options.maxNativeZoom,this._tileSize=i.options.tileSize)},this),this._metaHost=new DG.Meta.Host(i,this)},addHooks:function(){this._calcTilesAtZoom(),this._map.on(this._mapEventsListeners,this)},removeHooks:function(){this._map.off(this._mapEventsListeners,this)},enablePoiListening:function(){return this.enable(),this._listenPoi=!0,this},enableBuildingsListening:function(){return this.enable(),this._listenBuildings=!0,this},enableTrafficListening:function(){return this.enable(),this._listenTraffic=!0,this},disablePoiListening:function(){return this._listenPoi=!1,this},disableBuildingsListening:function(){return this._listenBuildings=!1,this},disableTrafficListening:function(){return this._listenTraffic=!1,this},_mapEventsListeners:{mousemove:function(i){if(!(this._map.getZoom()<10||!(this._listenPoi||this._listenBuildings||this._listenTraffic)||this._map._panTransition&&this._map._panTransition._inProgress)){if(!this._isEventTargetAllowed(i.originalEvent.target||i.originalEvent.srcElement))return this._leaveCurrentPoi(),this._leaveCurrentBuilding(),this._leaveCurrentTraffic(),void 0;var t=this._getTileID(i),e=this._getDataZoom(),n=this;this._isTileChanged(t)?(this._currentTileMetaData=null,this._currentTile=t,this._metaHost.getTileData(t).then(function(i){n._currentTileMetaData=i})):this._currentTileMetaData&&(this._listenPoi&&this._checkPoiHover(i.latlng,e),this._listenBuildings&&this._checkBuildingHover(i.latlng),this._listenTraffic&&this._checkTrafficHover(i.latlng,e))}},mouseout:function(){this._leaveCurrentPoi(),this._leaveCurrentBuilding(),this._leaveCurrentTraffic()},viewreset:function(){this._calcTilesAtZoom(),this._leaveCurrentPoi(),this._leaveCurrentBuilding(),this._leaveCurrentTraffic()}},_getDataZoom:function(){var i=this._map._zoom+this.options.zoomOffset;return this.options.maxNativeZoom?Math.min(i,this.options.maxNativeZoom):i},_checkPoiHover:function(i,t){var e=this._isMetaHovered(i,this._currentTileMetaData.poi,t);!this._currentPoi||e&&this._currentPoi.id===e.id||this._leaveCurrentPoi(),!e||this._currentPoi&&this._currentPoi.id===e.id||(this._currentPoi=e,this._map.fire("poihover",{poi:this._currentPoi,latlng:i}),DG.DomEvent.addListener(this._mapPanes.mapPane,"click",this._onDomMouseClick,this))},_checkBuildingHover:function(i){var t=this._isMetaHovered(i,this._currentTileMetaData.buildings);!this._currentBuilding||t&&this._currentBuilding.id===t.id||this._leaveCurrentBuilding(),!t||this._currentBuilding&&this._currentBuilding.id===t.id||(this._currentBuilding=t,this._map.fire("buildinghover",{building:this._currentBuilding,latlng:i}))},_checkTrafficHover:function(i,t){var e=this._isMetaHovered(i,this._currentTileMetaData.traffic,t);!this._currentTraffic||e&&this._currentTraffic.id===e.id||this._leaveCurrentTraffic(),!e||this._currentTraffic&&this._currentTraffic.id===e.id||(this._currentTraffic=e,this._map.fire("traffichover",{traffic:this._currentTraffic,latlng:i}))},_leaveCurrentPoi:function(){this._currentPoi&&(this._map.fire("poileave",{poi:this._currentPoi}).off("click",this._onDomMouseClick,this),DG.DomEvent.removeListener(this._mapPanes.mapPane,"click",this._onDomMouseClick),this._currentPoi=null)},_leaveCurrentBuilding:function(){this._currentBuilding&&(this._map.fire("buildingleave",{building:this._currentBuilding}),this._currentBuilding=null)},_leaveCurrentTraffic:function(){this._currentTraffic&&(this._map.fire("trafficleave",{traffic:this._currentTraffic}),this._currentTraffic=null)},_onDomMouseClick:function(i){this._currentPoi&&(this._map.fire("poiclick",{poi:this._currentPoi,latlng:this._currentPoi.bound.getCenter()}),DG.DomEvent.stopPropagation(i))},_calcTilesAtZoom:function(){this._tilesAtZoom=Math.pow(2,this._getDataZoom())},_belongsToPane:function(i,t){for(;i&&i!==this._mapPanes.mapPane;){if(i===this._mapPanes[t])return!0;i=i.parentNode}return!1},_isEventTargetAllowed:function(i){return this._belongsToPane(i,"tilePane")||this._belongsToPane(i,"overlayPane")},_getTileID:function(i){var t=this._getDataZoom(),e=this._tileSize*((this.options.zoomOffset&&this._map._zoom===t)+1),n=this._map.project(i.latlng.wrap()),s=Math.floor(n.x/e)%this._tilesAtZoom,r=Math.floor(n.y/e);return[s,r,t].join(",")},_isTileChanged:function(i){return this._currentTile!==i},_getGeoType:function(i,t){t=t||"";var e=t+"bound",n=t+"vertices";return e in i?"bound":n in i?"vertices":!1},_contains:function(i,t){return t instanceof DG.LatLngBounds?t.contains(i):DG.PolyUtil.contains(i,t)},_isMetaHovered:function(i,t,e){return t&&t.length?(e=e||"",t.filter(function(t){var n=this._getGeoType(t,e);return n?(t[n]=t[e+n],this._contains(i,t[e+n])):!1},this).shift()||!1):!1}}),DG.Map.addInitHook("addHandler","meta",DG.Meta);DG.Meta.Storage=DG.Class.extend({_data:{},_tilesData:{},getTileData:function(t){return this._tilesData.hasOwnProperty(t)?this._tilesData[t].map(function(t){return this._data[t]},this):!1},addDataToTile:function(t,a){return this._tilesData[t]=[].concat(this._tilesData[t]||[],a.map(function(a){var e=a.id,i=t.split(",")[2];return this._addEntity(e,a,i),e},this)),this.getTileData(t)},_addEntity:function(t,a){this._data[t]=a},_formatWKT:function(t,a,e){var i=(a?a:"")+e;return t[i]="bound"===e?DG.Wkt.geoJsonLayer(t.hover).getBounds():DG.Wkt.toLatLngs(t.hover),delete t.hover,t}});DG.Meta.PoiStorage=DG.Meta.Storage.extend({_data:{},_tilesData:{},_addEntity:function(t,a,e){a.linked=a.links[Math.floor(Math.random()*a.links.length)],delete a.links,a=this._formatWKT(a,e,"bound"),this._data[t]=DG.extend(this._data[t]||{},a)}});DG.Meta.TrafficStorage=DG.Meta.Storage.extend({_data:{},_tilesData:{},addDataToTile:function(t,e){if(!e.length)return[];var a=e[1].reduce(function(t,e){return t[e.graph_id]=e.speed_text,t},{});return this._tilesData[t]=[].concat(this._tilesData[t]||[],e[0].filter(function(t){return a[t.graph_id]}).map(function(t){return{hover:t.geometry[0].object,speed:a[t.graph_id],id:t.graph_id}}).map(function(e){var a=e.id,i=t.split(",")[2];return this._addEntity(a,e,i),a},this)),this.getTileData(t)},_addEntity:function(t,e,a){e=this._formatWKT(e,a,"vertices"),this._data[t]=DG.extend(this._data[t]||{},e)}});DG.Meta.Host=DG.Class.extend({_subdomains:"0123456789",initialize:function(t,e){this._map=t,this._meta=e,this._trafficStorage=new DG.Meta.TrafficStorage,this._poiStorage=new DG.Meta.PoiStorage},getTileData:function(t){var e=this._poiStorage.getTileData(t),a=this._trafficStorage.getTileData(t);return e&&a?DG.when({poi:e,traffic:a}):this._askAndStoreTileData(t)},_askAndStoreTileData:function(t){var e=this,a=[this._askByTile(t,"http://tile{s}.maps.2gis.ru/?x={x}&y={y}&z={z}&v=1&type=poi")];return this._map.projectDetector.getProject().traffic&&this._meta._listenTraffic&&a.push(this._askByTile(t,"http://meta{s}.2gis.ru/{projectCode}/meta/{z}/{x}/{y}/graph_speed/0/")),DG.when.all(a,function(a){var i=a[0].result;return""===a[0].responseText&&(i={buildings:[],poi:[]}),i.traffic=a[1]&&""!==a[1].responseText?a[1]:[],{poi:e._poiStorage.addDataToTile(t,i.poi),traffic:e._trafficStorage.addDataToTile(t,i.traffic)}},function(){return!1})},_askByTile:function(t,e){var a=t.split(",");return DG.ajax(DG.Util.template(e,{s:this._getSubdomain(a),projectCode:this._map.projectDetector.getProject().code,z:a[2],x:a[0],y:a[1]}),{type:"get",dataType:"json"})},_getSubdomain:function(t){var e=Math.abs(t[1]+t[2])%this._subdomains.length;return this._subdomains[e]}});DG.PolyUtil.contains=function(t,e){for(var n,r=0,i=[],o=DG.Projection.SphericalMercator.project(t),a=0,s=e.length;s>a;a++)i.push(DG.Projection.SphericalMercator.project(e[a]));n=this._getEdges(i);for(var a=0,s=n.length;s>a;a++)switch(this._getEdgeType(n[a],o)){case"TOUCHING":return!0;case"CROSSING":r=1-r}return r?!0:!1},DG.PolyUtil._getEdges=function(t){for(var e,n,r,i=[],o=0,a=t.length;a>o;o++)n=t[o],r=o!==a-1?t[o+1]:t[0],e={startPoint:n,endPoint:r},i.push(e);return i},DG.PolyUtil._getEdgeType=function(t,e){var n=this._classify(t,e);switch(n){case"LEFT":return t.startPoint.y<e.y&&e.y<=t.endPoint.y?"CROSSING":"INESSENTIAL";case"RIGHT":return t.endPoint.y<e.y&&e.y<=t.startPoint.y?"CROSSING":"INESSENTIAL";case"BETWEEN":case"ORIGIN":case"DESTINATION":return"TOUCHING";default:return"INESSENTIAL"}},DG.PolyUtil._classify=function(t,e){var n,r,i;return n={x:t.endPoint.x-t.startPoint.x,y:t.endPoint.y-t.startPoint.y},r={x:e.x-t.startPoint.x,y:e.y-t.startPoint.y},i=n.x*r.y-r.x*n.y,i>0?"LEFT":0>i?"RIGHT":n.x*r.x<0||n.y*r.y<0?"BEHIND":this._getLengthSquared(n)<this._getLengthSquared(r)?"BEYOND":DG.PolyUtil._areEquals(t.startPoint,e)?"ORIGIN":DG.PolyUtil._areEquals(t.endPoint,e)?"DESTINATION":"BETWEEN"},DG.PolyUtil._getLengthSquared=function(t){return Math.pow(t.x,2)+Math.pow(t.y,2)},DG.PolyUtil._areEquals=function(t,e){return t.x===e.x&&t.y===e.y};DG.Map.mergeOptions({poi:!1}),DG.Poi=DG.Handler.extend({options:{disableLabel:!1},initialize:function(e,i){this._map=e,DG.Util.setOptions(this,i)},addHooks:function(){this._map.on(this._mapEventsListeners,this),this._map.meta.enablePoiListening(),this.options.disableLabel||(this._labelHelper=new DG.Label)},removeHooks:function(){this._map.off(this._mapEventsListeners,this),this._map.off("mousemove",this._onMouseMove,this),this._map.meta.disablePoiListening(),this._labelHelper&&(this._map.removeLayer(this._labelHelper),this._labelHelper=null)},_mapEventsListeners:{poihover:function(e){this._setCursor("pointer"),this._labelHelper&&(this._labelHelper.setPosition(e.latlng).setContent(e.poi.linked.name),this._map.on("mousemove",this._onMouseMove,this).addLayer(this._labelHelper))},poileave:function(){this._setCursor("auto"),this._labelHelper&&this._map.off("mousemove",this._onMouseMove,this).removeLayer(this._labelHelper)}},_onMouseMove:function(e){this._labelHelper.setPosition(e.latlng)},_setCursor:function(e){this._map.getContainer().style.cursor=e}}),DG.Map.addInitHook("addHandler","poi",DG.Poi);DG.Entrance=DG.Layer.extend({options:{vectors:[]},statics:{SHOW_FROM_ZOOM:DG.Browser.svg?16:17},initialize:function(t){DG.setOptions(this,t)},onAdd:function(t){this._map=t,this._initArrows().addTo(t),this._eventHandler=new DG.Entrance.EventHandler(t,this),this._eventHandler.enable(),this._arrows.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1},addTo:function(t){return t.addLayer(this),this},onRemove:function(){this._isShown=!1,this._removeArrows(),this._map=null,this._eventHandler.disable(),this._eventHandler=null,this._arrows=null},removeFrom:function(t){return t.removeLayer(this),this},show:function(t){return this._arrows?(t!==!1&&this._fitBounds(),this._isAllowedZoom()&&(this._arrows.eachLayer(function(t){t.setStyle({visibility:"visible"}),DG.Path.ANIMATION_AVAILABLE&&t.runAnimation("animateArrowPathGeom")}),this._isShown||(this._map.fire("entranceshow"),this._isShown=!0)),this):this},hide:function(){return this.isShown()&&this._arrows&&(this._arrows.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1,this._map.fire("entrancehide")),this},isShown:function(){return this._isShown},getBounds:function(){return this._arrows.getBounds()},_initArrows:function(){return this._arrows=DG.featureGroup(),this.options.vectors.map(function(t){return DG.Wkt.toLatLngs(t)}).forEach(function(t){this._arrows.addLayer(DG.Entrance.arrow(t,this._getArrowStrokeOptions())),this._arrows.addLayer(DG.Entrance.arrow(t,this._getArrowOptions()))},this),this._arrows},_removeArrows:function(){this._map.removeLayer(this._arrows.clearLayers())},_getFitZoom:function(){return this._map.projectDetector.getProject().maxZoom||DG.Entrance.SHOW_FROM_ZOOM},_fitBounds:function(){var t,e=this._map,r=this.getBounds();e.getBounds().contains(r)&&this._isAllowedZoom()||(t=this._getFitZoom(),e.projectDetector.getProject()||e.once("moveend",function(){e.setZoom(this._getFitZoom())},this),e.setView(r.getCenter(),t,{animate:!0}))},_isAllowedZoom:function(){return!(this._map.getZoom()<DG.Entrance.SHOW_FROM_ZOOM)},_getArrowStrokeOptions:function(){return{clickable:!1,color:"#fff",weight:6,byZoom:{16:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M9.313,18.984c2.246-1.468,7.101-5.562,7.101-5.562c0.781-0.781,0.781-2.047,0-2.828c0,0-5.242-4.023-7.101-5.102C9.74,5.354,8.583,5.93,8.125,6.5C7.902,6.777,9,11.614,9,11.614v0.789c0,0-0.879,4.237-0.905,5.285C8.09,17.891,9.108,19.118,9.313,18.984z"}},lastPointOffset:2,vmlEndArrow:"none",weight:6},17:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.912,21.498c3.106-2.029,9.859-7.873,9.859-7.873c2.059-1.807,2.142-1.542,0.146-3.208c0,0-7.434-6.084-10.005-7.576C7.583,2.649,6.903,3.446,6.271,4.233c-0.308,0.384,2.209,6.051,2.209,6.051v3.388c0,0-2.215,4.583-2.25,6.03C6.222,19.986,7.629,21.684,7.912,21.498z"}},lastPointOffset:0,vmlEndArrow:"none",weight:7},18:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.61,22.688c4.045-2.642,11.312-8.906,11.312-8.906c1.92-1.781,1.938-2-0.124-3.781c0,0-8.151-6.334-11.5-8.276C6.87,1.475,5.516,2.62,5.732,3.093c2.146,4.694,2.063,4.741,2.612,7.469l0.016,2.75c0,0-1.573,5.458-2.619,7.958C5.599,21.611,7.241,22.93,7.61,22.688z"}},lastPointOffset:DG.Browser.vml?-2:-5,vmlEndArrow:"none",weight:8}}}},_getArrowOptions:function(){return{clickable:!1,color:"#0085a0",weight:3,byZoom:{16:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M11.068,13.011L9.5,17.285l6.379-5.169L9.313,7.19l1.717,3.824"}},lastPointOffset:2,weight:2},17:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.354,13.969l-2.184,5.18L16.993,12L7.912,5.188l2.38,4.781"}},lastPointOffset:0,weight:3},18:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.281,13.781L7.42,21.271l11.488-9.308L7.083,3.093L10.219,10"}},lastPointOffset:DG.Browser.vml?0:-5,weight:4}}}}});DG.Path.ANIMATION_AVAILABLE=DG.Browser.svg&&!DG.Browser.mobileWebkit&&-1===navigator.userAgent.toLowerCase().indexOf("presto")&&"[object Function]"===Object.prototype.toString.call(DG.SVG.create("animate").beginElement),DG.Path.include(DG.Path.ANIMATION_AVAILABLE?{runAnimation:function(){var t=this._animationEl=this._addAnimation();return t&&(t.beginElement(),this._removeAnimation(t)),this},stopAnimation:function(t){return this.animations[t]&&this.animations[t].endElement(),this},_addAnimation:function(){var t=this.options.animation,n=this._rings[0],i=null;return t&&n.length>0&&(i=DG.SVG.create("animate"),t.getValues&&(t.values=t.getValues(n)),Object.keys(t).filter(function(n){return"[object Function]"!=={}.toString.call(t[n])}).forEach(function(n){i.setAttribute(n,t[n])}),this._path.appendChild(i)),i},_removeAnimation:function(t){this._map.once("zoomstart",function(){t&&this._path.removeChild(t),this._animationEl=null},this)}}:{});DG.Entrance.Arrow=DG.Polyline.extend({initialize:function(t,e){this._setLatLngs(t);var e=e||{};DG.Path.ANIMATION_AVAILABLE&&(e.animation=this.getArrowAnimation(this._convertLatLngs(t))),this._markers=[],L.setOptions(this,e)},onAdd:function(t){var e=this._renderer=t.getArrowRenderer();e._initPath(this),this._project(),this._update(),this._updateStyleByZoom(),e._addPath(this),e._initMarkers(this)},onRemove:function(t){DG.Polyline.prototype.onRemove.call(this,t),this._renderer._removeMarkers(this)},getEvents:function(){return{viewreset:this._project,move:this._update,zoomend:this._updateStyleByZoom}},_projectLatlngs:function(t,e){DG.Polyline.prototype._projectLatlngs.call(this,t,e),this._offsetLastPathPoint()},_update:function(){DG.Polyline.prototype._update.call(this),this._renderer._updateMarker(this)},_updateStyleByZoom:function(){var t=this.options.byZoom,e=this._map.getZoom();this.setStyle(t[e])},_offsetLastPathPoint:function(){var t,e,o={},n=this._rings[0],i=n.length,s=this.options.byZoom[this._map.getZoom()],r=n[i-1],a=n[i-2],h=r.distanceTo(a);s&&(t=Math.abs(100*s.lastPointOffset/h),e={x:n[i-1].x-n[i-2].x,y:n[i-1].y-n[i-2].y},o.x=Math.round(e.x*t/100),o.y=Math.round(e.y*t/100),s.lastPointOffset>0?(n[i-1].x+=o.x,n[i-1].y+=o.y):(n[i-1].x-=o.x,n[i-1].y-=o.y))}}),DG.Entrance.arrow=function(t,e){return new DG.Entrance.Arrow(t,e)};DG.Entrance.Arrow.SVG=DG.SVG.extend({getEvents:function(){var t={move:this._update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),DG.Browser.ie&&(t.moveend=t.mousemove=t.zoomend=this._refresh),t},_initMarkers:function(t){var e,r,i=t.options.byZoom,n=t._markerId="arrow-marker-"+DG.Util.stamp(t);Object.keys(i).map(function(a){e=DG.SVG.create("marker"),r=i[a].marker,Object.keys(r).filter(function(t){return"polygon"!==t&&"path"!==t}).forEach(function(t){e.setAttribute(t,r[t])}),e.id=n+"-"+a,e.setAttribute("orient","auto"),e.setAttribute("markerUnits","userSpaceOnUse"),e.setAttribute("stroke-width","0"),r.path&&e.appendChild(this._getMarkerChild("path",r.path,t)),r.polygon&&e.appendChild(this._getMarkerChild("polygon",r.polygon,t)),t._markers.push(e),this._getDefs().appendChild(e)},this),this._updateMarker(t)},_getMarkerChild:function(t,e,r){var i=DG.SVG.create("path"),n="path"===t?"d":"points";return i.setAttribute(n,e[n]),i.setAttribute("fill",e.color?e.color:r.options.color),i},_getDefs:function(){return this._defs=this._defs||DG.SVG.create("defs"),this._defs.parentNode||this._container.appendChild(this._defs),this._defs},_updateMarker:function(t){var e=t._map.getZoom(),r=t._map.getBounds(),i=t._latlngs[t._latlngs.length-1],n=e>=DG.Entrance.SHOW_FROM_ZOOM&&r.contains(i)?t._markerId+"-"+e:"";t._path.setAttribute("marker-end","url(#"+n+")")},_removeMarkers:function(t){var e=this._getDefs(),r=t._markers;(e||r)&&(r.forEach(function(t){e.removeChild(t)}),r.length=0)},_refresh:function(){this._container.parentNode.insertBefore(this._container,this._container)},_updateStyle:function(t){var e=t._path,r=t.options;DG.SVG.prototype._updateStyle.call(this,t),e.setAttribute("visibility",r.visibility),t._markers.forEach(function(t){t.setAttribute("fill-opacity",r.opacity)}),this._updateMarker(t)}}),L.Map.include({getArrowRenderer:function(){var t=this._arrowRenderer;return t||(t=this._arrowRenderer=new DG.Entrance.Arrow.SVG),!this.hasLayer(t)&&this.addLayer(t),t}});DG.Entrance.Arrow.SVG.include(L.Browser.vml?{_initMarkers:function(r){r._markers=L.SVG.create("stroke"),this._updateMarker(r),r._container.appendChild(r._markers)},_updateMarker:function(r){var e=r.options.byZoom[r._map.getZoom()];r._markers.endarrow=e&&e.vmlEndArrow?e.vmlEndArrow:"classic"},_removeMarkers:function(r){r._container.removeChild(r._markers)},_updateStyle:function(r){var e=r.options,i=r._container;DG.SVG.prototype._updateStyle.call(this,r),e.visibility&&(i.style.visibility=e.visibility)}}:{});DG.Browser.svg&&DG.Entrance.Arrow.include({getArrowAnimation:function(e){var n={id:"animateArrowPathGeom",attributeName:"d",fill:"freeze",begin:"indefinite"};return n.getValues=this._getAnimationValues(e.length),n.keyTimes=this._getAnimateTiming(e),n.dur=this._getAnimationTime(e.length),n},_getAnimationValues:function(e){return 2===e?this._getShakeAnimationValues:this._getSlideAnimationValues},_getSlideAnimationValues:function(e){var n="",t="",i="",r="M "+e[0].x+" "+e[0].y,l="l -1 0";n=r+" "+l+"; ";for(var a=1;a<e.length;a++){if(i+=e[a].x-e[a-1].x+" "+(e[a].y-e[a-1].y),a===e.length-1){i=e[a].x-e[a-1].x+" "+(e[a].y-e[a-1].y),n+=r+" l "+t+i+";";break}n+=r+" l "+i+"; ",n+=r+" l "+i+" "+l+"; ",i+=" l ",t+=e[a].x-e[a-1].x+" "+(e[a].y-e[a-1].y)+" l "}return n},_getShakeAnimationValues:function(e){var n,t,i=[1,.4,1,.84,1,.94,1],r=e[1].x-e[0].x,l=e[1].y-e[0].y,a=" l "+r+" "+l;return n=e[0].x-r,t=e[0].y-l,i.reduce(function(e,i){return e+" M "+(n+r*i)+" "+(t+l*i)+a+";"},"M "+n+" "+t+a+"; ")},_getPolylineLength:function(e){for(var n=0,t=1;t<e.length;t++)n+=e[t-1].distanceTo(e[t]);return n},_getAnimateTiming:function(e){var n,t,i,r=[0],l=this._getPolylineLength(e);if(2===e.length)n="0; 0.33; 0.495; 0.66; 0.77; 0.88; 0.935; 1";else if(3===e.length)n="0; 0.33; 0.34; 1";else if(4===e.length)n="0; 0.25; 0.26; 0.5; 0.51; 1";else{for(var a=1;a<e.length;a++)i=e[a-1].distanceTo(e[a]),t=i/l,r.push(r[r.length-1]+t),a<e.length-1?r.push(r[r.length-1]):r[r.length-1]=1;n=r.join("; ")}return n},_getAnimationTime:function(e){return 2===e?"0.7s":3===e||4===e?"0.5s":"0.7s"}});DG.Entrance.EventHandler=DG.Handler.extend({initialize:function(e,n){this._map=e,this._entrance=n},addHooks:function(){this._map.on(this._events(),this)},removeHooks:function(){this._map.off(this._events(),this)},_events:function(){return{layeradd:this._removeEntrance,zoomend:this._showOrHideEntrance,projectleave:this._showOrHideEntrance}},_showOrHideEntrance:function(){this._map.getZoom()>=DG.Entrance.SHOW_FROM_ZOOM?this._entrance.show(!1):this._entrance.hide()},_removeEntrance:function(e){(e.layer instanceof DG.Popup||e.layer instanceof DG.Entrance&&e.layer!==this._entrance)&&this._entrance.removeFrom(this._map)}});DG.Map.mergeOptions({geoclicker:!1}),DG.Geoclicker=DG.Handler.extend({clickCount:0,pendingClick:0,timeout:250,initialize:function(i,t){this._map=i,this._controller=new DG.Geoclicker.Controller(i,t),this._fillEventsListeners()},addHooks:function(){this._map.on(this._mapEventsListeners,this),DG.Browser.touch||this._map.poi.enable()},removeHooks:function(){this._map.off(this._mapEventsListeners,this),this._map.poi.disable()},getController:function(){return this._controller},_mapEventsListeners:{langchange:function(){this._controller.reinvokeHandler()},dblclick:function(){clearTimeout(this.pendingClick),this.clickCount=0},popupclose:function(i){this._controller.handlePopupClose(i.popup)}},_fillEventsListeners:function(){this._mapEventsListeners.click=this._mapEventsListeners.poiclick=this._onClick},_onClick:function(i){0===this.clickCount&&(this.clickCount=1,this._singleClick(i))},_setCursor:function(i){this._map.getContainer().style.cursor=i},_singleClick:function(i){var t=this;clearTimeout(this.pendingClick),this.pendingClick=setTimeout(function(){var n=i.target._zoom,e=i.latlng;t._controller.handleClick(e,n,{poiId:i.poi?i.poi.linked.id:null}),t.clickCount=0},this.timeout)}}),DG.Map.addInitHook("addHandler","geoclicker",DG.Geoclicker);DG.Geoclicker.clampHelper=function(e,n){var i,t,l,d,p,a,c,r,s,o=document.createElement.bind(document),m=document.createTextNode.bind(document);if(i=o("span"),function(e){e.position="absolute",e.whiteSpace="pre",e.visibility="hidden",e.margin="0 18px 8px 0"}(i.style),e.ownerDocument&&e.ownerDocument===document){for(d=a=0,p=1,s=!1,l=e.clientWidth,t=(e.textContent||e.innerText).replace(/\n/g," ");null!==e.firstChild;)e.removeChild(e.firstChild);e.appendChild(i),t.replace(/ |-/g,function(h,u){p!==n&&(i.appendChild(m(t.substr(d,u-d))),l<i.clientWidth?(s?(r=t.substr(d,u+1-d),d=u+1):(r=t.substr(d,a-d),d=a),c=o("span"),c.appendChild(m(r)),e.appendChild(c),c.className="clamped-line",s=!0,p++):s=!1,a=u+1,i.removeChild(i.firstChild))}),e.removeChild(i),c=o("span"),c.className="clamped-line clamped-line-last",c.appendChild(m(t.substr(d))),e.appendChild(c)}};DG.Geoclicker.Provider={};DG.Geoclicker.Provider.CatalogApi=DG.Class.extend({options:{urlGeo:"http://catalog.api.2gis.ru/2.0/search",urlDetails:"http://catalog.api.2gis.ru/2.0/details",data:{key:"ruxlih0718"},geoFields:"data.geometry.selection,data.attributes.filials,data.attributes.sight",firmInfoFields:"data.reviews,data.geo.id,data.geo.entrances,data.photos",timeoutMs:5e3},initialize:function(t){this._map=t},getLocations:function(t){var e=t.zoom,i=t.latlng,o=t.callback,s=t.beforeRequest||function(){},n=this.getTypesByZoom(e),a=i.lng+","+i.lat;return n?(s(),this.geoSearch(a,n,e).then(DG.bind(function(t){o(this._filterResponse(t,n))},this)),void 0):(o({error:"no type"}),void 0)},firmsInHouse:function(t,e){e=e||{};var i=DG.extend(this.options.data,{type:"filial",house:t,page:e.page||1});return this._performRequest(i,this.options.urlGeo)},getFirmInfo:function(t){return this._performRequest({type:"filial",id:t,fields:this.options.firmInfoFields},this.options.urlDetails)},geoSearch:function(t,e,i){var o={point:t,geo_type:e,zoom_level:i,type:"geo",fields:this.options.geoFields};return this._performRequest(o,this.options.urlGeo)},cancelLastRequest:function(){this._lastRequest&&this._lastRequest.abort()},getTypesByZoom:function(t){var e={settlement:8,city:8,division:11,district:12,station:12,metro:12,station_platform:12,street:14,house:14,place:15,poi:15,sight:17},i=[];return Object.keys(e).forEach(function(o){t>=e[o]&&i.push(o)}),i.length?i.join(","):null},_performRequest:function(t,e){var i,o=this.options.data,s=DG.extend({key:o.key},t),n="get";return this.cancelLastRequest(),DG.ajax.corsSupport||(n=s.output="jsonp"),this._lastRequest=DG.ajax(e,{type:n,data:s,timeout:this.options.timeoutMs}),i=this._lastRequest.then(null,function(){return!1})},_filterResponse:function(t,e){var i,o,s,n,a={};if(this._isNotFound(t))return!1;for(n=t.result.data,i=n.length-1;i>=0;i--)o=n[i],e&&-1===e.indexOf(o.geo_type)||(a[o.geo_type]=o,s=!0);return s?a:!1},_isNotFound:function(t){return!(t&&!t.error_code&&t.result&&t.result.data.length)}});DG.Geoclicker.Handler={};DG.Geoclicker.Handler.Default=DG.Class.extend({includes:DG.Locale,statics:{Dictionary:{}},_eventHandlers:{},initialize:function(e,t,n){this._controller=e,this._view=t,this._map=n},handle:function(){return DG.when({tmpl:"popupHeader",data:{title:this.t("we_have_not")}})},_removeEventHandler:function(e){var t,n,r=this._eventHandlers;for(n in r)r.hasOwnProperty(n)&&(t=r[n],n===e&&(DG.DomEvent.off(t.el,t.event,t.handler),delete r[n]))},_addEventHandler:function(e,t,n,r){DG.DomEvent.on(t,n,r),this._eventHandlers[e]={el:t,event:n,handler:r}},_clearEventHandlers:function(){var e,t=this._eventHandlers;for(e in t)t.hasOwnProperty(e)&&DG.DomEvent.off(t[e].el,t[e].event,t[e].handler);this._eventHandlers={}},_getDirectionsUrl:function(e){return DG.Util.template("http://2gis.ru/#!/{code}/transTo/{name}/transToCr/{point}/routeSearchShow/true",{code:this._map.projectDetector.getProject().code,name:encodeURIComponent(e),point:"POINT("+this._popup._latlng.lng+" "+this._popup._latlng.lat+")"})}}),DG.Geoclicker.Handler.HandlerExample=DG.Geoclicker.Handler.Default.extend({handle:function(e,t){return DG.when({tmpl:t+":<br/>"+e[t].id})}});DG.Geoclicker.Handler.CityArea=DG.Geoclicker.Handler.Default.extend({_polylineStyleDefault:{fillColor:"#ff9387",color:"#ff9387",clickable:!1,noClip:!0,opacity:1},_polylineStyles:{11:{fillOpacity:.18,weight:1},12:{fillOpacity:.12,weight:1},13:{fillOpacity:.08,weight:2},18:{fillOpacity:0,weight:3}},handle:function(t,e){return t[e]?(!this._stylesInited&&this._initStyles(),this._popup=this._view.getPopup(),this._geometryZoomStyle=this._getPolyStyleNum(),this._geometry=DG.Wkt.geoJsonLayer(t[e].geometry.selection,{style:this._polylineStyles[this._geometryZoomStyle]}).addTo(this._map),this._map.on("zoomend",this._updateGeometry,this).once("popupclose",this._clearPopup,this),DG.when(this._fillCityAreaObject(t,e))):!1},_fillCityAreaObject:function(t,e){var i,l={name:this.t("noname"),address:"",purpose:this.t(e),type:e};return i=t[Object.keys(t).filter(function(t){return t!==e&&"extra"!==t})[0]],i&&(l.address=(i.attributes&&i.attributes.abbreviation?i.attributes.abbreviation+" ":"")+i.name),t[e].short_name&&(l.name=t[e].short_name),{tmpl:"cityarea",data:l,header:this._view.render({tmpl:"popupHeader",data:{title:l.name}})}},_initStyles:function(){this._stylesInited=!0,Object.keys(this._polylineStyles).forEach(function(t){DG.extend(this._polylineStyles[t],this._polylineStyleDefault)},this)},_getPolyStyleNum:function(){var t=this._map.getZoom();return Object.keys(this._polylineStyles).filter(function(e){return e>=t})[0]||!1},_updateGeometry:function(){var t=this._getPolyStyleNum();t&&t!==this._geometryZoomStyle&&(this._geometryZoomStyle=t,this._geometry.setStyle(this._polylineStyles[t]))},_clearPopup:function(){this._popup.clear("header"),this._map.removeLayer(this._geometry).off("zoomend",this._updateGeometry,this)}});DG.Geoclicker.Handler.House=DG.Geoclicker.Handler.Default.extend({_firmsOnPage:20,_scrollThrottleInterval:400,_scrollHeightReserve:60,options:{showBooklet:!0,showPhotos:!0},initialize:function(i,t,e,s){DG.setOptions(this,s),this._controller=i,this._view=t,this._map=e},handle:function(i){return i.house?(this._page=1,this._houseObject=null,this._firmList=null,this._firmListObject=null,this.firmCard=null,this._firmCardObject=null,this._onScroll=!1,this._isFirmlistOpen=!1,this._id=i.house.id,this._totalPages=1,this._api=this._controller.getCatalogApi(),this._popup=this._view.getPopup(),this._initedPopupClose=!1,this._directionsUrl=this._getDirectionsUrl(i.house.name),this._firmListLoader=this._view.initLoader(!0),this._defaultFirm=i.extra&&i.extra.poiId?i.extra.poiId:null,this._defaultFirm?this._firmCardObject=this._fillFirmCardObject():this._houseObject=this._fillHouseObject(i.house),DG.when(this._defaultFirm?this._firmCardObject:this._houseObject)):!1},_firmCardSetup:function(){return{render:this._view._templates,lang:this._map.getLang(),ajax:DG.bind(this._api.getFirmInfo,this._api),timezoneOffset:this._controller.getMap().projectDetector.getProject().timeOffset,map:this._map,isMobile:DG.Browser.mobile,showEntrance:DG.Entrance,gotoUrl:this._directionsUrl,onFirmReady:DG.bind(this._onFirmReady,this),onToggle:DG.bind(this._popup.resize,this._popup),showBooklet:this.options.showBooklet,showPhotos:this.options.showPhotos}},_onFirmReady:function(i){var t=this;i.afterRender=function(){var i=t._popup._popupStructure.header.firstChild;DG.Browser.ielt9||i.offsetHeight>72&&(DG.DomUtil.addClass(i,"dg-popup-header-title__firmcard__teaser"),DG.Browser.webkit||DG.Geoclicker.clampHelper(i,3))},this._clearAndRenderPopup(i)},_fillFirmCardObject:function(){var i,t=this._firmCardSetup();return this.firmCard=new FirmCard(this._defaultFirm,t),i.getContainer()},_initShortFirmList:function(i){var t,e=this._firmCardSetup();return DG.extend(e,{backBtn:DG.bind(this._showHousePopup,this),onFirmClick:DG.bind(this._onFirmListClick,this),pasteLoader:DG.bind(this._pasteLoader,this)}),t=new FirmCard.List(i,{firmCard:e,firmlistItemTmpl:"firmlistItem"}),t.renderList()},_fillFirmListObject:function(i){var t=this;return{tmpl:i,header:this._header,footer:this._view.render({tmpl:"popupFooterBtns",data:{btns:[{name:"firmList-back",label:this.t("back_button"),icon:!0}]}}),afterRender:function(){t._initShowLess(),t._initPopupClose(),t._firmListLoader&&this.tmpl.parentNode.appendChild(t._firmListLoader)}}},_initFirmList:function(i){var t=i.result.data,e=this._firmCardSetup();DG.extend(e,{backBtn:DG.bind(function(){this._popup.on("scroll",this._onScroll),this._showListPopup()},this),onFirmClick:DG.bind(this._onFirmListClick,this),pasteLoader:DG.bind(this._pasteLoader,this)}),this._firmList=new FirmCard.List(t,{firmCard:e,firmlistItemTmpl:"firmlistItem",onListReady:DG.bind(this._renderFirmList,this)}),this._firmListObject=this._fillFirmListObject(this._firmList.renderList()),this._clearAndRenderPopup(this._firmListObject)},_pasteLoader:function(){var i=DG.DomUtil.create("div","loader-wrapper"),t=this._view.initLoader();i.appendChild(t),i.style.height=this._popup._contentNode.offsetHeight-1+"px",i.style.width=this._popup._contentNode.offsetWidth+"px",this._clearAndRenderPopup({tmpl:i})},_onFirmListClick:function(i){this._popup.off("scroll",this._onScroll),DG.DomEvent.stop(i)},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._onPopupClose,this)),this._initedPopupClose=!0)},_onPopupClose:function(){this._initedPopupClose=!1,this._firmList&&(this._firmList.clearList(),this._firmList=null,this._popup.off("scroll",this._onScroll)),this._firmListLoader=null,this._page=1,this._popup.clear(),this._clearEventHandlers()},_initShowMore:function(){var i=this._popup.findElement("#popup-btn-all");i&&this._addEventHandler("DgShowMoreClick",i,"click",DG.bind(this._showListPopup,this))},_showListPopup:function(){var i=this._firmListObject;this._pasteLoader(),i?this._clearAndRenderPopup(i):i=this._api.firmsInHouse(this._id).then(DG.bind(this._initFirmList,this))},_initShowLess:function(){var i=this._popup.findElement("#popup-btn-firmList-back");i&&this._addEventHandler("DgShowLessClick",i,"click",DG.bind(this._showHousePopup,this))},_showHousePopup:function(){this._clearAndRenderPopup(this._houseObject)},_clearAndRenderPopup:function(i){this._clearEventHandlers(),this._popup.clear("header","footer"),this._view.renderPopup(i)},_renderFirmList:function(){this._isFirmlistOpen||(this._popup.resize(),this._isFirmlistOpen=!0,this._onScroll||(this._onScroll=DG.Util.throttle(this._handlePopupScroll,this._scrollThrottleInterval,this)),this._popup.on("scroll",this._onScroll)),1===this._totalPages&&this._firmListLoader&&this._view.hideLoader(this._firmListLoader)},_appendFirmList:function(i){this._firmList.addFirms(i.result.data),this._popup._updateScrollPosition()},_handlePopupScroll:function(i){var t=i.originalEvent.target||i.target._scroller;this._totalPages<=1||t&&t.scrollHeight<=t.scrollTop+t.offsetHeight+this._scrollHeightReserve&&this._handlePaging()},_handlePaging:function(){this._page++,this._totalPages&&this._page<=this._totalPages&&this._api.firmsInHouse(this._id,{page:this._page}).then(DG.bind(this._appendFirmList,this)),this._page===this._totalPages&&(this._firmListLoader&&this._view.hideLoader(this._firmListLoader),this._popup.off("scroll",this._onScroll))}});DG.Geoclicker.Handler.House.include({_fillBody:function(i){var t=i.attributes,e={},l=DG.DomUtil.create("div","building-callout__body"),n=i.attributes.filials;return t.city&&(e.address=(t.district?this.t("district")+" "+t.district+", ":"")+t.city+(t.postal_code?", "+t.postal_code:"")),i.name&&t.building_name&&(e.headAddress=i.name.split(", ").slice(1).join(", ")),t.building_description&&(e.purpose=t.building_description+(t.floors_count?", "+this.t("n_floors",t.floors_count):"")),t.filials_count>0&&(this._totalPages=Math.ceil(t.filials_count/this._firmsOnPage)),l.innerHTML=this._view.render({tmpl:"house",data:e}),n&&l.appendChild(this._initShortFirmList(n.popular)),l},_fillHeader:function(i){var t=i.attributes,e={};return e.title=t.building_name?t.building_name:i.name?i.name.split(", ").slice(1).join(", "):t.building_description,this._header=this._view.render({tmpl:"popupHeader",data:e}),this._header},_fillFooter:function(i){var t=i.attributes,e=[],l=!1;return t.filials_count>0&&(t.filials&&t.filials.popular?t.filials_count>t.filials.popular.length&&(l=!0):l=!0),l&&e.push(this._getShowAllData(t.filials_count)),this._view.render({tmpl:"popupFooterBtns",data:{btns:e}})},_getShowAllData:function(i){return{name:"all",label:this.t("show_organization_in_building",i)}},_fillHouseObject:function(i){var t=this;return{header:this._fillHeader(i),tmpl:this._fillBody(i),footer:this._fillFooter(i),afterRender:function(){t._initShowMore(),t._initPopupClose()}}}});DG.Geoclicker.Handler.Sight=DG.Geoclicker.Handler.Default.extend({handle:function(i){return i.sight?(this._popup=this._view.getPopup(),this._initedPopupClose=!1,DG.when(this._fillSightObject(i))):!1},_fillSightObject:function(i){var e,t=i.sight.attributes,n={description:t.info.description},o=this,s={btns:[{name:"goto",label:this.t("go_to"),icon:!0}]};return n.buildingName=t.building_name?t.building_name:i.sight.short_name,t.sight_description&&(n.purpose=t.sight_description),null===n.buildingName&&(n.buildingName=n.purpose,n.purpose=this.t("place")),n.drillDown=Object.keys(i).filter(function(i){return-1===["sight","place","extra"].indexOf(i)}).map(function(e){return i[e]}).reduce(function(i,t){return t.attributes&&t.attributes.abbreviation&&(e=t.attributes.abbreviation+" "),t.name?e+t.name:void 0},""),this._checkDescFieldHeight(n.description)&&(n.showMoreText=this.t("show_more_about_sight")),s.btns[0].href=this._getDirectionsUrl(n.buildingName),{tmpl:"sight",data:n,header:this._view.render({tmpl:"popupHeader",data:{title:n.buildingName}}),afterRender:function(){o._needShowMore&&o._initShowMore(),o._initPopupClose()}}},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._clearPopup,this)),this._initedPopupClose=!0)},_clearPopup:function(){this._initedPopupClose=!1,this._popup.clear(),this._clearEventHandlers()},_showMoreText:function(){this._desc.style.maxHeight="100%",this._link.parentNode.removeChild(this._link),this._popup.resize()},_initShowMore:function(){this._link=this._popup.findElement("#dg-showmoresight"),this._desc=this._popup.findElement(".dg-map-geoclicker-sight-description"),this._link&&this._desc&&this._addEventHandler("DgShowMoreClick",this._link,"click",DG.bind(this._showMoreText,this))},_checkDescFieldHeight:function(i){var e,t=DG.DomUtil.create("div","");return t.style.visibility="hidden",t.innerHTML=i,this._popup._contentNode.appendChild(t),e=t.offsetHeight,this._popup._contentNode.removeChild(t),this._needShowMore=e>40,this._needShowMore}});DG.Geoclicker.View=DG.Class.extend({initialize:function(e,t){this._map=e,this._popup=DG.popup({maxHeight:300,minHeight:50,maxWidth:385,minWidth:385}),this._templates=DG.dust(JSON.parse('{"cityarea":"(function(){dust.register(\\"cityarea\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-map-geoclicker-purpose dg-map-geoclicker-purpose__\\").reference(ctx.get([\\"type\\"], false),ctx,\\"h\\").write(\\"\\\\\\">\\").reference(ctx.get([\\"purpose\\"], false),ctx,\\"h\\").write(\\"</div><div class=\\\\\\"dg-map-geoclicker-drilldown\\\\\\">\\").reference(ctx.get([\\"address\\"], false),ctx,\\"h\\").write(\\"</div>\\");}return body_0;})();","firmCardAddr":"(function(){dust.register(\\"firmCardAddr\\",body_0);function body_0(chk,ctx){return chk.write(\\"<address class=\\\\\\"firm-card__address\\\\\\">\\").section(ctx.get([\\"data\\"], false),ctx,{\\"block\\":body_1},null).write(\\"</address>\\");}function body_1(chk,ctx){return chk.reference(ctx.get([\\"address\\"], false),ctx,\\"h\\").section(ctx.get([\\"comment\\"], false),ctx,{\\"block\\":body_2},null);}function body_2(chk,ctx){return chk.write(\\"<span class=\\\\\\"firm-card__comment\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</span>\\");}return body_0;})();","firmCardContacts":"(function(){dust.register(\\"firmCardContacts\\",body_0);function body_0(chk,ctx){return chk.section(ctx.get([\\"groups\\"], false),ctx,{\\"block\\":body_1},null);}function body_1(chk,ctx){return chk.section(ctx.get([\\"contacts\\"], false),ctx,{\\"block\\":body_2},null);}function body_2(chk,ctx){return chk.helper(\\"select\\",ctx,{\\"block\\":body_3},{\\"key\\":ctx.get([\\"type\\"], false),\\"type\\":\\"string\\"});}function body_3(chk,ctx){return chk.helper(\\"eq\\",ctx,{\\"block\\":body_4},{\\"value\\":\\"phone\\",\\"type\\":\\"string\\"}).helper(\\"eq\\",ctx,{\\"block\\":body_6},{\\"value\\":\\"fax\\",\\"type\\":\\"string\\"}).helper(\\"eq\\",ctx,{\\"block\\":body_8},{\\"value\\":\\"website\\",\\"type\\":\\"string\\"}).helper(\\"eq\\",ctx,{\\"block\\":body_9},{\\"value\\":\\"email\\",\\"type\\":\\"string\\"});}function body_4(chk,ctx){return chk.write(\\"<div class=\\\\\\"firm-card__phone\\\\\\"><span class=\\\\\\"firm-card__phone-num\\\\\\">\\").reference(ctx.get([\\"value\\"], false),ctx,\\"h\\").section(ctx.get([\\"comment\\"], false),ctx,{\\"block\\":body_5},null).write(\\"</span></div>\\");}function body_5(chk,ctx){return chk.write(\\"<span class=\\\\\\"firm-card__comment\\\\\\" title=\\\\\\"\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"\\\\\\">&ndash;&nbsp;&nbsp;\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</span>\\");}function body_6(chk,ctx){return chk.write(\\"<div class=\\\\\\"firm-card__phone\\\\\\"><span class=\\\\\\"firm-card__phone-num\\\\\\">\\").reference(ctx.get([\\"value\\"], false),ctx,\\"h\\").section(ctx.get([\\"comment\\"], false),ctx,{\\"block\\":body_7},null).write(\\"</span></div>\\");}function body_7(chk,ctx){return chk.write(\\"<span class=\\\\\\"firm-card__comment\\\\\\" title=\\\\\\"\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"\\\\\\">&ndash;&nbsp;&nbsp;\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</span>\\");}function body_8(chk,ctx){return chk.write(\\"<div class=\\\\\\"firm-card__link firm-card__site\\\\\\"><a href=\\\\\\"\\").reference(ctx.get([\\"value\\"], false),ctx,\\"h\\").write(\\"\\\\\\" target=\\\\\\"_blank\\\\\\" class=\\\\\\"link_scheme_dark firm-card__sitelink\\\\\\">\\").reference(ctx.get([\\"alias\\"], false),ctx,\\"h\\").write(\\"</a></div>\\");}function body_9(chk,ctx){return chk.write(\\"<div class=\\\\\\"firm-card__link firm-card__email\\\\\\"><a href=\\\\\\"mailto: \\").reference(ctx.get([\\"value\\"], false),ctx,\\"h\\").write(\\"\\\\\\">\\").reference(ctx.get([\\"value\\"], false),ctx,\\"h\\").write(\\"</a></div>\\");}return body_0;})();","firmCardHeader":"(function(){dust.register(\\"firmCardHeader\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-popup-header-title dg-popup-header-title__firmcard\\\\\\" title=\\\\\\"\\").reference(ctx.get([\\"firmName\\"], false),ctx,\\"h\\").write(\\"\\\\\\">\\").reference(ctx.get([\\"firmName\\"], false),ctx,\\"h\\").write(\\"</div>\\").exists(ctx.get([\\"links\\"], false),ctx,{\\"block\\":body_1},null);}function body_1(chk,ctx){return chk.write(\\"<div class=\\\\\\"popup_header_links\\\\\\">\\").section(ctx.get([\\"links\\"], false),ctx,{\\"block\\":body_2},null).write(\\"</div>\\");}function body_2(chk,ctx){return chk.helper(\\"eq\\",ctx,{\\"else\\":body_3,\\"block\\":body_6},{\\"key\\":body_8,\\"value\\":\\"flamp_stars\\",\\"type\\":\\"string\\"});}function body_3(chk,ctx){return chk.write(\\"<a id=\\\\\\"popup-link-\\").reference(ctx.get([\\"name\\"], false),ctx,\\"h\\").write(\\"\\\\\\" class=\\\\\\"popup-header-link popup-link\\\\\\"\\").exists(ctx.get([\\"href\\"], false),ctx,{\\"else\\":body_4,\\"block\\":body_5},null).write(\\">\\").reference(ctx.get([\\"label\\"], false),ctx,\\"h\\").write(\\"</a>\\");}function body_4(chk,ctx){return chk.write(\\"href=\\\\\\"javascript:void(0)\\\\\\"\\");}function body_5(chk,ctx){return chk.write(\\"href=\\").reference(ctx.get([\\"href\\"], false),ctx,\\"h\\").write(\\" target=\\\\\\"_blank\\\\\\"\\");}function body_6(chk,ctx){return chk.write(\\"<div id=\\\\\\"popup-link-\\").reference(ctx.get([\\"name\\"], false),ctx,\\"h\\").write(\\"\\\\\\" class=\\\\\\"popup-link\\\\\\"><div\\").section(ctx.get([\\"width\\"], false),ctx,{\\"block\\":body_7},null).write(\\"></div></div>\\");}function body_7(chk,ctx){return chk.write(\\" style=\\\\\\"width: \\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"%;\\\\\\" \\");}function body_8(chk,ctx){return chk.reference(ctx.get([\\"name\\"], false),ctx,\\"h\\");}return body_0;})();","firmCardRubric":"(function(){dust.register(\\"firmCardRubric\\",body_0);function body_0(chk,ctx){return chk.section(ctx.get([\\"rubrics\\"], false),ctx,{\\"block\\":body_1},null);}function body_1(chk,ctx){return chk.write(\\"<section class=\\\\\\"firm-card__rubrics\\\\\\">\\").exists(ctx.get([\\"primary\\"], false),ctx,{\\"block\\":body_2},null).exists(ctx.get([\\"additional\\"], false),ctx,{\\"block\\":body_4},null).write(\\"</section>\\");}function body_2(chk,ctx){return chk.write(\\"<ul class=\\\\\\"firm-card__rubrics-list firm-card__rubrics_primary\\\\\\">\\").section(ctx.get([\\"primary\\"], false),ctx,{\\"block\\":body_3},null).write(\\"</ul>\\");}function body_3(chk,ctx){return chk.write(\\"<li class=\\\\\\"firm-card__rubrics-list-item\\\\\\">\\").reference(ctx.get([\\"name\\"], false),ctx,\\"h\\").write(\\"</li>\\");}function body_4(chk,ctx){return chk.write(\\"<ul class=\\\\\\"firm-card__rubrics-list firm-card__rubrics_additional\\\\\\">\\").section(ctx.get([\\"additional\\"], false),ctx,{\\"block\\":body_5},null).write(\\"</ul>\\");}function body_5(chk,ctx){return chk.write(\\"<li class=\\\\\\"firm-card__rubrics-list-item\\\\\\">\\").reference(ctx.get([\\"name\\"], false),ctx,\\"h\\").write(\\"</li>\\");}return body_0;})();","firmCardSchedule":"(function(){dust.register(\\"firmCardSchedule\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"firm-card__schedule\\\\\\">\\").exists(ctx.get([\\"schedule\\"], false),ctx,{\\"block\\":body_1},null).write(\\"</div>\\");}function body_1(chk,ctx){return chk.exists(ctx.getPath(false, [\\"forecast\\",\\"today\\"]),ctx,{\\"block\\":body_2},null).section(ctx.getPath(false, [\\"forecast\\",\\"now\\"]),ctx,{\\"block\\":body_9},null).notexists(ctx.getPath(false, [\\"schedule\\",\\"everyday\\"]),ctx,{\\"block\\":body_11},null);}function body_2(chk,ctx){return chk.write(\\"<div class=\\\\\\"schedule__today schedule_open_\\").exists(ctx.getPath(false, [\\"forecast\\",\\"open\\"]),ctx,{\\"else\\":body_3,\\"block\\":body_4},null).exists(ctx.getPath(false, [\\"schedule\\",\\"everyday\\"]),ctx,{\\"block\\":body_5},null).write(\\"\\\\\\">\\").reference(ctx.getPath(false, [\\"forecast\\",\\"today\\",\\"text\\"]),ctx,\\"h\\").write(\\"&nbsp;\\").exists(ctx.getPath(false, [\\"forecast\\",\\"today\\",\\"from\\"]),ctx,{\\"block\\":body_6},null).exists(ctx.getPath(false, [\\"schedule\\",\\"lunch\\"]),ctx,{\\"block\\":body_7},null).write(\\"</div>\\");}function body_3(chk,ctx){return chk.write(\\"false\\");}function body_4(chk,ctx){return chk.write(\\"true\\");}function body_5(chk,ctx){return chk.write(\\" schedule__no-table\\");}function body_6(chk,ctx){return chk.reference(ctx.getPath(false, [\\"forecast\\",\\"today\\",\\"from\\"]),ctx,\\"h\\").write(\\"&ndash;\\").reference(ctx.getPath(false, [\\"forecast\\",\\"today\\",\\"to\\"]),ctx,\\"h\\");}function body_7(chk,ctx){return chk.write(\\",&nbsp;\\").reference(ctx.getPath(false, [\\"forecast\\",\\"today\\",\\"lunchStr\\"]),ctx,\\"h\\").write(\\"&nbsp;\\").section(ctx.getPath(false, [\\"schedule\\",\\"lunch\\"]),ctx,{\\"block\\":body_8},null);}function body_8(chk,ctx){return chk.reference(ctx.get([\\"from\\"], false),ctx,\\"h\\").write(\\"&ndash;\\").reference(ctx.get([\\"to\\"], false),ctx,\\"h\\");}function body_9(chk,ctx){return chk.write(\\"<div class=\\\\\\"schedule__now\\\\\\"><span class=\\\\\\"schedule__now-text\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").section(ctx.getPath(false, [\\"schedule\\",\\"comment\\"]),ctx,{\\"block\\":body_10},null).write(\\"</span></div>\\");}function body_10(chk,ctx){return chk.write(\\", \\").reference(ctx.getPath(true, []),ctx,\\"h\\");}function body_11(chk,ctx){return chk.exists(ctx.getPath(false, [\\"schedule\\",\\"week\\"]),ctx,{\\"block\\":body_12},null);}function body_12(chk,ctx){return chk.exists(ctx.getPath(false, [\\"schedule\\",\\"week\\",\\"evently\\"]),ctx,{\\"block\\":body_13},null).exists(ctx.getPath(false, [\\"schedule\\",\\"week\\",\\"table\\"]),ctx,{\\"block\\":body_21},null);}function body_13(chk,ctx){return chk.write(\\"<div class=\\\\\\"schedule__table\\\\\\">\\").section(ctx.getPath(false, [\\"schedule\\",\\"week\\",\\"evently\\"]),ctx,{\\"block\\":body_14},null).write(\\"</div>\\");}function body_14(chk,ctx){return chk.write(\\"<div class=\\\\\\"schedule__string\\\\\\">\\").exists(ctx.get([\\"alltime\\"], false),ctx,{\\"block\\":body_15},null).exists(ctx.get([\\"everyday\\"], false),ctx,{\\"else\\":body_16,\\"block\\":body_17},null).exists(ctx.get([\\"holiday\\"], false),ctx,{\\"else\\":body_18,\\"block\\":body_20},null).write(\\"</div>\\");}function body_15(chk,ctx){return chk.reference(ctx.get([\\"alltimeStr\\"], false),ctx,\\"h\\");}function body_16(chk,ctx){return chk.reference(ctx.get([\\"dayList\\"], false),ctx,\\"h\\");}function body_17(chk,ctx){return chk.reference(ctx.getPath(false, [\\"forecast\\",\\"today\\",\\"text\\"]),ctx,\\"h\\");}function body_18(chk,ctx){return chk.write(\\"&mdash;<span class=\\\\\\"schedule__string-time\\\\\\">&nbsp;\\").reference(ctx.get([\\"from\\"], false),ctx,\\"h\\").write(\\"&ndash;\\").reference(ctx.get([\\"to\\"], false),ctx,\\"h\\").write(\\"</span>\\").section(ctx.get([\\"lunch\\"], false),ctx,{\\"block\\":body_19},null);}function body_19(chk,ctx){return chk.write(\\"<p>\\").reference(ctx.get([\\"lunchStr\\"], false),ctx,\\"h\\").write(\\"&mdash;<span class=\\\\\\"schedule__string-time\\\\\\">\\").reference(ctx.get([\\"from\\"], false),ctx,\\"h\\").write(\\"&ndash;\\").reference(ctx.get([\\"to\\"], false),ctx,\\"h\\").write(\\"</span></p>\\");}function body_20(chk,ctx){return chk.write(\\"&mdash;<span class=\\\\\\"schedule__string-time\\\\\\">&nbsp;\\").reference(ctx.get([\\"holidayStr\\"], false),ctx,\\"h\\").write(\\"</span>\\");}function body_21(chk,ctx){return chk.write(\\"<div><div class=\\\\\\"schedule__table\\\\\\"><div class=\\\\\\"schedule__tc schedule__tc_pre\\\\\\"><div class=\\\\\\"schedule__day-name\\\\\\">&nbsp;</div><div class=\\\\\\"schedule__table-clock schedule__td\\\\\\"></div>\\").exists(ctx.getPath(false, [\\"schedule\\",\\"week\\",\\"hasLunch\\"]),ctx,{\\"block\\":body_22},null).write(\\"</div>\\").section(ctx.getPath(false, [\\"schedule\\",\\"week\\",\\"table\\"]),ctx,{\\"block\\":body_23},null).write(\\"</div>  </div>\\");}function body_22(chk,ctx){return chk.write(\\"<div class=\\\\\\"schedule__table-lunch schedule__td\\\\\\"></div>\\");}function body_23(chk,ctx){return chk.write(\\"<div class=\\\\\\"schedule__tc\\").exists(ctx.get([\\"active\\"], false),ctx,{\\"block\\":body_24},null).write(\\"\\\\\\"><div class=\\\\\\"schedule__day-name\\\\\\">\\").reference(ctx.get([\\"key\\"], false),ctx,\\"h\\").write(\\"</div><div class=\\\\\\"schedule__td\\\\\\">\\").exists(ctx.get([\\"from\\"], false),ctx,{\\"else\\":body_25,\\"block\\":body_26},null).write(\\"</div>\\").section(ctx.get([\\"lunch\\"], false),ctx,{\\"block\\":body_27},null).write(\\"</div> \\");}function body_24(chk,ctx){return chk.write(\\" schedule__tc_active_true\\");}function body_25(chk,ctx){return chk.write(\\"&ndash;\\");}function body_26(chk,ctx){return chk.reference(ctx.get([\\"from\\"], false),ctx,\\"h\\").write(\\" \\").reference(ctx.get([\\"to\\"], false),ctx,\\"h\\");}function body_27(chk,ctx){return chk.write(\\"<div class=\\\\\\"schedule__td\\\\\\">\\").exists(ctx.get([\\"from\\"], false),ctx,{\\"else\\":body_28,\\"block\\":body_29},null).write(\\"</div>\\");}function body_28(chk,ctx){return chk.write(\\"&ndash;\\");}function body_29(chk,ctx){return chk.reference(ctx.get([\\"from\\"], false),ctx,\\"h\\").write(\\" \\").reference(ctx.get([\\"to\\"], false),ctx,\\"h\\");}return body_0;})();","firmlistItem":"(function(){dust.register(\\"firmlistItem\\",body_0);function body_0(chk,ctx){return chk.write(\\"<a id=\\\\\\"\\").reference(ctx.getPath(false, [\\"firm\\",\\"id\\"]),ctx,\\"h\\").write(\\"\\\\\\" class=\\\\\\"popup-link\\\\\\" href=\\\\\\"#\\\\\\">\\").reference(ctx.getPath(false, [\\"firm\\",\\"name\\"]),ctx,\\"h\\").write(\\"</a>\\");}return body_0;})();","frimCardPayments":"(function(){dust.register(\\"frimCardPayments\\",body_0);function body_0(chk,ctx){return chk.exists(ctx.get([\\"payments\\"], false),ctx,{\\"block\\":body_1},null);}function body_1(chk,ctx){return chk.write(\\"<section class=\\\\\\"firm-card__aa\\\\\\"><ul class=\\\\\\"firm-card__aa-list\\\\\\">\\").section(ctx.get([\\"payments\\"], false),ctx,{\\"block\\":body_2},null).write(\\"</ul></section>\\");}function body_2(chk,ctx){return chk.helper(\\"eq\\",ctx,{\\"block\\":body_3},{\\"key\\":body_5,\\"value\\":\\"payment_type\\",\\"type\\":\\"string\\"});}function body_3(chk,ctx){return chk.section(ctx.get([\\"label\\"], false),ctx,{\\"block\\":body_4},null);}function body_4(chk,ctx){return chk.write(\\"<li class=\\\\\\"firm-card__aa-list-item\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</li>\\");}function body_5(chk,ctx){return chk.reference(ctx.get([\\"name\\"], false),ctx,\\"h\\");}return body_0;})();","house":"(function(){dust.register(\\"house\\",body_0);function body_0(chk,ctx){return chk.section(ctx.get([\\"headAddress\\"], false),ctx,{\\"block\\":body_1},null).section(ctx.get([\\"address\\"], false),ctx,{\\"block\\":body_2},null).write(\\"<div class=\\\\\\"dg-map-geoclicker-purpose\\\\\\">\\").reference(ctx.get([\\"purpose\\"], false),ctx,\\"h\\").write(\\"</div><div class=\\\\\\"dg-map-geoclicker-elevation\\\\\\">\\").reference(ctx.get([\\"elevation\\"], false),ctx,\\"h\\").write(\\"</div>\\");}function body_1(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-map-geoclicker-address-header\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</div>\\");}function body_2(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-map-geoclicker-drilldown\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</div>\\");}return body_0;})();","loader":"(function(){dust.register(\\"loader\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"preloader preloader_scheme_regular preloader_animation_\\").exists(ctx.get([\\"anim\\"], false),ctx,{\\"else\\":body_1,\\"block\\":body_2},null).exists(ctx.get([\\"small\\"], false),ctx,{\\"block\\":body_3},null).write(\\"\\\\\\"></div>\\");}function body_1(chk,ctx){return chk.write(\\"false\\");}function body_2(chk,ctx){return chk.write(\\"true\\");}function body_3(chk,ctx){return chk.write(\\" preloader_small\\");}return body_0;})();","popupFooter":"(function(){dust.register(\\"popupFooter\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"popup_footer_title\\\\\\"><a id=\\\\\\"dg-showlesshouse\\\\\\" href=\\\\\\"javascript:void(0)\\\\\\">\\").reference(ctx.get([\\"hideFirmsText\\"], false),ctx,\\"h\\").write(\\"</a></div>\\");}return body_0;})();","popupFooterBtns":"(function(){dust.register(\\"popupFooterBtns\\",body_0);function body_0(chk,ctx){return chk.exists(ctx.get([\\"btns\\"], false),ctx,{\\"block\\":body_1},null);}function body_1(chk,ctx){return chk.write(\\"<footer class=\\\\\\"popup_footer_btns\\\\\\">\\").section(ctx.get([\\"btns\\"], false),ctx,{\\"block\\":body_2},null).write(\\"</footer>\\");}function body_2(chk,ctx){return chk.write(\\"<div class=\\\\\\"popup_footer_btn-wrapper\\\\\\"><a id=\\\\\\"popup-btn-\\").reference(ctx.get([\\"name\\"], false),ctx,\\"h\\").write(\\"\\\\\\" class=\\\\\\"popup_footer_btn\\").exists(ctx.get([\\"icon\\"], false),ctx,{\\"block\\":body_3},null).write(\\"\\\\\\"\\").exists(ctx.get([\\"href\\"], false),ctx,{\\"else\\":body_4,\\"block\\":body_5},null).write(\\">\\").reference(ctx.get([\\"label\\"], false),ctx,\\"h\\").write(\\"</a></div>\\");}function body_3(chk,ctx){return chk.write(\\" popup_footer_btn__icon\\");}function body_4(chk,ctx){return chk.write(\\"href=\\\\\\"javascript:void(0)\\\\\\"\\");}function body_5(chk,ctx){return chk.write(\\"href=\\").reference(ctx.get([\\"href\\"], false),ctx,\\"h\\").write(\\" target=\\\\\\"_blank\\\\\\"\\");}return body_0;})();","popupHeader":"(function(){dust.register(\\"popupHeader\\",body_0);function body_0(chk,ctx){return chk.section(ctx.get([\\"title\\"], false),ctx,{\\"block\\":body_1},null);}function body_1(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-popup-header-title\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</div>\\");}return body_0;})();","shortFirm":"(function(){dust.register(\\"shortFirm\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-map-firm-bullet\\\\\\"></div><h2 class=\\\\\\"dg-map-firm-title dg-map-result-title\\\\\\"><a id=\\\\\\"\\").reference(ctx.get([\\"id\\"], false),ctx,\\"h\\").write(\\"\\\\\\" class=\\\\\\"pseudo link-natural link-text dg-firm-shortcard\\\\\\" href=\\\\\\"javascript:void(0)\\\\\\">\\").reference(ctx.get([\\"name\\"], false),ctx,\\"h\\").write(\\"</a></h2>\\");}return body_0;})();","sight":"(function(){dust.register(\\"sight\\",body_0);function body_0(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-map-geoclicker-purpose dg-map-geoclicker-purpose__sight\\\\\\">\\").reference(ctx.get([\\"purpose\\"], false),ctx,\\"h\\").write(\\"</div>\\").section(ctx.get([\\"address\\"], false),ctx,{\\"block\\":body_1},null).write(\\"<div class=\\\\\\"dg-map-geoclicker-drilldown\\\\\\">\\").reference(ctx.get([\\"drillDown\\"], false),ctx,\\"h\\").write(\\"</div>\\").section(ctx.get([\\"description\\"], false),ctx,{\\"block\\":body_2},null);}function body_1(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-map-geoclicker-address\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</div>\\");}function body_2(chk,ctx){return chk.write(\\"<div class=\\\\\\"dg-map-geoclicker-sight-description\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</div>\\").section(ctx.get([\\"showMoreText\\"], false),ctx,{\\"block\\":body_3},null);}function body_3(chk,ctx){return chk.write(\\"<a id=\\\\\\"dg-showmoresight\\\\\\" href=\\\\\\"javascript:void(0)\\\\\\">\\").reference(ctx.getPath(true, []),ctx,\\"h\\").write(\\"</a>\\");}return body_0;})();"}')),t&&DG.Util.setOptions(this,t)},showLoader:function(e){e&&(e.style.display="block")},hideLoader:function(e){e&&(e.style.display="none")},initLoader:function(e){var t=document.createElement("div");return t.innerHTML=this._templates("loader",{small:e,anim:this._detectCssAnimation()}),t.firstChild},showPopup:function(e,t){this._popup.setContent(t).setLatLng(e).openOn(this._map)},render:function(e){var t,c={};return e=e||{},e.tmpl=e.tmpl||"",t=e.data?this._templates(e.tmpl,e.data):e.tmpl,e.beforeRender&&e.beforeRender(),e.popup&&(e.header&&(c.header=e.header),e.footer&&(c.footer=e.footer),c.body=t,this._popup.setContent(c)),e.afterRender&&e.afterRender(),t},renderPopup:function(e){return e.popup=!0,this.render(e)},getPopup:function(){return this._popup},_detectCssAnimation:function(){var e=!1,t="animation",c="",r="Webkit Moz O ms Khtml".split(" "),n=document.createElement("div"),i="";if(n.style.animationName&&(e=!0),e===!1)for(var o=0;o<r.length;o++)if(void 0!==n.style[r[o]+"AnimationName"]){i=r[o],t=i+"Animation",c="-"+i.toLowerCase()+"-",e=!0;break}return e}});DG.Geoclicker.Controller=DG.Class.extend({options:{handlersSequence:{house:DG.Geoclicker.Handler.House,sight:DG.Geoclicker.Handler.Sight,street:DG.Geoclicker.Handler.CityArea,place:DG.Geoclicker.Handler.CityArea,district:DG.Geoclicker.Handler.CityArea,division:DG.Geoclicker.Handler.CityArea,settlement:DG.Geoclicker.Handler.CityArea,city:DG.Geoclicker.Handler.CityArea,"default":DG.Geoclicker.Handler.Default}},initialize:function(e,i){this._options=i,this._handlers={},this._catalogApi=new DG.Geoclicker.Provider.CatalogApi(e),this._map=e,this._view=new DG.Geoclicker.View(e),this._renderHandlerResult=DG.bind(this._renderHandlerResult,this),this._lastHandleClickArguments=null},handlePopupClose:function(e){e===this._view.getPopup()&&(this._lastHandleClickArguments=null,this._catalogApi.cancelLastRequest())},handleClick:function(e,i,n){var t=this,r=Array.prototype.slice.call(arguments,0);this._catalogApi.getLocations({latlng:e,zoom:i,callback:function(e){e.extra=n,t.handleResponse(e)},beforeRequest:function(){var i=t._view.initLoader();t._view._popup.clear(),t._view.showPopup(e,i),t._lastHandleClickArguments=r}})},handleResponse:function(e){var i;if(this._view.hideLoader(),!e)return this._runHandler("default"),void 0;if(!e.error||"no type"!==e.error){for(;i=this.findHandler(e);){if(this._runHandler(i,e))return;delete e[i]}this._runHandler("default")}},findHandler:function(e){for(var i in this.options.handlersSequence)if(e[i])return i;return null},getCatalogApi:function(){return this._catalogApi},getMap:function(){return this._map},reinvokeHandler:function(){this._lastHandleClickArguments&&this.handleClick.apply(this,this._lastHandleClickArguments)},_runHandler:function(e,i){i=i||{},this._initHandlerOnce(e);var n=this._handlers[e].handle(i,e);return n?n.then(this._renderHandlerResult):!1},_renderHandlerResult:function(e){this._view.renderPopup(e)},_initHandlerOnce:function(e){this._handlers[e]||(this._handlers[e]=new this.options.handlersSequence[e](this,this._view,this._map,this._options))}});DG.Geoclicker.Handler.Default.Dictionary.it=DG.extend({we_have_not:"Non disponiamo ancora di informazioni su questo posto",noname:"Nome non indicato",place:"Luogo",division:"Zona",settlement:"Comune",street:"Via",district:"Municipalità",city:"Сittà",go_to:"Come arrivare",show_organization_in_building:["{n} azienda in tutto","{n} aziende in tutto"],show_more_about_sight:"Maggiori informazioni",back_button:"Indietro",n_floors:["{n} piano","{n} piani"]},DG.Dictionary.it);DG.Geoclicker.Handler.Default.Dictionary.ru=DG.extend({we_have_not:"Это место мы ещё не успели изучить",noname:"Без названия",place:"Место",division:"Округ",settlement:"Населенный пункт",street:"Улица",district:"Район",city:"Город",go_to:"Проехать сюда",show_organization_in_building:["Всего {n} организация","Всего {n} организации","Всего {n} организаций"],show_more_about_sight:"Подробнее",back_button:"Назад",n_floors:["{n} этаж","{n} этажа","{n} этажей"]},DG.Dictionary.ru);DG.Geoclicker.Handler.Default.Dictionary.en=DG.extend({we_have_not:"We haven't collected info about this place yet",noname:"No name",place:"Place",division:"Area",settlement:"Village",street:"Street",district:"Disctict",city:"City",go_to:"Directions to here",show_organization_in_building:["{n} organization total","{n} organizations total"],back_button:"Back",show_more_about_sight:"More information",n_floors:["{n} floor","{n} floors"]},DG.Dictionary.en);DG.Geoclicker.Handler.Default.Dictionary.cs=DG.extend({we_have_not:"O tomto místě zatím nemáme informace",noname:"Bez názvu",place:"Místo",division:"Správní obvod",settlement:"Obec",street:"Ulice",district:"Městská část",city:"Město",go_to:"cs - Directions to here",show_organization_in_building:["Celkem {n} organizace","Celkem {n} organizace","Celkem {n} organizací"],back_button:"Zpět",show_more_about_sight:"Více",n_floors:["{n} patro","{n} patra","{n} pater"]},DG.Dictionary.cs);var FirmCard=function(t,e){this._setOptions(e),this._firmContentObject={},this._schedule=new FirmCard.Schedule({localLang:this.options.lang,dict:this.dict}),this.render(t)};FirmCard.prototype={render:function(t){return t?(t!==this._firmId&&(this._firmContentObject={},this._renderCardById(t)),this._firmContentObject):void 0},getSchedule:function(){return this._schedule},_renderCardById:function(t){var e=this;this.options.ajax(t).then(function(i){var n=i.result.data;"undefined"!==n&&(e._firmData=n[0],e._firmId=t,e._renderFirmCard(),e._initEventHandlers())})},_createFirmContainer:function(){var t=document.createElement("div");return t.setAttribute("id","dg-map-firm-full-"+this._firmId),t.setAttribute("class","dg-map-firm-full"),t},_renderFirmCard:function(){var t,e,i,n,o,s,r=this._firmData,a=this._container=this._createFirmContainer();e=this._schedule.transform(r.schedule,{zoneOffset:this.options.timezoneOffset,apiLang:this.options.lang,localLang:this.options.lang}),i=this._schedule.forecast(e),r.attributes&&r.attributes.general&&r.attributes.general.items&&(s=r.attributes.general.items?r.attributes.general.items:[]),t=this._buildFirmCardBody(this._getConfigFirmCardBody(r,e,i,s)),n=this._fillHeaderLinks(),o=this._fillFooterButtons(),this._firmContentObject.header=this.options.render("firmCardHeader",{firmName:r.name,links:n}),a.innerHTML=t,this._firmContentObject.tmpl=a,o.length&&(this._footerContainer=document.createElement("div"),this._footerContainer.className="footer-btns",this._footerContainer.innerHTML=this.options.render("popupFooterBtns",{btns:o}),this._firmContentObject.footer=this._footerContainer),this.options.onFirmReady&&this.options.onFirmReady(this._firmContentObject)},_getConfigFirmCardBody:function(t,e,i,n){return[{tmpl:"firmCardAddr",data:{data:t.geo}},{tmpl:"firmCardContacts",data:{groups:t.contact_groups}},{tmpl:"firmCardSchedule",data:{schedule:e,forecast:i}},{tmpl:"frimCardPayments",data:{payments:n}},{tmpl:"firmCardRubric",data:{rubrics:t.rubrics}}]},_buildFirmCardBody:function(t){var e=this;return t.reduce(function(t,i){var n=e.options.render(i.tmpl,i.data);return t+n},"")},_fillFooterButtons:function(){var t=[];return this.options.backBtn&&t.push({name:"firmCard-back",label:this.dict.t(this.options.lang,"btnBack"),icon:!0}),this._firmData.geo.entrances&&this.options.showEntrance&&t.push({name:"show-entrance",label:this.dict.t(this.options.lang,"btnEntrance"),icon:!0}),t},_fillHeaderLinks:function(){var t,e=[],i=this._firmData.reviews,n=this._firmData.photos,o=this._firmData.booklet;return i&&i.is_allowed_to_show_reviews&&(e.push({name:"flamp_stars",width:20*i.rating}),e.push({name:"flamp_reviews",label:this.dict.t(this.options.lang,"linkReviews",i.review_count),href:FirmCard.DataHelper.getFlampUrl(this._firmId)})),!this.options.isMobile&&n&&n.length&&this.options.showPhotos&&(t=L.Util.template("http://beta.2gis.ru/photos/{id}",{id:this._firmId}),e.push({name:"photos",href:t,label:this.dict.t(this.options.lang,"linkPhoto",n.length)})),!this.options.isMobile&&o&&o.url&&this.options.showBooklet&&e.push({name:"booklet",href:o.url,label:this.dict.t(this.options.lang,"linkBooklet")}),e},_onFooterBtnClick:function(t){t=t||window.event;var e=t.target||t.srcElement;if(e&&"A"===e.nodeName)if("popup-btn-firmCard-back"===e.id)this.options.backBtn();else if("popup-btn-show-entrance"===e.id){var i=new this.options.showEntrance({vectors:this._firmData.geo.entrances[0].vectors});i.addTo(this.options.map).show()}},_onToggleSchedule:function(t){var e=this._container.querySelector(".schedule__table"),i=this._container.querySelector(".schedule__now"),n=" show_schedule",o=t.target||t.srcElement;e&&o&&"DIV"===o.nodeName&&-1!==o.className.indexOf("schedule__today")&&("block"===e.style.display?(e.style.display="none",i.style.display="block",o.className=o.className.replace(n,"")):(i.style.display="none",e.style.display="block",o.className+=n),this.options.onToggle&&this.options.onToggle())},_initEventHandlers:function(){var t=this._hasTouch()?"touchend":"click",e=this._footerContainer,i=this._container;i.addEventListener?(e&&e.addEventListener(t,this._bind(this._onFooterBtnClick,this),!1),i.addEventListener(t,this._bind(this._onToggleSchedule,this),!1)):(e&&e.attachEvent("on"+t,this._bind(this._onFooterBtnClick,this)),i.attachEvent("on"+t,this._bind(this._onToggleSchedule,this)))},_bind:function(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},_setOptions:function(t){var e,t=t||{};this.options=t,t.lang=t.lang||"ru";for(e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])},_hasTouch:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}};FirmCard.DataHelper={FLAMP_URL:"http://flamp.ru/r/",FLAMP_GOOGLE_ANALYTICS:"utm_source=api2gis&utm_medium=api&utm_campaign=geoclicker",payMethods:["americanexpress","cash","dinersclub","goldcrown","internet","mastercard","noncash","visa"],_msgs:{},getFlampUrl:function(e){return this.FLAMP_URL.concat(e,"?",this.FLAMP_GOOGLE_ANALYTICS)},msg:function(e){return this._msgs.hasOwnProperty(e)?this._msgs[e]:(console&&console.log("Cant't find translation for '"+e+"'."),e.toString().replace("_"," "))},getProjectTime:function(e,t){var n,r;return n=t?new Date(t):new Date,e?(r=n.getTime()+6e4*n.getTimezoneOffset(),new Date(r+6e4*e)):n}};!function(){FirmCard.List=function(i,t){this._firms={},this._setOptions(t),this._container=t&&t.container||document.createElement("ul"),this._container.setAttribute("class","building-callout__list"),this._eventHandlersInited=!1,this._firmCard=this._createFirm(),this.renderList(i)},FirmCard.List.prototype={renderList:function(i){return i&&(this._eventHandlersInited||this._initEventHandlers(),this.addFirms(i)),this.options.onListReady&&this.options.onListReady(this._container),this._container},addFirms:function(i){if(i)if(this._isArray(i))for(var t=0,n=i.length;n>t;t++)this._addFirm(i[t]);else this._addFirm(i)},removeFirms:function(i){if(i)if(this._isArray(i))for(var t=0,n=i.length;n>t;t++)this._removeFirm(i[t]);else this._removeFirm(i)},setLang:function(i){this.options.firmCard.lang=i},getLang:function(){return this.options.firmCard.lang},getContainer:function(){return this._container},clearList:function(){this._firms={},this._clearContainer()},_removeFirm:function(i){var t=this._firms[i]?this._firms[i]:!1;t?this._container.removeChild(t):!1,this._firms[i]?delete this._firms[i]:!1},_addFirm:function(i){var t,n,r,e=this.options.firmlistItemTmpl;n={name:i.name,id:i.id.split("_").slice(0,1)},n.id in this._firms||(t=this._createListItem(),r=e?this.options.firmCard.render(e,{firm:n}):n.name,t.insertAdjacentHTML("beforeend",r),this._firms[n.id]=t,this._container.appendChild(t))},_createListItem:function(){var i=document.createElement("li");return i.setAttribute("class","building-callout__list-item"),i},_isArray:function(i){return"[object Array]"==={}.toString.call(i)},_createFirm:function(i){return new FirmCard(i,this.options.firmCard)},_isEmptyObj:function(i){for(var t in i)if(i.hasOwnProperty(t))return!1;return!0},_initEventHandlers:function(){var i=this,t=this._hasTouch()?"touchend":"click";this._eventHandlersInited=!0;var n=function(t){t=t||window.event;var n=t.target||t.srcElement;if(n&&"A"===n.nodeName&&-1!==n.className.indexOf("popup-link")&&n.id){var r=i._firmCard.render(n.id);i._isEmptyObj(r)?i.options.firmCard.pasteLoader():i.options.firmCard.onFirmReady(r),i.options.firmCard.onFirmClick&&i.options.firmCard.onFirmClick(t)}};this._container.addEventListener?this._container.addEventListener(t,n,!1):this._container.attachEvent("on"+t,n)},_hasTouch:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},_clearContainer:function(){for(var i=this._container;i.hasChildNodes();)i.removeChild(i.firstChild)},_setOptions:function(i){i||(i={}),this.options=i,this.options.firmCard||(this.options.firmCard={}),i.firmCard.lang||(this.options.firmCard.lang="ru");for(var t in i)i.hasOwnProperty(t)&&(this.options[t]=i[t])}}}();(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,v=e.reduce,h=e.reduceRight,d=e.filter,g=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,w=i.bind,j=function(n){return n instanceof j?n:this instanceof j?(this._wrapped=n,void 0):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.5.1";var A=j.each=j.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a in n)if(j.has(n,a)&&t.call(e,n[a],a,n)===r)return};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduce===v)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(E);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduceRight===h)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(E);return r},j.find=j.detect=function(n,t,r){var e;return O(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:d&&n.filter===d?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:g&&n.every===g?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var O=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?-1!=n.indexOf(t):O(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,function(n){return n[t]})},j.where=function(n,t,r){return j.isEmpty(t)?r?void 0:[]:j[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},j.findWhere=function(n,t){return j.where(n,t,!0)},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&j.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>e.computed&&(e={value:n,computed:a})}),e.value},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&j.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e};var F=function(n){return j.isFunction(n)?n:function(t){return t[n]}};j.sortBy=function(n,t,r){var e=F(t);return j.pluck(j.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index<t.index?-1:1}),"value")};var k=function(n,t,r,e){var u={},i=F(null==t?j.identity:t);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};j.groupBy=function(n,t,r){return k(n,t,r,function(n,t,r){(j.has(n,t)?n[t]:n[t]=[]).push(r)})},j.countBy=function(n,t,r){return k(n,t,r,function(n,t){j.has(n,t)||(n[t]=0),n[t]++})},j.sortedIndex=function(n,t,r,e){r=null==r?j.identity:F(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var R=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return R(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.indexOf(t,n)>=0})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var M=function(){};j.bind=function(n,t){var r,e;if(w&&n.bind===w)return w.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));M.prototype=n.prototype;var u=new M;M.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:new Date,a=null,i=n.apply(e,u)};return function(){var l=new Date;o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u)):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u=null;return function(){var i=this,a=arguments,o=function(){u=null,r||(e=n.apply(i,a))},c=r&&!u;return clearTimeout(u),u=setTimeout(o,t),c&&(e=n.apply(i,a)),e}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){var t=[];for(var r in n)j.has(n,r)&&t.push(n[r]);return t},j.pairs=function(n){var t=[];for(var r in n)j.has(n,r)&&t.push([r,n[r]]);return t},j.invert=function(n){var t={};for(var r in n)j.has(n,r)&&(t[n[r]]=r);return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)void 0===n[r]&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return void 0===n},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=j.invert(I.escape);var T={escape:new RegExp("["+j.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(I.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(T[n],function(t){return I[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);!function(t){function e(t,e){return function(n){return u(t.call(this,n),e)}}function n(t,e){return function(n){return this.lang().ordinal(t.call(this,n),e)}}function s(){}function i(t){a(this,t)}function r(t){var e=t.years||t.year||t.y||0,n=t.months||t.month||t.M||0,s=t.weeks||t.week||t.w||0,i=t.days||t.day||t.d||0,r=t.hours||t.hour||t.h||0,a=t.minutes||t.minute||t.m||0,o=t.seconds||t.second||t.s||0,u=t.milliseconds||t.millisecond||t.ms||0;this._input=t,this._milliseconds=u+1e3*o+6e4*a+36e5*r,this._days=i+7*s,this._months=n+12*e,this._data={},this._bubble()}function a(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function o(t){return 0>t?Math.ceil(t):Math.floor(t)}function u(t,e){for(var n=t+"";n.length<e;)n="0"+n;return n}function h(t,e,n,s){var i,r,a=e._milliseconds,o=e._days,u=e._months;a&&t._d.setTime(+t._d+a*n),(o||u)&&(i=t.minute(),r=t.hour()),o&&t.date(t.date()+o*n),u&&t.month(t.month()+u*n),a&&!s&&H.updateOffset(t),(o||u)&&(t.minute(i),t.hour(r))}function d(t){return"[object Array]"===Object.prototype.toString.call(t)}function c(t,e){var n,s=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),r=0;for(n=0;s>n;n++)~~t[n]!==~~e[n]&&r++;return r+i}function f(t){return t?ie[t]||t.toLowerCase().replace(/(.)s$/,"$1"):t}function l(t,e){return e.abbr=t,x[t]||(x[t]=new s),x[t].set(e),x[t]}function _(t){if(!t)return H.fn._lang;if(!x[t]&&A)try{require("./lang/"+t)}catch(e){return H.fn._lang}return x[t]}function m(t){return t.match(/\[.*\]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function y(t){var e,n,s=t.match(E);for(e=0,n=s.length;n>e;e++)s[e]=ue[s[e]]?ue[s[e]]:m(s[e]);return function(i){var r="";for(e=0;n>e;e++)r+=s[e]instanceof Function?s[e].call(i,t):s[e];return r}}function M(t,e){function n(e){return t.lang().longDateFormat(e)||e}for(var s=5;s--&&N.test(e);)e=e.replace(N,n);return re[e]||(re[e]=y(e)),re[e](t)}function g(t,e){switch(t){case"DDDD":return V;case"YYYY":return X;case"YYYYY":return $;case"S":case"SS":case"SSS":case"DDD":return I;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return R;case"a":case"A":return _(e._l)._meridiemParse;case"X":return B;case"Z":case"ZZ":return j;case"T":return q;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return J;default:return new RegExp(t.replace("\\",""))}}function p(t){var e=(j.exec(t)||[])[0],n=(e+"").match(ee)||["-",0,0],s=+(60*n[1])+~~n[2];return"+"===n[0]?-s:s}function D(t,e,n){var s,i=n._a;switch(t){case"M":case"MM":i[1]=null==e?0:~~e-1;break;case"MMM":case"MMMM":s=_(n._l).monthsParse(e),null!=s?i[1]=s:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=e&&(i[2]=~~e);break;case"YY":i[0]=~~e+(~~e>68?1900:2e3);break;case"YYYY":case"YYYYY":i[0]=~~e;break;case"a":case"A":n._isPm=_(n._l).isPM(e);break;case"H":case"HH":case"h":case"hh":i[3]=~~e;break;case"m":case"mm":i[4]=~~e;break;case"s":case"ss":i[5]=~~e;break;case"S":case"SS":case"SSS":i[6]=~~(1e3*("0."+e));break;case"X":n._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=p(e)}null==e&&(n._isValid=!1)}function Y(t){var e,n,s=[];if(!t._d){for(e=0;7>e;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];s[3]+=~~((t._tzm||0)/60),s[4]+=~~((t._tzm||0)%60),n=new Date(0),t._useUTC?(n.setUTCFullYear(s[0],s[1],s[2]),n.setUTCHours(s[3],s[4],s[5],s[6])):(n.setFullYear(s[0],s[1],s[2]),n.setHours(s[3],s[4],s[5],s[6])),t._d=n}}function w(t){var e,n,s=t._f.match(E),i=t._i;for(t._a=[],e=0;e<s.length;e++)n=(g(s[e],t).exec(i)||[])[0],n&&(i=i.slice(i.indexOf(n)+n.length)),ue[s[e]]&&D(s[e],n,t);i&&(t._il=i),t._isPm&&t._a[3]<12&&(t._a[3]+=12),t._isPm===!1&&12===t._a[3]&&(t._a[3]=0),Y(t)}function k(t){var e,n,s,r,o,u=99;for(r=0;r<t._f.length;r++)e=a({},t),e._f=t._f[r],w(e),n=new i(e),o=c(e._a,n.toArray()),n._il&&(o+=n._il.length),u>o&&(u=o,s=n);a(t,s)}function v(t){var e,n=t._i,s=K.exec(n);if(s){for(t._f="YYYY-MM-DD"+(s[2]||" "),e=0;4>e;e++)if(te[e][1].exec(n)){t._f+=te[e][0];break}j.exec(n)&&(t._f+=" Z"),w(t)}else t._d=new Date(n)}function T(e){var n=e._i,s=G.exec(n);n===t?e._d=new Date:s?e._d=new Date(+s[1]):"string"==typeof n?v(e):d(n)?(e._a=n.slice(0),Y(e)):e._d=n instanceof Date?new Date(+n):new Date(n)}function b(t,e,n,s,i){return i.relativeTime(e||1,!!n,t,s)}function S(t,e,n){var s=W(Math.abs(t)/1e3),i=W(s/60),r=W(i/60),a=W(r/24),o=W(a/365),u=45>s&&["s",s]||1===i&&["m"]||45>i&&["mm",i]||1===r&&["h"]||22>r&&["hh",r]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",W(a/30)]||1===o&&["y"]||["yy",o];return u[2]=e,u[3]=t>0,u[4]=n,b.apply({},u)}function F(t,e,n){var s,i=n-e,r=n-t.day();return r>i&&(r-=7),i-7>r&&(r+=7),s=H(t).add("d",r),{week:Math.ceil(s.dayOfYear()/7),year:s.year()}}function O(t){var e=t._i,n=t._f;return null===e||""===e?null:("string"==typeof e&&(t._i=e=_().preparse(e)),H.isMoment(e)?(t=a({},e),t._d=new Date(+e._d)):n?d(n)?k(t):w(t):T(t),new i(t))}function z(t,e){H.fn[t]=H.fn[t+"s"]=function(t){var n=this._isUTC?"UTC":"";return null!=t?(this._d["set"+n+e](t),H.updateOffset(this),this):this._d["get"+n+e]()}}function C(t){H.duration.fn[t]=function(){return this._data[t]}}function L(t,e){H.duration.fn["as"+t]=function(){return+this/e}}for(var H,P,U="2.1.0",W=Math.round,x={},A="undefined"!=typeof module&&module.exports,G=/^\/?Date\((\-?\d+)/i,Z=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,E=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,N=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,J=/\d\d?/,I=/\d{1,3}/,V=/\d{3}/,X=/\d{1,4}/,$=/[+\-]?\d{1,6}/,R=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,j=/Z|[\+\-]\d\d:?\d\d/i,q=/T/i,B=/[\+\-]?\d+(\.\d{1,3})?/,K=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,Q="YYYY-MM-DDTHH:mm:ssZ",te=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ee=/([\+\-]|\d\d)/gi,ne="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),se={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},ie={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},re={},ae="DDD w W M D d".split(" "),oe="M D H h m s w W".split(" "),ue={M:function(){return this.month()+1},MMM:function(t){return this.lang().monthsShort(this,t)},MMMM:function(t){return this.lang().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.lang().weekdaysMin(this,t)},ddd:function(t){return this.lang().weekdaysShort(this,t)},dddd:function(t){return this.lang().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return u(this.year()%100,2)},YYYY:function(){return u(this.year(),4)},YYYYY:function(){return u(this.year(),5)},gg:function(){return u(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return u(this.weekYear(),5)},GG:function(){return u(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return u(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return u(~~(this.milliseconds()/10),2)},SSS:function(){return u(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+u(~~(t/60),2)+":"+u(~~t%60,2)},ZZ:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+u(~~(10*t/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};ae.length;)P=ae.pop(),ue[P+"o"]=n(ue[P],P);for(;oe.length;)P=oe.pop(),ue[P+P]=e(ue[P],2);for(ue.DDDD=e(ue.DDD,3),s.prototype={set:function(t){var e,n;for(n in t)e=t[n],"function"==typeof e?this[n]=e:this["_"+n]=e},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t){var e,n,s;for(this._monthsParse||(this._monthsParse=[]),e=0;12>e;e++)if(this._monthsParse[e]||(n=H([2e3,e]),s="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[e]=new RegExp(s.replace(".",""),"i")),this._monthsParse[e].test(t))return e},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,n,s;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(n=H([2e3,1]).day(e),s="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[e]=new RegExp(s.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e){var n=this._calendar[t];return"function"==typeof n?n.apply(e):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,n,s){var i=this._relativeTime[n];return"function"==typeof i?i(t,e,n,s):i.replace(/%d/i,t)},pastFuture:function(t,e){var n=this._relativeTime[t>0?"future":"past"];return"function"==typeof n?n(e):n.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",preparse:function(t){return t},postformat:function(t){return t},week:function(t){return F(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},H=function(t,e,n){return O({_i:t,_f:e,_l:n,_isUTC:!1})},H.utc=function(t,e,n){return O({_useUTC:!0,_isUTC:!0,_l:n,_i:t,_f:e})},H.unix=function(t){return H(1e3*t)},H.duration=function(t,e){var n,s,i=H.isDuration(t),a="number"==typeof t,o=i?t._input:a?{}:t,u=Z.exec(t);return a?e?o[e]=t:o.milliseconds=t:u&&(n="-"===u[1]?-1:1,o={y:0,d:~~u[2]*n,h:~~u[3]*n,m:~~u[4]*n,s:~~u[5]*n,ms:~~u[6]*n}),s=new r(o),i&&t.hasOwnProperty("_lang")&&(s._lang=t._lang),s},H.version=U,H.defaultFormat=Q,H.updateOffset=function(){},H.lang=function(t,e){return t?(e?l(t,e):x[t]||_(t),H.duration.fn._lang=H.fn._lang=_(t),void 0):H.fn._lang._abbr},H.langData=function(t){return t&&t._lang&&t._lang._abbr&&(t=t._lang._abbr),_(t)},H.isMoment=function(t){return t instanceof i},H.isDuration=function(t){return t instanceof r},H.fn=i.prototype={clone:function(){return H(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return M(H(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!c(this._a,(this._isUTC?H.utc(this._a):H(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(t){var e=M(this,t||H.defaultFormat);return this.lang().postformat(e)},add:function(t,e){var n;return n="string"==typeof t?H.duration(+e,t):H.duration(t,e),h(this,n,1),this},subtract:function(t,e){var n;return n="string"==typeof t?H.duration(+e,t):H.duration(t,e),h(this,n,-1),this},diff:function(t,e,n){var s,i,r=this._isUTC?H(t).zone(this._offset||0):H(t).local(),a=6e4*(this.zone()-r.zone());return e=f(e),"year"===e||"month"===e?(s=432e5*(this.daysInMonth()+r.daysInMonth()),i=12*(this.year()-r.year())+(this.month()-r.month()),i+=(this-H(this).startOf("month")-(r-H(r).startOf("month")))/s,i-=6e4*(this.zone()-H(this).startOf("month").zone()-(r.zone()-H(r).startOf("month").zone()))/s,"year"===e&&(i/=12)):(s=this-r,i="second"===e?s/1e3:"minute"===e?s/6e4:"hour"===e?s/36e5:"day"===e?(s-a)/864e5:"week"===e?(s-a)/6048e5:s),n?i:o(i)},from:function(t,e){return H.duration(this.diff(t)).lang(this.lang()._abbr).humanize(!e)},fromNow:function(t){return this.from(H(),t)},calendar:function(){var t=this.diff(H().startOf("day"),"days",!0),e=-6>t?"sameElse":-1>t?"lastWeek":0>t?"lastDay":1>t?"sameDay":2>t?"nextDay":7>t?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){var t=this.year();return 0===t%4&&0!==t%100||0===t%400},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?"string"==typeof t&&(t=this.lang().weekdaysParse(t),"number"!=typeof t)?this:this.add({d:t-e}):e},month:function(t){var e,n=this._isUTC?"UTC":"";return null!=t?"string"==typeof t&&(t=this.lang().monthsParse(t),"number"!=typeof t)?this:(e=this.date(),this.date(1),this._d["set"+n+"Month"](t),this.date(Math.min(e,this.daysInMonth())),H.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(t){switch(t=f(t)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),this},endOf:function(t){return this.startOf(t).add(t,1).subtract("ms",1)},isAfter:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)>+H(t).startOf(e)},isBefore:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)<+H(t).startOf(e)},isSame:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)===+H(t).startOf(e)},min:function(t){return t=H.apply(null,arguments),this>t?this:t},max:function(t){return t=H.apply(null,arguments),t>this?this:t},zone:function(t){var e=this._offset||0;return null==t?this._isUTC?e:this._d.getTimezoneOffset():("string"==typeof t&&(t=p(t)),Math.abs(t)<16&&(t=60*t),this._offset=t,this._isUTC=!0,e!==t&&h(this,H.duration(e-t,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return H.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(t){var e=W((H(this).startOf("day")-H(this).startOf("year"))/864e5)+1;return null==t?e:this.add("d",t-e)},weekYear:function(t){var e=F(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==t?e:this.add("y",t-e)},isoWeekYear:function(t){var e=F(this,1,4).year;return null==t?e:this.add("y",t-e)},week:function(t){var e=this.lang().week(this);return null==t?e:this.add("d",7*(t-e))},isoWeek:function(t){var e=F(this,1,4).week;return null==t?e:this.add("d",7*(t-e))},weekday:function(t){var e=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==t?e:this.add("d",t-e)},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},lang:function(e){return e===t?this._lang:(this._lang=_(e),this)}},P=0;P<ne.length;P++)z(ne[P].toLowerCase().replace(/s$/,""),ne[P]);z("year","FullYear"),H.fn.days=H.fn.day,H.fn.months=H.fn.month,H.fn.weeks=H.fn.week,H.fn.isoWeeks=H.fn.isoWeek,H.fn.toJSON=H.fn.toISOString,H.duration.fn=r.prototype={_bubble:function(){var t,e,n,s,i=this._milliseconds,r=this._days,a=this._months,u=this._data;u.milliseconds=i%1e3,t=o(i/1e3),u.seconds=t%60,e=o(t/60),u.minutes=e%60,n=o(e/60),u.hours=n%24,r+=o(n/24),u.days=r%30,a+=o(r/30),u.months=a%12,s=o(a/12),u.years=s},weeks:function(){return o(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*~~(this._months/12)},humanize:function(t){var e=+this,n=S(e,!t,this.lang());return t&&(n=this.lang().pastFuture(e,n)),this.lang().postformat(n)},add:function(t,e){var n=H.duration(t,e);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(t,e){var n=H.duration(t,e);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(t){return t=f(t),this[t.toLowerCase()+"s"]()},as:function(t){return t=f(t),this["as"+t.charAt(0).toUpperCase()+t.slice(1)+"s"]()},lang:H.fn.lang};for(P in se)se.hasOwnProperty(P)&&(L(P,se[P]),C(P.toLowerCase()));L("Weeks",6048e5),H.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},H.lang("en",{ordinal:function(t){var e=t%10,n=1===~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),A&&(module.exports=H),"undefined"==typeof ender&&(this.moment=H),"function"==typeof define&&define.amd&&define("moment",[],function(){return H})}.call(this);!function(){function e(e){function _(e,_){var t=e.split("_");return 1===_%10&&11!==_%100?t[0]:_%10>=2&&4>=_%10&&(10>_%100||_%100>=20)?t[1]:t[2]}function t(e,t,n){var d={mm:"минута_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};return"m"===n?t?"минута":"минуту":e+" "+_(d[n],+e)}function n(e,_){var t={nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")},n=/D[oD]? *MMMM?/.test(_)?"accusative":"nominative";return t[n][e.month()]}function d(e,_){var t={nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")},n=/\[ ?[\u0412\u0432] ?(?:\u043f\u0440\u043e\u0448\u043b\u0443\u044e|\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e)? ?\] ?dddd/.test(_)?"accusative":"nominative";return t[n][e.day()]}e.lang("ru",{months:n,monthsShort:"янв_фев_мар_апр_май_июн_июл_авг_сен_окт_ноя_дек".split("_"),weekdays:d,weekdaysShort:"вск_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., LT",LLLL:"dddd, D MMMM YYYY г., LT"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(){switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:t,mm:t,h:"час",hh:t,d:"день",dd:t,M:"месяц",MM:t,y:"год",yy:t},ordinal:function(e,_){switch(_){case"M":case"d":case"DDD":return e+"-й";case"D":return e+"-го";case"w":case"W":return e+"-я";default:return e}},week:{dow:1,doy:7}})}"function"==typeof define&&define.amd&&define(["moment"],e),"undefined"!=typeof window&&window.moment&&e(window.moment)}();!function(){function e(e){function n(e){return e>1&&5>e&&1!==~~(e/10)}function t(e,t,r,s){var d=e+" ";switch(r){case"s":return t||s?"pár vteřin":"pár vteřinami";case"m":return t?"minuta":s?"minutu":"minutou";case"mm":return t||s?d+(n(e)?"minuty":"minut"):d+"minutami";case"h":return t?"hodina":s?"hodinu":"hodinou";case"hh":return t||s?d+(n(e)?"hodiny":"hodin"):d+"hodinami";case"d":return t||s?"den":"dnem";case"dd":return t||s?d+(n(e)?"dny":"dní"):d+"dny";case"M":return t||s?"měsíc":"měsícem";case"MM":return t||s?d+(n(e)?"měsíce":"měsíců"):d+"měsíci";case"y":return t||s?"rok":"rokem";case"yy":return t||s?d+(n(e)?"roky":"let"):d+"lety"}}var r="leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),s="led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_");e.lang("cs",{months:r,monthsShort:s,monthsParse:function(e,n){var t,r=[];for(t=0;12>t;t++)r[t]=new RegExp("^"+e[t]+"$|^"+n[t]+"$","i");return r}(r,s),weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes v] LT",nextDay:"[zítra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v neděli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve středu v] LT";case 4:return"[ve čtvrtek v] LT";case 5:return"[v pátek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[včera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou neděli v] LT";case 1:case 2:return"[minulé] dddd [v] LT";case 3:return"[minulou středu v] LT";case 4:case 5:return"[minulý] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"před %s",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},ordinal:"%d.",week:{dow:1,doy:4}})}"function"==typeof define&&define.amd&&define(["moment"],e),"undefined"!=typeof window&&window.moment&&e(window.moment)}();!function(){function e(e){e.lang("it",{months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),weekdays:"Domenica_Lunedì_Martedì_Mercoledì_Giovedì_Venerdì_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:"[lo scorso] dddd [alle] LT",sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:"%dº",week:{dow:1,doy:4}})}"function"==typeof define&&define.amd&&define(["moment"],e),"undefined"!=typeof window&&window.moment&&e(window.moment)}();FirmCard.Schedule=function(t){return t=t||{},this.localLang=t.localLang||"ru",this.dict=t.dict,this},FirmCard.Schedule.prototype={setLang:function(t){return this.localLang=t||"ru",this},transform:function(t,n){function e(t,n){var e=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(n,e||arguments)}}function l(t){return t.charAt(0).toUpperCase()+t.slice(1)}function i(t){return t.substr(0,2)}function o(t){return t.substr(3,2)}function a(t){var n=+i(t)%24+"";return 1===n.length&&(n="0"+n),n+":"+o(t)}function r(t){return(t+70)%7}function s(t){var n,e,l,a,r=[];if(!t||!t.working_hours)return[];for(var s=0;s<t.working_hours.length;s++)n=t.working_hours[s].from,e=t.working_hours[s].to,l=i(e)-i(n),a=o(e)-o(n),(0>l||0===l&&0>=a)&&(e=+i(e)+24+":"+o(e)),r[2*s]={time:n,type:"open"},r[2*s+1]={time:e,type:t.working_hours.length-1===s?"close":"lunch"};return r}function h(t){for(var n,e,l=[],a=[],h=_.indexOf(C,f),c=0;7>c;c++)e=r(h+c),n=s(t[C[e]]),_.each(n,function(t){var n=moment(x).day(r(h+c+D)).hours(i(t.time)).minutes(o(t.time)).valueOf();l.push({ts:n,type:t.type}),l[l.length-1]&&l[l.length-2]&&l[l.length-1].ts===l[l.length-2].ts&&(l.pop(),l.pop()),l[l.length-1]&&l[l.length-2]&&l[l.length-1].ts<=x&&l[l.length-2].ts<=x&&(l[l.length-1].ts+=6048e5,l[l.length-2].ts+=6048e5)});for(l=_.sortBy(l,function(t){return t.ts}),c=0;c<l.length;)l[c+1]&&l[c].ts===l[c+1].ts?c++:a.push(l[c].ts),c++;return 2===a.length&&a[1]-a[0]===6048e5?[]:l}function c(t,n,e){if(1===n&&t>H)return b(O,"tommorow");if(n>1)switch(e){case 0:return b(O,"nextSun");case 1:return b(O,"nextMon");case 2:return b(O,"nextTue");case 3:return b(O,"nextWed");case 4:return b(O,"nextThu");case 5:return b(O,"nextFri");case 6:return b(O,"nextSat")}}function u(n){var e,l,i=[];v.now={},l=h(t),l.length||(v.always=!0,v.now.open=!0);for(var o=0;o<l.length;o++)if(x>=(l[o-1]&&l[o-1].ts||0)&&x<l[o].ts){var r=Math.floor((l[o].ts-x)/36e5),u=Math.floor((l[o].ts-x)/6e4-60*r),d=moment(l[o].ts).dayOfYear()-moment(x).dayOfYear(),g="open"!==l[o].type;u=10*Math.floor(u/10)?10*Math.floor(u/10):5,v.now.open=g,v.now.lunch=!!(l[o-1]&&"lunch"===l[o-1].type||"lunch"===_.last(l).type),v.will={willType:l[o].type,d:d,h:r,m:u},v.will.when=c(r,d,moment(l[o].ts).day()),v.will.till=moment(l[o].ts).format(k)}if(n){for(e=_.pluck(s(n),"time"),o=2;o<e.length;o+=2)i.push({from:e[o-1],to:e[o]});w=a(e[0]),p=a(e[e.length-1]),v.today=w===p?{alltime:!0,alltimeStr:b(O,"worksAroundTheClock")}:{from:w,to:p},i.length>0&&(v.lunch=i,v.lunchStr=b(O,"lunch"))}}function d(){for(var n=[],e=!1,l=0;7>l;l++){var i=C[l],o=0;if(n[l]={},t[i]){for(var r=t[i],h=_.pluck(s(r),"time"),c=[],u=2;u<h.length;u+=2)e=!0,c.push({from:h[u-1],to:h[u]});o=Math.max(h.length/2,o),n[l]={from:a(h[0]),to:a(h[h.length-1]),lunch:c}}i===f&&(n[l].active=!0),n[l].key=M[l]}return _.each(n,function(t){t.lunch&&_.defaults(t.lunch,_.range(1,o))}),{table:n,hasLunch:e}}function g(t,n){var e,i={dayList:[],lunch:[]},o=[];if(t&&t.working_hours&&t.working_hours.length){e=_.pluck(s(t),"time"),_.each(e,function(t,n){0===n?i.from=a(t):n===e.length-1?i.to=a(t):o.push(a(t))});for(var h=0;h<o.length;h+=2)i.lunch.push({from:o[h],to:o[h+1],lunchStr:l(b(O,"lunch"))});t.round_the_clock&&(i.alltime=!0,i.alltimeStr=b(O,"worksAroundTheClock"))}else i.holiday=!0,i.holidayStr=b(O,"restDay");var c=[0,0,0,0,0,0,0],u=0;return _.each(C,function(e,l){if(_.isEqual(n[e],t)||!n[e]&&null===t)i.dayList.push(T[l]),c[r(l+D)]=1,u++;else{if(u>2){for(var o=i.dayList.pop(),a=1;u-1>a;a++)i.dayList.pop();i.dayList[i.dayList.length-1]+="–"+o}u=0}}),i.budni=_.isEqual(A,c),i.everyday=1===_.min(c),i.dayList=i.dayList.join(", "),i.dayList=i.dayList.charAt(0).toUpperCase()+i.dayList.slice(1),i}function m(t,n){for(var e=[],l=t.length-1;l>=0;l--)e.push(g(t[l],n));return e}if(t){n=n||{};for(var f,y,w,p,L=n.zoneOffset||0,v={},k="HH:mm",x=n.now||FirmCard.DataHelper.getProjectTime(L).getTime(),C=[],M=[],T=[],S="en",O=n.localLang||this.localLang||"en",A=n.localWorkingDays||[0,1,1,1,1,1,0],D=n.firstdayOffset||1,H=n.minHoursToDisplayClosure||4,b=e(this.dict.t,this.dict),F=0;7>F;F++)moment.lang(S),C[F]=moment(x).day(F+D).format("ddd"),moment.lang(O),M[F]=moment(x).day(F+D).format("ddd"),T[F]=moment(x).day(F+D).format("dddd");moment.lang(S),f=moment(x).format("ddd"),y=t[f],moment.lang(O),u(y);var I=[],q=0,E=0,j=[];if(_.each(t,function(t){t&&t.working_hours&&(q++,_.isEqual(t,_.last(I))||I.push(t))}),E=I.length,7>q&&E++,E>2)v.week=d(t);else if(1===E)v.week={evently:[g(t[C[0]],t)]};else{for(F=0;E>F;F++)if(j[F]=0,I[F])for(var B=_.pluck(s(I[F]),"time"),U=0;U<B.length;U+=2){var W=i(B[U+1])+o(B[U+1])/60-(i(B[U])+o(B[U])/60);j[F]+=W}else I[F]=null;var Y=_.sortBy(I,function(t,n){return j[n]});v.week={evently:m(Y,t)}}return v.comment=t.comment,v.week&&v.week.evently&&1===v.week.evently.length&&(v.everyday=v.week.evently[0].everyday),v}},forecast:function(t,n){var e,l,i="",o={},a=n&&n.maxHours||1;return t?t.always?{today:{text:this.dict.t(this.localLang,"aroundTheClock")},open:!0}:(t.will&&t.will.h<a&&(t.will.h&&(i+=this.dict.t(this.localLang,"nHours",t.will.h)+" "),t.will.m&&(i+=this.dict.t(this.localLang,"nMins",t.will.m))),t.today?(o.text=this.dict.t(this.localLang,"today"),t.everyday&&(o.text=this.dict.t(this.localLang,"everyday")),o.from=t.today.from,o.to=t.today.to,o.lunch=t.lunch,o.lunch&&(o.lunchStr=this.dict.t(this.localLang,"lunch"))):o.text=this.dict.t(this.localLang,"todayIsRestDay"),t.always||t.today&&t.today.alltime?(o.text=this.dict.t(this.localLang,"aroundTheClock"),e=!0):t.now&&(e=t.now.open,l=e?t.will&&"lunch"===t.will.willType?t.will&&t.will.h<a?this.dict.t(this.localLang,"in")+" "+this.dict.t(this.localLang,"nMins",i)+this.dict.t(this.localLang,"isClosingOnDinner"):this.dict.t(this.localLang,"isOpen"):t.will.h<a?this.dict.t(this.localLang,"closeIn")+this.dict.t(this.localLang,"nMins",i):this.dict.t(this.localLang,"isOpen"):t.will&&t.will.when?this.dict.t(this.localLang,"open")+t.will.when:t.now&&t.now.lunch?t.will.h<a?this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",i):this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openAt")+t.will.till:t.will&&t.will.h<a?this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",i):this.dict.t(this.localLang,"openAt")+t.will.till),{today:o,now:l,open:e,week:t.week,comment:t.comment,everyday:t.everyday}):{}}};FirmCard.prototype.dict={t:function(e,n,o){var a,r,t,s=!1;return"undefined"==typeof this[e]&&(e="ru"),r=this[e][n],(s="undefined"!=typeof r)?(a=s?r:n,void 0!==o&&(o=parseInt(o,10),o=isNaN(o)?0:o,t=this[e].pluralRules(o),a=o+" "+r[t]),a?a:n):n},ru:{pluralRules:function(e){return e%10===1&&e%100!==11?0:e%10>=2&&4>=e%10&&e%10%1===0&&(12>e%100||e%100>14)?1:e%10===0||e%10>=5&&9>=e%10&&e%10%1===0||e%100>=11&&14>=e%100&&e%100%1===0?2:void 0},btnBack:"Назад",btnFindWay:"Проехать сюда",btnEntrance:"Найти вход",linkReviews:["отзыв","отзыва","отзывов"],linkPhoto:["фото","фото","фото"],linkBooklet:"Буклет",tommorow:"завтра",afterTommorow:"послезавтра",afterWeek:"через неделю",nextSun:"в воскресенье",nextMon:"в понедельник",nextTue:"во вторник",nextWed:"в среду",nextThu:"в четверг",nextFri:"в пятницу",nextSat:"в субботу",willOpen:"откроется",willClose:"закроется",isOpen:"Открыто",openTill:"Открыто до ",closeIn:"Закроется через ",openAt:"Откроется в ",openIn:"Откроется через ",open:"Откроется ",nHours:["час","часа","часов"],nMins:["минуту","минуты","минут"],lunch:"обед",Lunch:"Обед. ",workingDays:"Рабочие дни",weekdays:"Будние дни",restDay:"выходной",reviewsOnFlamp:"Отзывы на Флампе",writeReviewOnFlamp:"Написать отзыв на Флампе",payment:"оплата",everyday:"Ежедневно c",worksAroundTheClock:"Работает круглосуточно",aroundTheClock:"Круглосуточно",knowMore:"узнать больше",toClose:"до закрытия",monday:"понедельник",tuesday:"вторник",wednesday:"среда",thursday:"четверг",friday:"пятница",saturday:"суббота",sunday:"воскресенье",toLunch:"до обеда",today:"Сегодня",lessThenHour:"менее часа",youCouldLate:"вы можете не успеть",workingTime:"рабочее время",showAllOrgInRubric:"Показать все организации рубрики",todayIsRestDay:"Сегодня выходной",internet:"Оплата через Интернет",noncash:"Безналичный расчет",goldcrown:"Золотая Корона",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Наличный расчет",americanexpress:"American Express",hour:"час",less:"менее",_in:"Через",isClosingOnDinner:" закрывается на обед"},it:{pluralRules:function(e){return 1===e?0:1},btnBack:"Indietro",btnFindWay:"Come arrivare ",btnEntrance:"Trova l'ingresso",linkReviews:["recensione","recensioni"],linkPhoto:["fotografia","fotografie"],linkBooklet:"Sull'azienda",tommorow:"domani",afterTommorow:"dopodomani",afterWeek:"tra una settimana",nextSun:"la domenica",nextMon:"il lunedi",nextTue:"il martedì",nextWed:"il mercoledì",nextThu:"il giovedi",nextFri:"il venerdì",nextSat:"il sabato",willOpen:"apre",willClose:"ciuso",isOpen:"Aperto",openTill:"Aperto fino alle ",closeIn:"Chiude tra ",openAt:"Apre alle ",openIn:"Apre tra ",open:"Apre ",nHours:["ora","ore"],nMins:["minuto","minuti"],lunch:"pausa pranzo",Lunch:"Pausa pranzo. ",workingDays:"Giorni feriali",weekdays:"Giorni feriali",restDay:"chiusura",reviewsOnFlamp:"Recensioni su Flamp",writeReviewOnFlamp:"Scrivi una recensione su Flamp",payment:"pagamento",everyday:"Ogni giorno dalole",worksAroundTheClock:"Operativo 24 ore su 24",aroundTheClock:"24 ore su 24",knowMore:"ulteriori informazioni",toClose:"fino alla chiusura",monday:"lunedi",tuesday:"martedì",wednesday:"mercoledì",thursday:"giovedi",friday:"venerdì",saturday:"sabato",sunday:"domenica",toLunch:"fino alla pausa pranzo",today:"Oggi",lessThenHour:"meno di un'ora",youCouldLate:"affrettarsi, chiusura imminente",workingTime:"orario di lavoro",showAllOrgInRubric:"Visualizza tutte le aziende della categoria",todayIsRestDay:"oggi chiuso",internet:"Pagamento on-line",noncash:"Pagamento non in contanti",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"MasterCard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pagamento in contanti",americanexpress:"American Express",hour:"un'ora",less:"meno di",_in:"Tra",isClosingOnDinner:"chiude per pausa pranzo"},en:{pluralRules:function(e){return 1===e?0:1},btnBack:"Back",btnFindWay:"Get here",btnEntrance:"Find entrance",linkReviews:["review","reviews"],linkPhoto:["photo","photos"],linkBooklet:"About company",tommorow:"tomorrow",afterTommorow:"the day after tomorrow",afterWeek:"in a week",nextSun:"on Sunday",nextMon:"on Monday",nextTue:"on Tuesday",nextWed:"on Wednesday",nextThu:"on Thursday",nextFri:"on Friday",nextSat:"on Saturday",willOpen:"opens",willClose:"closes",isOpen:"Open",openTill:"Open till ",closeIn:"Closes in ",openAt:"Opens at ",openIn:"Opens in",open:"Opens",nHours:["hour","hours"],nMins:["minute","minutes"],lunch:"lunch break",Lunch:"Lunch break. ",workingDays:"Working days",weekdays:"Weekdays",restDay:"day off",reviewsOnFlamp:"Reviews on Flamp",writeReviewOnFlamp:"Write a review on Flamp",payment:"payment",everyday:"Daily from",worksAroundTheClock:"Open 24 hours",aroundTheClock:"24h",knowMore:"see also",toClose:"until closing",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",toLunch:"until lunch",today:"Today",lessThenHour:"less then one hour",youCouldLate:"you might be late",workingTime:"working hours",showAllOrgInRubric:"Show all organizations in the category",todayIsRestDay:"closed today",internet:"Online",noncash:" No-cash",goldcrown:"Golden Crown",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Cash",americanexpress:"American Express",hour:"hour",less:"less",_in:"In",isClosingOnDinner:"will be closing for lunch"},cs:{pluralRules:function(e){return 1===e?0:e>=2&&4>=e?1:2},btnBack:"Zpět",btnFindWay:"Jet sem",btnEntrance:"Hledat vstup",linkReviews:["recenze","recenze","recenzí"],linkPhoto:["fotografie","fotografie","fotografií"],linkBooklet:"Leták",tommorow:"zítra",afterTommorow:"pozítří",afterWeek:"za týden",nextSun:"v neděli",nextMon:"v pondělí",nextTue:"v úterý",nextWed:"ve středu",nextThu:"ve čtvrtek",nextFri:"v pátek",nextSat:"v sobotu",willOpen:"otevře se",willClose:"zavře se",isOpen:"Otevřeno",openTill:"Otevřeno do ",closeIn:"Zavře se za ",openAt:"Otevře se v ",openIn:"Otevře se za ",open:"Otevře se ",nHours:["hodinu","hodiny","hodin"],nMins:["minutu","minuty","minut"],lunch:"polední přestávka",Lunch:"Polední přestávka. ",workingDays:"Všední dny",weekdays:"Všední dny",restDay:"zavřeno",reviewsOnFlamp:"Recenze na Flampu",writeReviewOnFlamp:"Napsat recenzi na Flampu",payment:"platba",everyday:"Denně od ",worksAroundTheClock:"Pracuje nonstop",aroundTheClock:"Nonstop",knowMore:"dozvědět se více",toClose:"do uzavření",monday:"pondělí",tuesday:"úterý",wednesday:"středa",thursday:"čtvrtek",friday:"pátek",saturday:"sobota",sunday:"neděle",toLunch:"do polední přestávky",today:"Dnes",lessThenHour:"méně než hodinu",youCouldLate:"nemusíte to stihnout",workingTime:"pracovní doba",showAllOrgInRubric:"Zobrazit všechny organizace v rubrice",todayIsRestDay:"Dnes je zavřeno",internet:"Platba prostřednictvím Internetu",noncash:"Bezhotovostní platba",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Platba hotově",americanexpress:"American Express",hour:"hodinu",less:"méně",_in:"Za",isClosingOnDinner:"začíná polední přestávka"},sp:{pluralRules:function(e){return 1===e?0:e>=2&&4>=e?1:2},btnBack:"Atrás",btnFindWay:"Ir para allá",btnEntrance:"Buscar acceso",linkReviews:["comentario","comentarios","comentarios"],linkPhoto:["foto","fotos","fotos"],linkBooklet:"Folleto",tommorow:"mañana",afterTommorow:"pasado mañana",afterWeek:"en una semana más",nextSun:"el domingo",nextMon:"el lunes",nextTue:"el martes",nextWed:"el miércoles",nextThu:"el jueves",nextFri:"el viernes",nextSat:"el sábado",willOpen:"se abrirá",willClose:"se cerrará",isOpen:"Abierto",openTill:"Abierto hasta ",closeIn:"Se cerrará dentro de ",openAt:"Se abrirá el ",openIn:"Se abrirá dentro de ",open:"Se abrirá ",nHours:["hora","horas","horas"],nMins:["minuto","minutos","minutos"],lunch:"hora de colación",Lunch:"Hora de colación. ",workingDays:"Días laborables",weekdays:"Días laborables",restDay:"cerrado",reviewsOnFlamp:"Comentarios en Flamp",writeReviewOnFlamp:"Escribir un comentario en Flamp",payment:"pago",everyday:"Cada día desde",worksAroundTheClock:"Abierto las 24 horas",aroundTheClock:"24 horas",knowMore:"para saber más",toClose:"hasta el cierre",monday:"lunes",tuesday:"martes",wednesday:"miércoles",thursday:"jueves",friday:"viernes",saturday:"viernes",sunday:"domingo",toLunch:"antes de la hora de colación",today:"Hoy",lessThenHour:"menos de una hora",youCouldLate:"puede ser que no alcanzas a llegar",workingTime:"horario de trabajo",showAllOrgInRubric:"Mostrar todas las empresas de la categoría",todayIsRestDay:"Hoy cerrado",internet:"Pago por Internet",noncash:"Pago sin efectivo",goldcrown:"Zolotaya Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pago en efectivo",americanexpress:"American Express",hour:"hora",less:"menos de",_in:"Dentro de",isClosingOnDinner:"se cierra por hora de colación"}};DG.Traffic=DG.TileLayer.extend({options:{errorTileUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",subdomains:"012345679",period:0,detectRetina:!0,maxNativeZoom:18},statics:{tileUrl:"http://traffic{s}.2gis.ru/{projectCode}/traffic/{z}/{x}/{y}/speed/{period}/"},initialize:function(t){DG.TileLayer.prototype.initialize.call(this,DG.Traffic.tileUrl,t)},onAdd:function(t){var e=t.projectDetector.getProject();e&&e.traffic?this._setProjectOptions(e):this._setNullOptions(),this._handler=new DG.Traffic.Handler(t,this.options),this._handler.enable(),DG.TileLayer.prototype.onAdd.call(this),t.on(this._projectEvents,this)},onRemove:function(t){t.off(this._projectEvents,this),this._handler.disable(),DG.TileLayer.prototype.onRemove.call(this,t)},setPeriod:function(t){DG.setOptions(this,{period:t}),this.redraw()},_setNullOptions:function(){DG.setOptions(this,{minZoom:0,maxZoom:0})},_setProjectOptions:function(t){DG.setOptions(this,{projectCode:t.code,minZoom:t.min_zoom_level,maxZoom:t.max_zoom_level,bounds:t.LatLngBounds})},_projectEvents:{projectchange:function(t){var e=t.getProject();e.traffic?this._setProjectOptions(e):this._setNullOptions(),this.redraw()},projectleave:function(){this._setNullOptions(),this.redraw()}}});DG.Map.mergeOptions({traffic:!1}),DG.Traffic.Handler=DG.Handler.extend({options:{disableLabel:!1},initialize:function(e,t){this._map=e,DG.Util.setOptions(this,t)},addHooks:function(){this._map.on(this._mapEventsListeners,this),this._map.meta.enableTrafficListening(),this.options.disableLabel||(this._labelHelper=DG.label())},removeHooks:function(){this._map.off(this._mapEventsListeners,this),this._map.off("mousemove",this._onMouseMove,this),this._map.meta.disableTrafficListening(),this._labelHelper&&(this._map.removeLayer(this._labelHelper),this._labelHelper=null)},_mapEventsListeners:{traffichover:function(e){this._setCursor("pointer"),this._labelHelper&&e.traffic.speed&&(this._labelHelper.setPosition(e.latlng).setContent(e.traffic.speed+" км/ч"),this._map.on("mousemove",this._onMouseMove,this).addLayer(this._labelHelper))},trafficleave:function(){this._setCursor("auto"),this._labelHelper&&this._map.off("mousemove",this._onMouseMove,this).removeLayer(this._labelHelper)}},_onMouseMove:function(e){this._labelHelper.setPosition(e.latlng)},_setCursor:function(e){this._map.getContainer().style.cursor=e}}),DG.Map.addInitHook("addHandler","traffic",DG.Traffic.Handler);DG.Ruler=DG.Layer.extend({options:{editable:!0},includes:[DG.Locale],statics:{Dictionary:{}},initialize:function(t,e){DG.Util.setOptions(this,e),this._layers={back:null,middle:null,front:null,mouse:null},this._points=[],this._layersContainer=DG.featureGroup(),Object.keys(this._layers).forEach(function(t){this._layersContainer.addLayer(this._layers[t]=DG.featureGroup())},this),this._reset(),DG.Browser.touch?(delete this._lineMouseEvents.mouseover,delete this._lineMouseEvents.mouseout,delete this._lineMouseEvents.mousemove):delete this._lineMouseEvents.click,t&&t.length&&this.setLatLngs(t)},onAdd:function(t){this._map=t.on("langchange",this._updateDistance,this),this._maxLat=t.unproject([0,0],0).lat,this._map.getPane("rulerLabelPane")||this._map.createPane("rulerLabelPane"),this._map.getPane("rulerEventPane")||this._map.createPane("rulerEventPane"),this._layersContainer.addTo(this._map),this._points.length&&(this._layers.mouse.fire("layeradd"),this._updateDistance()),this._layers.mouse.on(this._lineMouseEvents,this)},onRemove:function(t){t.off("langchange",this._updateDistance,this).removeLayer(this._layersContainer),this._layers.mouse.off(this._lineMouseEvents,this),this._reset()},getTotalDistance:function(){return this._calcDistance()},spliceLatLngs:function(t){var e=this._points.length,n=t>=0?Math.min(t,e):e-t,i=Array.prototype.splice.apply(this._points,arguments).map(function(t){return this._layers.mouse.removeLayer(t),t.off().getLatLng()},this),s=this._points.length;if(s){for(var a=n;s>a;a++)this._points[a]instanceof DG.Ruler.LayeredMarker||(this._points[a]=this._createPoint(this._points[a],this.options.iconStyles.large).on(this._pointEvents,this).once("add",this._addCloseHandler,this).addTo(this._layers.mouse,this._layers)),a&&!this._points[a-1]._legs&&this._addLegs(this._points[a-1]),this._points[a].setPointStyle(this.options.iconStyles[a&&s-1>a?"small":"large"]),this._points[a]._pos=a;this._removeLegs(this._points[s-1]),e>0&&s>e&&this._points[e-1].collapse(),this._points[n]&&this._updateLegs(this._points[n]),n>1&&this._points[n-1].setPointStyle(this.options.iconStyles.small),this._updateDistance()}return DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._fireChangeEvent(),i},addLatLng:function(t){var e=this._points[this._points.length-1]||null,t=DG.latLng(t);if(t.lat=Math.max(Math.min(this._maxLat,t.lat),-this._maxLat),e){var n=e.getLatLng(),i=t.wrap(),s=n.wrap(),a=i.lng-s.lng;Math.abs(t.lng-n.lng)>180&&(t.lng=n.lng+a,a=t.lng-n.lng,Math.abs(a-360)<Math.abs(a)&&(t.lng-=360))}return this.spliceLatLngs(this._points.length,0,t),this},getLatLngs:function(){return this._points.map(function(t){return t.getLatLng()})},setLatLngs:function(t){var e=t.slice();return e.unshift(0,this._points.length),this.spliceLatLngs.apply(this,e),this},_reset:function(){DG.extend(this,{_lineMarkerHelper:null,_morphingNow:!1})},_lineMouseEvents:{click:function(t){var e=t.layer;if(e instanceof DG.Marker&&e._pos!==this._points.length-1)this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),e.setText(this._getFormatedDistance(e)),this._lineMarkerHelper=e;else if(e instanceof DG.Path&&this.options.editable){var n=t.latlng,i=e._point._pos+1;this.spliceLatLngs(i,0,n)}},mouseover:function(t){var e=t.layer;if(e._hovered=!0,!this._morphingNow)if(e instanceof DG.Marker&&e._pos!==this._points.length-1)e.setText(this._getFormatedDistance(e));else if(e instanceof DG.Path&&!this._lineMarkerHelper){var n=e._point;this._lineMarkerHelper=this._addRunningLabel(this._interpolate(n.getLatLng(),this._points[n._pos+1].getLatLng(),t.latlng),n)}},mouseout:function(t){var e=t.layer,n=t.originalEvent;e._hovered=!1,this._morphingNow||e._pos===this._points.length-1||(e instanceof DG.Marker?(!n.relatedTarget||n.relatedTarget!==e.querySelector("container")&&n.relatedTarget.parentNode!==e.querySelector("container"))&&e.collapse():this._removeRunningLabel())},mousemove:function(t){if(!this._morphingNow&&this._lineMarkerHelper){var e=t.layer._point,n=this._interpolate(e.getLatLng(),this._points[e._pos+1].getLatLng(),t.latlng);this._lineMarkerHelper.setLatLng(n).setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(n)))}},layeradd:function(){Object.keys(this._layers).forEach(function(t){this._layers[t].bringToFront()},this)}},_fireChangeEvent:function(){this.fire("changed",{latlngs:this.getLatLngs()})},_addRunningLabel:function(t,e){var n=this._createPoint(t).addTo(this._layers.mouse,this._layers);return this._map.getPane("rulerLabelPane").appendChild(n._icon),n.setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(t)))},_removeRunningLabel:function(){this._lineMarkerHelper&&(this._layers.mouse.removeLayer(this._lineMarkerHelper),this._lineMarkerHelper=null)},_insertPointInLine:function(t){var e,n=this._lineMarkerHelper.getLatLng(),i=t.target._point._pos+1;if(L.Browser.ie){var s=t.originalEvent.target||t.originalEvent.srcElement,a=s.parentNode;a.appendChild(s)}if(L.DomEvent.stopPropagation(t.originalEvent),this.spliceLatLngs(i,0,n),e=this._points[i],e.setText(this._getFormatedDistance(e)),document.createEvent){var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!1,!1,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,1,e._icon),e._icon.dispatchEvent(o)}else e._icon.fireEvent("onMouseDown",DG.extend(document.createEventObject(),{button:1,bubbles:!1,cancelable:!1}));this._removeRunningLabel(),this._updateLegs(e)},_interpolate:function(t,e,n){var i=this._map.latLngToLayerPoint(t),s=this._map.latLngToLayerPoint(e),a=this._map.latLngToLayerPoint(n),o=(s.x-i.x)/(s.y-i.y),r=i.x-o*i.y;return isNaN(o)?n:(isFinite(o)?(a.y=(a.y+o*a.x-o*r)/(o*o+1),a.x=o*a.y+r):a.y=s.y,this._map.layerPointToLatLng(a))},_addCloseHandler:function(t){t.target.on("click",this._deletePoint,this).querySelector("delete").style.display="inline-block"},_createPoint:function(t,e){var n=e?e:this.options.iconStyles.large,i={};return Object.keys(n).forEach(function(e){i[e]=DG.circleMarker(t,n[e])}),DG.Ruler.layeredMarker(t,{layers:i,draggable:this.options.editable})},_pointEvents:{drag:function(t){var e=t.target,n=e.getLatLng(),i=this._points[e._pos-1]||null,s=n.wrap();if(i){var a=i.getLatLng(),o=a.wrap(),r=s.lng-o.lng;Math.abs(n.lng-a.lng)>180&&(s.lng=a.lng+r,r=s.lng-a.lng,Math.abs(r-360)<Math.abs(r)&&(s.lng-=360))}s.lat=Math.max(Math.min(this._maxLat,s.lat),-this._maxLat),n.equals(s)||e.setLatLng(s),DG.Browser.touch||e===this._points[this._points.length-1]||e.setText(this._getFormatedDistance(e)),this._updateLegs(e),this._updateDistance()},dragend:function(t){var e=t.target;this._morphingNow=!1,e._hovered||e===this._points[this._points.length-1]||e.collapse(),this._fireChangeEvent()},dragstart:function(){DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._morphingNow=!0}},_deletePoint:function(t){var e=t.originalEvent,n=e.target||e.srcElement;"dg-ruler-label__delete"===n.className&&(DG.DomEvent.stop(t.originalEvent),this.spliceLatLngs(t.target._pos,1))},_addLegs:function(t){var e=[t.getLatLng(),this._points[t._pos+1].getLatLng()],n=this.options.pathStyles;t._legs={},Object.keys(n).forEach(function(i){t._legs[i]=DG.polyline(e,n[i]).addTo(this._layers[i])},this),t._legs.mouse._point=t.once("remove",this._clearRemovingPointLegs,this),this.options.editable&&!DG.Browser.touch&&t._legs.mouse.on("mousedown",this._insertPointInLine,this),this._map&&this._layers.mouse.addLayer(t._legs.mouse)},_clearRemovingPointLegs:function(t){this._removeLegs(t.target)},_removeLegs:function(t){t._legs&&(Object.keys(t._legs).forEach(function(e){this._layers[e].removeLayer(t._legs[e])},this),t._legs=null)},_updateLegs:function(t){var e=t.getLatLng(),n=this._points[t._pos-1];n&&Object.keys(n._legs).forEach(function(t){n._legs[t].spliceLatLngs(1,1,e)}),t._legs&&Object.keys(t._legs).forEach(function(n){t._legs[n].spliceLatLngs(0,1,e)})},_calcDistance:function(t,e){for(var n=e?e:0,i=t?t._pos:this._points.length-1,s=0;i>s;s++)n+=this._points[s].getLatLng().distanceTo(this._points[s+1].getLatLng());return n},_getFormatedDistance:function(){var t=this._calcDistance.apply(this,arguments),e="m";return t>1e3?(t/=1e3,e="km",t>1e3?(t=t.toFixed(),t=t.slice(0,-3)+" "+t.slice(-3)):t=t.toFixed(2).split(".").join(this.t("delimiter"))):t=Math.round(t),[t||0," ",this.t(e)].join("")},_updateDistance:function(){this._map&&this._points.length&&this._points[this._points.length-1].setText(this._getFormatedDistance())}}),DG.ruler=function(t,e){return new DG.Ruler(t,e)};DG.Ruler.LayeredMarker=DG.Marker.extend({options:{draggable:!1,keyboard:!1,riseOnHover:!0,iconHTML:DG.dust(JSON.parse('{"RulerLayeredMarker":"(function(){dust.register(\\"RulerLayeredMarker\\",body_0);function body_0(chk,ctx){return chk.write(\\"<img class=\\\\\\"dg-ruler-label__spacer\\\\\\" src=\\\\\\"\\").reference(ctx.get([\\"blankgif\\"], false),ctx,\\"h\\").write(\\"\\\\\\" width=\\\\\\"26\\\\\\" height=\\\\\\"26\\\\\\" /><div class=\\\\\\"dg-ruler-label__container\\\\\\"><div class=\\\\\\"dg-ruler-label__point\\\\\\"></div><span class=\\\\\\"dg-ruler-label__distance\\\\\\">0 км</span><span class=\\\\\\"dg-ruler-label__delete\\\\\\"></span></div>\\");}return body_0;})();"}'))("RulerLayeredMarker",{blankgif:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})},statics:{domClass:"dg-ruler-label"},addTo:function(e,t){return Object.keys(this._layers).forEach(function(e){t[e].addLayer(this._layers[e])},this),this._viewport=t,DG.Marker.prototype.addTo.call(this.on("move",this._onMove),e)},onRemove:function(e){return Object.keys(this._layers).forEach(function(e){this._viewport[e].removeLayer(this._layers[e])},this),this.off("move",this._onMove),this._viewport=null,this._style=null,DG.Marker.prototype.onRemove.call(this,e)},setText:function(e){return this._iconCollapsed&&this.expand(),this._iconNodes.label.innerHTML=e,this},setPointStyle:function(e){return this._style!==e&&Object.keys(this._style=e).forEach(function(t){this._layers[t].setStyle(e[t])},this),this},expand:function(){return this._iconCollapsed=!1,this._iconNodes.container.style.display="block",this._iconNodes.spacer.style.display="none",this},collapse:function(){return this._iconCollapsed=!0,this._iconNodes.container.style.display="none",this._iconNodes.spacer.style.display="block",this},querySelector:function(e){return this._icon.querySelector("."+DG.Ruler.LayeredMarker.domClass+"__"+e)},_onMove:function(e){var t=e.latlng;Object.keys(this._layers).forEach(function(e){this._layers[e].setLatLng(t)},this)},_initIcon:function(){DG.Marker.prototype._initIcon.call(this),this._iconCollapsed=!0,this._icon.style.width="",this._iconNodes={label:this.querySelector("distance"),spacer:this.querySelector("spacer"),container:this.querySelector("container")}},_afterInit:function(){this._layers=this.options.layers||null,this.options.icon=DG.divIcon({className:DG.Ruler.LayeredMarker.domClass,iconSize:[26,26],iconAnchor:[13,13],html:this.options.iconHTML})}}),DG.Ruler.LayeredMarker.addInitHook("_afterInit"),DG.Ruler.layeredMarker=function(e,t){return new DG.Ruler.LayeredMarker(e,t)};DG.Ruler.mergeOptions({pathStyles:{back:{color:"#fff",opacity:1,weight:12,pointerEvents:"none",noClip:!0},middle:{color:"#0da5d5",opacity:1,weight:4,pointerEvents:"none",noClip:!0},mouse:{color:"#fff",opacity:DG.Browser.vml?.1:0,weight:DG.Browser.touch?30:20,pointerEvents:"painted",noClip:!0,renderer:DG.svg({pane:"rulerEventPane"})}},iconStyles:{large:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:13},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:9},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:5}},small:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:9},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:5},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:2}}}});DG.Ruler.Dictionary.ru={km:"км",m:"м",delimiter:"."};DG.Ruler.Dictionary.it={km:"km",m:"m",delimiter:","};DG.Ruler.Dictionary.cs={km:"km",m:"m",delimiter:","};DG.Ruler.Dictionary.en={km:"km",m:"m",delimiter:","};DG.Control.Ruler=DG.RoundControl.extend({options:{position:DG.Browser.touch?"topright":"topright",iconClass:"ruler"},statics:{Dictionary:{}},initialize:function(t){DG.setOptions(this,t),DG.extend(this,{_active:!1,_drawingHelper:null,_geoclickerNeedRestore:!1}).on(this._controlEvents,this)},_controlEvents:{add:function(){this._drawingHelper=DG.ruler([])},click:function(){(this._active=!this._active)?(this.setState("active"),this._startDrawing()):(this.setState(""),this._finishDrawing())},remove:function(){this.off(this._controlEvents,this),this._active&&(this._map.removeLayer(this._drawingHelper),this._active=!1),this._drawingHelper=null}},_startDrawing:function(){this._map.addLayer(this._drawingHelper).on("click",this._handleMapClick,this),(this._geoclickerNeedRestore=this._map.geoclicker.enabled())&&this._map.geoclicker.disable()},_finishDrawing:function(){this._map.off("click",this._handleMapClick,this).removeLayer(this._drawingHelper),this._drawingHelper.setLatLngs([]),this._geoclickerNeedRestore&&this._map.geoclicker.enable()},_handleMapClick:function(t){this._drawingHelper.addLatLng(t.latlng)},_renderTranslation:function(){this._link.title=this.t("button_title")}}),DG.control.ruler=function(t){return new DG.Control.Ruler(t)};DG.Control.Ruler.Dictionary.ru={button_title:"Линейка"};DG.Control.Ruler.Dictionary.it={button_title:"Righello"};DG.Control.Ruler.Dictionary.cs={button_title:"Pravítko"};DG.Control.Ruler.Dictionary.en={button_title:"Ruler"};DG.projectsList = JSON.parse('[{"code":"nicosia","minZoom":11,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[35.1987707992976,33.2687509662567],[35.0319573115252,33.444017180855]]},{"code":"limassol","minZoom":11,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[34.7703607532978,32.8183135920874],[34.5438286066823,33.1907346326479]]},{"code":"praha","minZoom":10,"maxZoom":18,"timeOffset":120,"traffic":null,"bound":[[50.1810860167697,14.2155277221934],[49.9348968592983,14.7152445225123]]},{"code":"santiago","minZoom":9,"maxZoom":18,"timeOffset":-180,"traffic":null,"bound":[[-33.2933344386246,-70.8571559326759],[-33.6656911332218,-70.477275853484]]},{"code":"padova","minZoom":9,"maxZoom":18,"timeOffset":120,"traffic":null,"bound":[[45.733676894531,11.3550232420912],[45.0713376120054,12.6119895276371]]},{"code":"abakan","minZoom":9,"maxZoom":18,"timeOffset":480,"traffic":null,"bound":[[53.9015991783199,91.1443354820045],[53.5690755348627,91.8266893298874]]},{"code":"almaty","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[43.4691062728438,76.7159906079459],[43.1080512298167,77.1084003103972]]},{"code":"armawir","minZoom":9,"maxZoom":17,"timeOffset":240,"traffic":null,"bound":[[45.2494434710022,40.8594002590691],[44.7217907137017,41.3225777015129]]},{"code":"arkhangelsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[64.8299663594085,39.4581178646537],[64.2843046637163,41.3211748549048]]},{"code":"astrakhan","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[46.5114180332153,47.8630461031191],[46.2412594424995,48.1858117765388]]},{"code":"barnaul","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[53.4866943332863,83.4457915421126],[53.1585977185895,84.0879338133862]]},{"code":"belgorod","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[50.7012708979842,36.4192775789588],[50.4896543997067,36.7297789382699]]},{"code":"biysk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[52.6467045850268,84.5688944220223],[51.8999054497981,85.4924852888349]]},{"code":"blagoveshensk","minZoom":9,"maxZoom":18,"timeOffset":600,"traffic":null,"bound":[[50.6016337995515,127.345035031789],[50.2234615060572,127.764412544165]]},{"code":"bratsk","minZoom":9,"maxZoom":18,"timeOffset":540,"traffic":null,"bound":[[56.5026192394777,101.059737892132],[55.9299233950519,102.059776879738]]},{"code":"bryansk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.4315561076653,34.1154331064172],[53.1385223432934,34.6044250273834]]},{"code":"v_novgorod","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[58.6836311433635,31.1313939673071],[58.460419032672,31.5146936934116]]},{"code":"vladivostok","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[43.6161503849791,131.558590917919],[42.8034461532445,132.343684662068]]},{"code":"vladimir","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.4678197302654,40.1651931755232],[56.0282399334087,40.6951681216888]]},{"code":"volgograd","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[48.926670316375,43.9705863650486],[48.3141239996045,44.9308652223579]]},{"code":"vologda","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[59.3372883440336,39.6083029151405],[59.1505226260905,40.0779393502863]]},{"code":"voronezh","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.9109946780922,38.991158599251],[51.4755906110023,39.6130839292656]]},{"code":"gornoaltaysk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[52.1564900132681,85.484610371617],[51.2492150337467,86.4583690517566]]},{"code":"dnepropetrovsk","minZoom":9,"maxZoom":18,"timeOffset":120,"traffic":null,"bound":[[48.6134306493271,34.7377337368383],[48.3416398323942,35.2804085323086]]},{"code":"donetsk","minZoom":9,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[48.1899246968246,37.5105114766436],[47.7957685401294,38.2461880381853]]},{"code":"ekaterinburg","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[57.0360972497062,60.2323966049092],[56.5987021059971,60.9432235390061]]},{"code":"ivanovo","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.0895563231668,40.7975852131989],[56.8913132671641,41.1894046504891]]},{"code":"izhevsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.0578889623075,52.9319474531077],[56.667542646897,53.4956246123276]]},{"code":"irkutsk","minZoom":9,"maxZoom":18,"timeOffset":540,"traffic":null,"bound":[[52.6495505470413,103.61885265925],[51.7104431825847,104.970806765863]]},{"code":"yoshkarola","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.7614824238658,47.5724319594027],[56.5075290418687,48.1532971643141]]},{"code":"kazan","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":true,"bound":[[55.9985321999877,48.2911801344625],[55.5666240080291,49.5354766561195]]},{"code":"kaliningrad","minZoom":9,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[55.0555187125862,19.8390821712989],[54.5341370915503,20.6635158806876]]},{"code":"kaluga","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.768523303849,35.8948119960599],[54.321023875665,36.4822327020629]]},{"code":"karaganda","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[50.1326228965457,72.8600516728832],[49.6499299479317,73.4106297758395]]},{"code":"kemerovo","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[55.5340608911615,85.9450122062621],[55.2625138080209,86.2636635398232]]},{"code":"kirov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[58.7970043097645,49.0367663786028],[58.4004858362436,49.9477913096825]]},{"code":"komsomolsk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[50.7214129619197,136.772703975404],[50.1898152981203,137.25849332936]]},{"code":"kostroma","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.9243829139543,40.7214314515157],[57.67573203432,41.1518646193995]]},{"code":"krasnodar","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[45.2653815276283,38.6500825330806],[44.9435556403579,39.3785683912585]]},{"code":"krasnoyarsk","minZoom":9,"maxZoom":18,"timeOffset":480,"traffic":true,"bound":[[56.3082630018158,92.1268459382326],[55.8114064072845,93.5992902134282]]},{"code":"kurgan","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[55.5302725837859,65.154661854512],[55.3686573232533,65.4828564327176]]},{"code":"kursk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.8427867070403,35.8893687666608],[51.5567989765477,36.4353464063142]]},{"code":"lenkuz","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[54.7742516260722,85.750103030145],[54.1794040086072,86.502902682772]]},{"code":"lipetsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[52.7198786376779,39.3744800918884],[52.4905468986541,39.8233601260659]]},{"code":"magnitogorsk","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[53.9270251812668,58.5231189866109],[53.229864600768,59.5042256487398]]},{"code":"miass","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[55.2802176970506,59.5219849332694],[54.8881930582153,60.2583981001619]]},{"code":"moscow","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.1094645977258,36.7589630188729],[55.1040131369395,38.2250238758651]]},{"code":"nabchelny","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[55.8651827397231,51.7114250622956],[55.5366753807398,52.6281801079216]]},{"code":"nahodka","minZoom":10,"maxZoom":17,"timeOffset":660,"traffic":null,"bound":[[42.9073312963002,132.750811365032],[42.7221230837219,133.039450970885]]},{"code":"nizhnevartovsk","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[61.1909352794372,75.9222574752004],[60.8511814719134,77.0285826533205]]},{"code":"n_novgorod","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.477411442321,43.2970731741298],[56.0722356112843,44.254810900154]]},{"code":"ntagil","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[58.0917067294675,59.7631849308233],[57.7492987364741,60.3478866058688]]},{"code":"novokuznetsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[54.1214727777433,86.5106241243864],[53.4975544807196,87.463656218798]]},{"code":"novorossiysk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[45.2228043807585,36.9363062359741],[44.3059631288764,38.6732772531146]]},{"code":"novosibirsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":true,"bound":[[55.2490377237671,82.5066233224136],[54.5530320115648,83.3965344854664]]},{"code":"norilsk","minZoom":9,"maxZoom":18,"timeOffset":480,"traffic":null,"bound":[[69.5621896177523,87.2622339743829],[69.2428195922557,88.5071759113989]]},{"code":"noyabrsk","minZoom":9,"maxZoom":17,"timeOffset":360,"traffic":null,"bound":[[63.8791873127812,74.3047801716227],[63.0182507475118,76.2633721430807]]},{"code":"odessa","minZoom":9,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[46.6567177224677,30.5121680865866],[46.2534222532502,30.9112859230213]]},{"code":"omsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[55.4176310259015,72.8835180581471],[54.7851241105205,73.7716648340022]]},{"code":"orenburg","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[51.9359751569834,54.9204112369225],[51.6634793355125,55.4962313546675]]},{"code":"orel","minZoom":9,"maxZoom":17,"timeOffset":240,"traffic":null,"bound":[[53.1037386186541,35.8541701954474],[52.8389951050595,36.3152979165854]]},{"code":"penza","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.3490815216318,44.7954767846358],[53.0655658707405,45.3588094775773]]},{"code":"perm","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[58.2439105904424,55.610474882024],[57.6859949037923,56.6620402090133]]},{"code":"petrozavodsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[61.9594765659225,34.0933638416971],[61.6914724689462,34.708850211665]]},{"code":"pskov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.8891060477973,28.1635000325078],[57.7271382707715,28.4915311006639]]},{"code":"minvody","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[44.3052018858753,42.5968656508625],[43.8079983597538,43.5306793178291]]},{"code":"rostov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[47.3681524785198,39.3566267162468],[47.0533140450719,39.9248376695462]]},{"code":"ryazan","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.8820828703611,39.4328766896117],[54.4873429393359,39.992107259096]]},{"code":"samara","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.7133859816235,49.7777262793471],[53.0390499541524,50.524471412358]]},{"code":"spb","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":true,"bound":[[60.2925612478519,29.4108877598293],[59.5352624321976,31.0279705658238]]},{"code":"saransk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.3019028278782,44.8670169699494],[53.9846323149273,45.5117203772106]]},{"code":"saratov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.6998086891669,45.7306106842113],[51.353162626011,46.3147731596003]]},{"code":"smolensk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.8893106126968,31.7550015053805],[54.6878753760871,32.2686727097693]]},{"code":"sochi","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[44.3548122819334,38.9364797786377],[43.3632495745264,40.488511351502]]},{"code":"stavropol","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[45.2695581782036,41.6581173946841],[44.892929962064,42.3241147988394]]},{"code":"staroskol","minZoom":10,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.3779381963195,37.7448617887827],[51.2468619996829,37.9821663678883]]},{"code":"sterlitamak","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[53.7369873772458,55.8056723048395],[53.3028756985379,56.1328304018719]]},{"code":"surgut","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[61.40828807144,72.3817595909749],[60.9771606899594,73.7971635380408]]},{"code":"syktyvkar","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[61.9227103772726,50.4315252227783],[61.5703415422949,51.275080406535]]},{"code":"tambov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[52.8265633445323,41.2688277615465],[52.5613158585861,41.6015800087645]]},{"code":"tver","minZoom":9,"maxZoom":17,"timeOffset":240,"traffic":null,"bound":[[57.0175457772806,35.5310822658554],[56.6655939617203,36.314300499486]]},{"code":"tobolsk","minZoom":9,"maxZoom":17,"timeOffset":360,"traffic":null,"bound":[[58.3372049677334,68.0274608759476],[58.0611370960295,68.6305907886217]]},{"code":"togliatti","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.7081249432729,48.9618270538152],[53.0282107408725,49.7967348046849]]},{"code":"tomsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[56.5956943056455,84.7686556891859],[56.3480256494226,85.2465320183285]]},{"code":"tula","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.3185426012515,37.4140448385478],[53.8995391159124,38.4215849170042]]},{"code":"tyumen","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[57.269890105758,65.2132212676953],[56.3976776719812,66.6908512938406]]},{"code":"ulanude","minZoom":9,"maxZoom":18,"timeOffset":540,"traffic":null,"bound":[[52.0564825771179,107.358424043204],[51.691351260689,107.990789310771]]},{"code":"ulyanovsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.4707243909343,48.0311106679108],[54.1049832769207,48.7744246507962]]},{"code":"ussuriysk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[43.9718774327491,131.749240836303],[43.7080787530987,132.142052300421]]},{"code":"ustkam","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[50.0591923546681,82.4448367555293],[49.8579588549296,82.8057177665881]]},{"code":"ufa","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":true,"bound":[[54.9572844664839,55.7150899042712],[54.4785240461723,56.3124162045037]]},{"code":"khabarovsk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[48.6071036747544,134.873582147183],[48.2885778879321,135.259035742564]]},{"code":"cheboksary","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.3420261123137,46.9895856513309],[55.9808449192766,47.6057602491808]]},{"code":"chelyabinsk","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[55.3198262824454,61.1854857912442],[54.9904623855663,61.744580331559]]},{"code":"chita","minZoom":9,"maxZoom":18,"timeOffset":600,"traffic":null,"bound":[[52.1861143043843,113.10211240076],[51.926502007168,113.639183599285]]},{"code":"yuzhnosakhalinsk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[47.5156337690436,142.447679650444],[46.5832085759882,142.971757646538]]},{"code":"yakutsk","minZoom":9,"maxZoom":18,"timeOffset":600,"traffic":null,"bound":[[62.1878305123633,129.525801925885],[61.8005013951169,129.99230258145]]},{"code":"yaroslavl","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.7761985248821,39.7178413590056],[57.5193090101217,40.0128826713777]]}]')}(this, document));